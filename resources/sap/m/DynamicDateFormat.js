/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/core/format/DateFormat','sap/ui/core/format/NumberFormat','sap/ui/core/Locale','sap/ui/core/LocaleData','./StandardDynamicDateRangeKeys',"sap/base/Log","sap/base/util/deepExtend","sap/base/util/isEmptyObject","sap/ui/core/date/UniversalDateUtils"],function(D,N,L,a,S,b,d,c,U){"use strict";var e=function(){throw new Error();};var _=sap.ui.getCore().getLibraryResourceBundle("sap.m");var g={};var h={};var p={"DATE":["date"],"DATERANGE":["date","date"],"LASTDAYS":["int"],"LASTWEEKS":["int"],"LASTMONTHS":["int"],"LASTQUARTERS":["int"],"LASTYEARS":["int"],"NEXTDAYS":["int"],"NEXTWEEKS":["int"],"NEXTMONTHS":["int"],"NEXTQUARTERS":["int"],"NEXTYEARS":["int"],"FROM":["date"],"TO":["date"],"SPECIFICMONTH":["month"],"TODAYFROMTO":["int","int"]};for(var i=0;i<S.length;i++){var k=S[i];var P=_.getText("DYNAMIC_DATE_"+k.toUpperCase()+"_FORMAT");var s=P.split('{').map(function(f){var C=f.indexOf('}');if(C!==-1){return f.slice(C+1);}return f;});g[k]=s;var l=[];var m=P.indexOf('{');var n=-1;var o=-1;while(m!==-1){n=P.indexOf('}');o=parseInt(P.slice(m+1,n-n-1));l.push(o);P=P.slice(n+1);m=P.indexOf('{');}h[k]=l;}e.getInstance=function(f,j){return this.createInstance(f,j);};e.oDefaultDynamicDateFormat={"date":{},"month":{pattern:"MMMM"},"int":{}};e.createInstance=function(F,j){var q=Object.create(this.prototype);if(F instanceof L){j=F;F=undefined;}if(!j){j=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();}q.oLocale=j;q.oLocaleData=a.getInstance(j);q.oOriginalFormatOptions=d({},e.oDefaultDynamicDateFormat,F);q._dateFormatter=D.getInstance(q.oOriginalFormatOptions["date"]);[q._dateFormatter].concat(q._dateFormatter.aFallbackFormats).forEach(function(f){f.parseRelative=function(){return null;};});q._monthFormatter=D.getInstance(q.oOriginalFormatOptions["month"]);q._numberFormatter=N.getInstance(q.oOriginalFormatOptions["int"]);q._resourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.m");return q;};e.prototype.format=function(O){var k=O.operator;var l=O.values.slice(0);if(k==="SPECIFICMONTH"){var f=new Date();f.setMonth(l[0]);l[0]=this._monthFormatter.format(f);}else if(k==="LASTDAYS"&&l[0]===1){k="YESTERDAY";l=[];}else if(k==="NEXTDAYS"&&l[0]===1){k="TOMORROW";l=[];}else if((k==="LASTDAYS"||k==="NEXTDAYS")&&l[0]===0){k="TODAY";l=[];}var F=l.map(function(j){if(j instanceof Date){return this._dateFormatter.format(j);}if(typeof(j)==="number"){return this._numberFormatter.format(j);}else{return j.toString();}},this);return this._resourceBundle.getText("DYNAMIC_DATE_"+k.toUpperCase()+"_FORMAT",F);};e.prototype.parse=function(v,k){var r;var s=g[k];var R="^"+s.join("(.*)")+"$";if(k==="TODAYFROMTO"){R=R.replace("+","\\+");}var f=new RegExp(R,"i");var q=v.match(f);if(q){r={};r.values=[];for(var j=0;j<h[k].length;j++){var I=h[k][j];var t=p[k][I];var V;var C=q[j+1];switch(t){case"date":V=this._dateFormatter.parse(C);break;case"month":var M=[0,1,2,3,4,5,6,7,8,9,10,11].map(function(i){var w=new Date();w.setMonth(i);return this._monthFormatter.format(w);},this);var u=M.indexOf(C);V=u!==-1?u:null;break;case"int":V=this._numberFormatter.parse(C);break;case"string":V=C;break;default:break;}if(!V){r=null;break;}r.values[I]=V;}if(r){r.operator=k;return r;}}};return e;});
