sap.ui.define(["sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","sap/ui/webc/common/thirdparty/base/types/AnimationMode","sap/ui/webc/common/thirdparty/base/config/AnimationMode","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/main/thirdparty/StandardListItem","sap/ui/webc/main/thirdparty/List","sap/ui/webc/main/thirdparty/Popover","sap/ui/webc/main/thirdparty/Button","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/icons/search","sap/ui/webc/common/thirdparty/icons/bell","sap/ui/webc/common/thirdparty/icons/overflow","sap/ui/webc/common/thirdparty/icons/grid","./generated/i18n/i18n-defaults","./generated/templates/ShellBarTemplate.lit","./generated/templates/ShellBarPopoverTemplate.lit","./generated/themes/ShellBar.css"],function(e,t,i,s,o,r,n,l,h,a,u,c,d,f,p,b,m,g,_,w){"use strict";function v(e){return e&&typeof e==="object"&&"default"in e?e["default"]:e}var P=v(e);var y=v(t);var I=v(i);var S=v(o);var R=v(l);var L=v(h);var B=v(a);var A=v(u);const E=200;const T={tag:"ui5-shellbar",languageAware:true,properties:{primaryTitle:{type:String},secondaryTitle:{type:String},notificationsCount:{type:String},showNotifications:{type:Boolean},showProductSwitch:{type:Boolean},showCoPilot:{type:Boolean},breakpointSize:{type:String},showSearchField:{type:Boolean},coPilotActive:{type:Boolean},withLogo:{type:Boolean},_itemsInfo:{type:Object},_actionList:{type:Object},_header:{type:Object},_menuPopoverItems:{type:String,multiple:true},_menuPopoverExpanded:{type:Boolean,noAttribute:true},_overflowPopoverExpanded:{type:Boolean,noAttribute:true},_fullWidthSearch:{type:Boolean,noAttribute:true}},managedSlots:true,slots:{default:{propertyName:"items",type:HTMLElement,invalidateOnChildChange:true},profile:{type:HTMLElement},logo:{type:HTMLElement},menuItems:{type:HTMLElement},searchField:{type:HTMLElement},startButton:{type:HTMLElement}},events:{"notifications-click":{detail:{targetRef:{type:HTMLElement}}},"profile-click":{detail:{targetRef:{type:HTMLElement}}},"product-switch-click":{detail:{targetRef:{type:HTMLElement}}},"logo-click":{detail:{targetRef:{type:HTMLElement}}},"co-pilot-click":{detail:{targetRef:{type:HTMLElement}}},"menu-item-click":{detail:{item:{type:HTMLElement}}}}};class O extends P{static get metadata(){return T}static get styles(){return w}static get render(){return y}static get template(){return g}static get staticAreaTemplate(){return _}static get FIORI_3_BREAKPOINTS(){return[599,1023,1439,1919,1e4]}static get FIORI_3_BREAKPOINTS_MAP(){return{599:"S",1023:"M",1439:"L",1919:"XL",1e4:"XXL"}}constructor(){super();this._itemsInfo=[];this._isInitialRendering=true;this._focusedItem=null;this._defaultItemPressPrevented=false;this._actionList={itemPress:e=>{if(!this._defaultItemPressPrevented){this.overflowPopover.close()}this._defaultItemPressPrevented=false}};this.menuItemsObserver=new MutationObserver(()=>{this._updateClonedMenuItems()});this._header={press:async()=>{this._updateClonedMenuItems();if(this.hasMenuItems){const e=await this._getMenuPopover();e.showAt(this.shadowRoot.querySelector(".ui5-shellbar-menu-button"))}}};this._handleResize=async e=>{this._debounce(async()=>{await this._getResponsivePopover();this.overflowPopover.close();this._overflowActions()},E)};this.i18nBundle=c.getI18nBundle("@ui5/webcomponents-fiori")}_debounce(e,t){clearTimeout(this._debounceInterval);this._debounceInterval=setTimeout(()=>{this._debounceInterval=null;e()},t)}_menuItemPress(e){this.menuPopover.close();this.fireEvent("menu-item-click",{item:e.detail.item},true)}_logoPress(){this.fireEvent("logo-click",{targetRef:this.shadowRoot.querySelector(".ui5-shellbar-logo")})}_menuPopoverBeforeOpen(){this._menuPopoverExpanded=true}_menuPopoverAfterClose(){this._menuPopoverExpanded=false}_overflowPopoverBeforeOpen(){this._overflowPopoverExpanded=true}_overflowPopoverAfterClose(){this._overflowPopoverExpanded=false}_logoKeyup(e){if(n.isSpace(e)){this._logoPress()}}_logoKeydown(e){if(n.isSpace(e)){e.preventDefault();return}if(n.isEnter(e)){this._logoPress()}}_fireCoPilotClick(){this.fireEvent("co-pilot-click",{targetRef:this.shadowRoot.querySelector(".ui5-shellbar-coPilot")})}_coPilotClick(){this._fireCoPilotClick()}_coPilotKeydown(e){if(n.isSpace(e)){this.coPilotActive=true;e.preventDefault();return}if(n.isEnter(e)){this.coPilotActive=true;this._fireCoPilotClick()}}_coPilotKeyup(e){if(n.isSpace(e)){this._fireCoPilotClick()}this.coPilotActive=false}onBeforeRendering(){const e=r.getAnimationMode()===S.Full;const t=s.getFeature("CoPilotAnimation");this.coPilot=t&&e?t:{animated:false};this.withLogo=this.hasLogo;this._hiddenIcons=this._itemsInfo.filter(e=>{const t=e.classes.indexOf("ui5-shellbar-hidden-button")!==-1;const i=e.classes.indexOf("ui5-shellbar-invisible-button")===-1;const s=e.classes.indexOf("ui5-shellbar-overflow-button")!==-1;const o=e.classes.indexOf("ui5-shellbar-image-button")!==-1;const r=s||o&&this.hasProfile;return t&&i&&!r});this._observeMenuItems()}onAfterRendering(){this._overflowActions();this._fullWidthSearch=this._showFullWidthSearch}closeOverflow(){if(this.overflowPopover){this.overflowPopover.close()}}_handleBarBreakpoints(){const e=this.getBoundingClientRect().width;const t=O.FIORI_3_BREAKPOINTS;const i=t.find(t=>e<t)||O.FIORI_3_BREAKPOINTS[O.FIORI_3_BREAKPOINTS.length-1];const s=O.FIORI_3_BREAKPOINTS_MAP[i];if(this.breakpointSize!==s){this.breakpointSize=s}return s}_handleSizeS(){const e=this.showNotifications||this.showProductSwitch||this.searchField.length||this.items.length;const t=this._getAllItems(e).map(e=>{const t=e.classes.indexOf("ui5-shellbar-overflow-button")!==-1;const i=e.classes.indexOf("ui5-shellbar-image-button")!==-1;const s=t||i&&this.hasProfile;return{...e,classes:`${e.classes} ${s?"":"ui5-shellbar-hidden-button"} ui5-shellbar-button`,style:`order: ${s?1:-1}`}});this._updateItemsInfo(t)}_handleActionsOverflow(){const e=this.shadowRoot.querySelector(".ui5-shellbar-overflow-container-right").getBoundingClientRect();let t=".ui5-shellbar-button:not(.ui5-shellbar-overflow-button):not(.ui5-shellbar-invisible-button)";if(this.showSearchField){t+=",.ui5-shellbar-search-field"}const i=this.shadowRoot.querySelectorAll(t);const s=this.effectiveDir==="rtl";let o=[].filter.call(i,t=>{const i=t.getBoundingClientRect();if(s){return i.left+i.width>e.left+e.width}return i.left<e.left});o=o.length;const r=this._getAllItems(!!o).filter(e=>e.show);const n=r.sort((e,t)=>{if(e.priority>t.priority){return 1}if(e.priority<t.priority){return-1}return 0});for(let e=0;e<n.length;e++){if(e<o){n[e].classes=`${n[e].classes} ui5-shellbar-hidden-button`;n[e].style=`order: -1`}}return n}_overflowActions(){const e=this._handleBarBreakpoints();if(e==="S"){return this._handleSizeS()}const t=this._handleActionsOverflow();this._updateItemsInfo(t)}_toggleActionPopover(){const e=this.shadowRoot.querySelector(".ui5-shellbar-overflow-button");this.overflowPopover.showAt(e)}onEnterDOM(){I.register(this,this._handleResize)}onExitDOM(){this.menuItemsObserver.disconnect();I.deregister(this,this._handleResize);clearTimeout(this._debounceInterval);this._debounceInterval=null}_handleSearchIconPress(e){this.showSearchField=!this.showSearchField;if(!this.showSearchField){return}const t=this.searchField[0];if(t){t.focused=true}setTimeout(()=>{if(t){t.focus()}},100)}_handleCustomActionPress(e){const t=e.target.getAttribute("data-ui5-external-action-item-id");if(t){const i=this.items.find(e=>e.shadowRoot.querySelector(`#${t}`));const s=!i.fireEvent("item-click",{targetRef:e.target},true);this._defaultItemPressPrevented=s}}_handleOverflowPress(e){this._toggleActionPopover()}_handleNotificationsPress(e){const t=this.shadowRoot.querySelector(".ui5-shellbar-bell-button");this._defaultItemPressPrevented=!this.fireEvent("notifications-click",{targetRef:t.classList.contains("ui5-shellbar-hidden-button")?e.target:t},true)}_handleProfilePress(e){this.fireEvent("profile-click",{targetRef:this.shadowRoot.querySelector(".ui5-shellbar-image-button")})}_handleCancelButtonPress(){this.showSearchField=false}_handleProductSwitchPress(e){const t=this.shadowRoot.querySelector(".ui5-shellbar-button-product-switch");this._defaultItemPressPrevented=!this.fireEvent("product-switch-click",{targetRef:t.classList.contains("ui5-shellbar-hidden-button")?e.target:t},true)}_getAllItems(e){let t=-1;const i=[{icon:"search",text:"Search",classes:`${this.searchField.length?"":"ui5-shellbar-invisible-button"} ui5-shellbar-search-button ui5-shellbar-button`,priority:4,domOrder:this.searchField.length?++t:-1,style:`order: ${this.searchField.length?1:-10}`,id:`${this._id}-item-${1}`,press:this._handleSearchIconPress.bind(this),show:!!this.searchField.length},...this.items.map((e,i)=>({icon:e.icon,id:e._id,count:e.count||undefined,refItemid:e._id,text:e.text,classes:"ui5-shellbar-custom-item ui5-shellbar-button",priority:1,domOrder:++t,style:`order: ${2}`,show:true,press:this._handleCustomActionPress.bind(this),custom:true,title:e.title,stableDomRef:e.stableDomRef})),{icon:"bell",text:"Notifications",classes:`${this.showNotifications?"":"ui5-shellbar-invisible-button"} ui5-shellbar-bell-button ui5-shellbar-button`,priority:3,style:`order: ${this.showNotifications?3:-10}`,id:`${this._id}-item-${2}`,show:this.showNotifications,domOrder:this.showNotifications?++t:-1,press:this._handleNotificationsPress.bind(this)},{icon:"overflow",text:"Overflow",classes:`${e?"":"ui5-shellbar-hidden-button"} ui5-shellbar-overflow-button-shown ui5-shellbar-overflow-button ui5-shellbar-button`,priority:5,order:4,style:`order: ${e?4:-1}`,domOrder:e?++t:-1,id:`${this.id}-item-${5}`,press:this._handleOverflowPress.bind(this),show:true},{text:"Person",classes:`${this.hasProfile?"":"ui5-shellbar-invisible-button"} ui5-shellbar-image-button ui5-shellbar-button`,priority:4,style:`order: ${this.hasProfile?5:-10};`,profile:true,id:`${this._id}-item-${3}`,domOrder:this.hasProfile?++t:-1,show:this.hasProfile,press:this._handleProfilePress.bind(this)},{icon:"grid",text:"Product Switch",classes:`${this.showProductSwitch?"":"ui5-shellbar-invisible-button"} ui5-shellbar-button ui5-shellbar-button-product-switch`,priority:2,style:`order: ${this.showProductSwitch?6:-10}`,id:`${this._id}-item-${4}`,show:this.showProductSwitch,domOrder:this.showProductSwitch?++t:-1,press:this._handleProductSwitchPress.bind(this)}];return i}_updateItemsInfo(e){const t=JSON.stringify(this._itemsInfo)!==JSON.stringify(e);if(t){this._itemsInfo=e}}_updateClonedMenuItems(){this._menuPopoverItems=[];this.menuItems.forEach(e=>{const t=e.cloneNode(true);t.removeAttribute("slot");this._menuPopoverItems.push(t)})}_observeMenuItems(){this.menuItems.forEach(e=>{this.menuItemsObserver.observe(e,{characterData:true,childList:true,subtree:true,attributes:true})})}async _getResponsivePopover(){const e=await this.getStaticAreaItemDomRef();this.overflowPopover=e.querySelector(".ui5-shellbar-overflow-popover");this.menuPopover=e.querySelector(".ui5-shellbar-menu-popover")}async _getMenuPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector(".ui5-shellbar-menu-popover")}isIconHidden(e){const t=this._itemsInfo.find(t=>t.icon===e);if(!t){return false}return t.classes.indexOf("ui5-shellbar-hidden-button")!==-1}get classes(){return{wrapper:{"ui5-shellbar-root":true,"ui5-shellbar-with-searchfield":this.searchField.length,"ui5-shellbar-with-coPilot":this.showCoPilot},button:{"ui5-shellbar-menu-button--interactive":this.hasMenuItems,"ui5-shellbar-menu-button":true},title:{},items:{notification:{"ui5-shellbar-hidden-button":this.isIconHidden("bell")},product:{"ui5-shellbar-hidden-button":this.isIconHidden("grid")},search:{"ui5-shellbar-hidden-button":this.isIconHidden("search")},overflow:{"ui5-shellbar-hidden-button":this.isIconHidden("overflow")}}}}get styles(){return{items:{notification:{order:this.isIconHidden("bell")?"-1":"3"},overflow:{order:this.isIconHidden("overflow")?"-1":"4"},profile:{order:this.hasProfile?"5":"-1"},product:{order:this.isIconHidden("grid")?"-1":"6"}},searchField:{display:this.correctSearchFieldStyles}}}get correctSearchFieldStyles(){if(this.showSearchField){if(this._fullWidthSearch){return"flex"}return"block"}return"none"}get customItemsInfo(){return this._itemsInfo.filter(e=>!!e.custom)}get nonFocusableLogo(){return this.breakpointSize==="S"&&this.hasMenuItems}get hasFocusableLogo(){return this.hasLogo&&!this.nonFocusableLogo}get hasNonFocusableLogo(){return this.hasLogo&&this.nonFocusableLogo}get hasLogo(){return!!this.logo.length}get showArrowDown(){return this.primaryTitle||this.hasInteractvieLogo}get popoverHorizontalAlign(){return this.effectiveDir==="rtl"?"Left":"Right"}get hasSearchField(){return!!this.searchField.length}get hasProfile(){return!!this.profile.length}get hasMenuItems(){return this.menuItems.length>0}get menuBtnHasPopup(){return this.hasMenuItems?true:undefined}get menuBtnTabindex(){return this.hasMenuItems?"0":"-1"}get menuPopoverExpanded(){return this.hasMenuItems?this._menuPopoverExpanded:undefined}get _shellbarText(){return this.i18nBundle.getText(m.SHELLBAR_LABEL)}get _logoText(){return this.i18nBundle.getText(m.SHELLBAR_LOGO)}get _copilotText(){return this.i18nBundle.getText(m.SHELLBAR_COPILOT)}get _notificationsText(){return this.i18nBundle.getText(m.SHELLBAR_NOTIFICATIONS,this.notificationsCount)}get _cancelBtnText(){return this.i18nBundle.getText(m.SHELLBAR_CANCEL)}get _showFullWidthSearch(){const e=this._handleBarBreakpoints();const t=!!this.shadowRoot.querySelector(".ui5-shellbar-search-button.ui5-shellbar-hidden-button");return e==="S"||t}get _profileText(){return this.i18nBundle.getText(m.SHELLBAR_PROFILE)}get _productsText(){return this.i18nBundle.getText(m.SHELLBAR_PRODUCTS)}get _searchText(){return this.i18nBundle.getText(m.SHELLBAR_SEARCH)}get _overflowText(){return this.i18nBundle.getText(m.SHELLBAR_OVERFLOW)}get accInfo(){return{notifications:{title:this._notificationsText},profile:{title:this._profileText},products:{title:this._productsText},search:{ariaExpanded:this.showSearchField,title:this._searchText},overflow:{title:this._overflowText,ariaHaspopup:true,ariaExpanded:this._overflowPopoverExpanded}}}static get dependencies(){return[A,L,B,R]}static async onDefine(){await c.fetchI18nBundle("@ui5/webcomponents-fiori")}}O.define();return O});