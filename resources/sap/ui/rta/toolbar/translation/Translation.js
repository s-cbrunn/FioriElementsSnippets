/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/core/Fragment","sap/ui/rta/Utils","sap/ui/model/json/JSONModel"],function(M,F,U,J){"use strict";var d;var p;function r(){this._oTranslationModel.setProperty("/sourceLanguage","");this._oTranslationModel.setProperty("/downloadChangedTexts",false);return Promise.resolve(d);}function c(){return F.load({name:"sap.ui.rta.toolbar.translation.DownloadTranslationDialog",id:this.getContext().getId()+"_download_translation_fragment",controller:{onDownloadFile:function(){d.close();},onCancelDownloadDialog:function(){d.close();}}}).then(function(t){d=t;d.setModel(this._oTranslationModel,"translation");d.addStyleClass(U.getRtaStyleClassName());this.getContext().addDependent(d);}.bind(this));}var T=M.extend("sap.ui.rta.toolbar.translation.Translation",{metadata:{properties:{context:{type:"sap.ui.rta.toolbar.Base"}}},constructor:function(){M.prototype.constructor.apply(this,arguments);this._oTranslationModel=new J({sourceLanguage:"",downloadChangedTexts:false});}});T.prototype.exit=function(){if(this._oDialogPromise){this._oDialogPromise.then(d.destroy.bind(d));}if(this._oPopoverPromise){this._oPopoverPromise.then(p.destroy.bind(p));}};T.prototype.showTranslationPopover=function(e){var t=e.getSource();if(!this._oPopoverPromise){this._oPopoverPromise=F.load({name:"sap.ui.rta.toolbar.translation.TranslationPopover",id:this.getContext().getId()+"_translationPopoverDialog",controller:{openDownloadTranslationDialog:this.openDownloadTranslationDialog.bind(this)}}).then(function(o){p=o;t.addDependent(o);return o;});}return this._oPopoverPromise.then(function(o){if(!o.isOpen()){o.openBy(t);}else{o.close();}});};T.prototype.openDownloadTranslationDialog=function(){if(d){this._oDialogPromise=r.call(this);}else{this._oDialogPromise=c.call(this);}return this._oDialogPromise.then(function(){this.getContext().addDependent(d);return d.open();}.bind(this));};return T;});
