//@ui5-bundle sap/ui/fl/library-preload.js
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine('sap/ui/fl/Layer',[],function(){"use strict";return{USER:"USER",PUBLIC:"PUBLIC",CUSTOMER:"CUSTOMER",CUSTOMER_BASE:"CUSTOMER_BASE",PARTNER:"PARTNER",VENDOR:"VENDOR",BASE:"BASE"};});
sap.ui.predefine('sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes',[],function(){"use strict";return{getChangeTypes:function(){return["appdescr_ovp_addNewCard","appdescr_ovp_removeCard","appdescr_ovp_changeCard","appdescr_app_addNewInbound","appdescr_app_changeInbound","appdescr_app_removeInbound","appdescr_app_removeAllInboundsExceptOne","appdescr_app_addNewOutbound","appdescr_app_changeOutbound","appdescr_app_removeOutbound","appdescr_app_addNewDataSource","appdescr_app_changeDataSource","appdescr_app_removeDataSource","appdescr_app_addAnnotationsToOData","appdescr_app_addTechnicalAttributes","appdescr_app_removeTechnicalAttributes","appdescr_app_setTitle","appdescr_app_setSubTitle","appdescr_app_setShortTitle","appdescr_app_setDescription","appdescr_app_setInfo","appdescr_app_setDestination","appdescr_app_setKeywords","appdescr_app_setAch","appdescr_app_addCdsViews","appdescr_app_removeCdsViews","appdescr_flp_setConfig","appdescr_ui5_addNewModelEnhanceWith","appdescr_ui5_removeModel","appdescr_ui5_replaceComponentUsage","appdescr_ui5_setMinUI5Version","appdescr_smb_addNamespace","appdescr_smb_changeNamespace","appdescr_ui_generic_app_setMainPage","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_ui5_addLibraries","appdescr_ui5_addNewModel","appdescr_app_addAnnotationsToOData","appdescr_ui5_addComponentUsages","appdescr_ui5_setFlexExtensionPointEnabled","appdescr_url_setUri","appdescr_fiori_setRegistrationIds","appdescr_card","appdescr_card_designtime","appdescr_fiori_setAbstract"];},getCondensableChangeTypes:function(){return["appdescr_app_setTitle","appdescr_app_setInfo","appdescr_app_setShortTitle","appdescr_app_setSubTitle","appdescr_app_setDescription","appdescr_app_setDestination","appdescr_app_setKeywords","appdescr_app_setAch","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_fiori_setRegistrationIds","appdescr_smb_changeNamespace"];}};});
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/Applier',["sap/base/Log","sap/ui/core/Element","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/Utils"],function(L,E,J,F,U,D,a){"use strict";var l=new a.FakePromise();
function _(C,p){var s=C.getSelector&&C.getSelector();if(!s||(!s.id&&!s.name)){return Promise.reject(Error("No selector in change found or no selector ID."));}return p.modifier.bySelectorTypeIndependent(s,p.appComponent,p.view).then(function(o){if(!o){throw Error("A flexibility change tries to change a nonexistent control.");}var j=C.getDependentControlSelectorList();j.forEach(function(k){var m=p.modifier.bySelector(k,p.appComponent,p.view);if(!m){throw new Error("A dependent selector control of the flexibility change is not available.");}});return o;});}
function b(C,o,m,j,p){var k=U.getControlIfTemplateAffected(o,C,p);var M=p.modifier;var H=!!F.sync.getAppliedCustomDataValue(k.control,o);var I=H||F.sync.hasChangeApplyFinishedCustomData(k.control,o);var n=o.isApplyProcessFinished();if(n&&!I){var q=U.checkIfDependencyIsStillValidSync.bind(null,p.appComponent,M,m);j._oChangePersistence.copyDependenciesFromInitialChangesMapSync(o,q,p.appComponent);o.setInitialApplyState();}else if(!n&&I){if(H){o.setRevertData(F.sync.getParsedRevertDataFromCustomData(C,o));}o.markFinished();}}
function c(p){return p.modifier.targets==="xmlTree";}
function d(C,o,m,j,p){var x=c(p);var k=U.getControlIfTemplateAffected(o,C,p);var M=p.modifier;return F.getAppliedCustomDataValue(k.control,o,M).then(function(n){var H=!!n;return Promise.all([H,(H||F.hasChangeApplyFinishedCustomData(k.control,o,M))]);}).then(function(n){var H=n[0];var I=n[1];var q=o.isApplyProcessFinished();var M=p.modifier;var r=p.appComponent;if(q&&!I){var P=new a.FakePromise();if(!x){var s=U.checkIfDependencyIsStillValid.bind(null,r,M,m);P=P.then(function(){return j._oChangePersistence.copyDependenciesFromInitialChangesMap(o,s,r);});}return P.then(o.setInitialApplyState.bind(o));}else if(!q&&I){if(H){return F.getParsedRevertDataFromCustomData(C,o,M).then(function(t){o.setRevertData(t);o.markFinished();});}o.markFinished();return undefined;}else if(q&&I){o.markFinished();}return undefined;});}
function e(C,p){var s;if(c(p)&&C.getDefinition().jsOnly){s="Change cannot be applied in XML. Retrying in JS.";}if(s){C.setInitialApplyState();throw Error(s);}}
function f(C,m,I,p){return Promise.resolve().then(function(){if(I instanceof E){m.control=I;}if(m.control){return p.modifier.updateAggregation(m.originalControl,C.getContent().boundAggregation);}return undefined;}).then(function(){return F.addAppliedCustomData(m.control,C,p,c(p));}).then(function(){var r={success:true};C.markFinished(r);return r;});}
function g(o,C,m,p){var x=c(p);var r={success:false,error:o};var s=C.getId();var j="Change ''{0}'' could not be applied.";var k=o instanceof Error;var n=F.getCustomDataIdentifier(false,k,x);switch(n){case F.notApplicableChangesCustomDataKey:a.formatAndLogMessage("info",[j,o.message],[s]);break;case F.failedChangesCustomDataKeyXml:a.formatAndLogMessage("warning",[j,"Merge error detected while processing the XML tree."],[s],o.stack);break;case F.failedChangesCustomDataKeyJs:a.formatAndLogMessage("error",[j,"Merge error detected while processing the JS control tree."],[s],o.stack);break;}return F.addFailedCustomData(m.control,C,p,n).then(function(){if(x){C.setInitialApplyState();}else{C.markFinished(r);}return r;});}
function h(o,C){var j=C.getDefinition();var s=j.changeType;var t=j.selector.id;var k=j.namespace+j.fileName+"."+j.fileType;var w="A flexibility change could not be applied.";w+="\nThe displayed UI might not be displayed as intedend.";if(o.message){w+="\n   occurred error message: '"+o.message+"'";}w+="\n   type of change: '"+s+"'";w+="\n   LRep location of the change: "+k;w+="\n   id of targeted control: '"+t+"'.";L.warning(w,undefined,"sap.ui.fl.apply._internal.changes.Applier");}
function i(C,o,j){var p={appComponent:j,modifier:J};var k=J.bySelector(C.originalSelectorToBeAdjusted,j);var m=o.getBindingInfo(C.getContent().boundAggregation).template;if(k.getParent()){var s=[];var t=k;do{s.push({aggregation:t.sParentAggregationName,index:t.getParent().getAggregation(t.sParentAggregationName).indexOf(t)});t=t.getParent();}while(t.getParent());s.reverse();s.forEach(function(I){m=m.getAggregation(I.aggregation)[I.index];});}C.addDependentControl(m,"originalSelector",p);}
var A={addPreConditionForInitialChangeApplying:function(p){l=l.then(function(){return p;});},applyChangeOnControl:function(C,o,p){var m=U.getControlIfTemplateAffected(C,o,p);return U.getChangeHandler(C,m,p).then(function(j){e(C,p);return j;}).then(function(j){if(C.hasApplyProcessStarted()){return C.addPromiseForApplyProcessing().then(function(r){C.markFinished();return r;});}else if(!C.isApplyProcessFinished()){return new a.FakePromise().then(function(){C.startApplying();return j.applyChange(C,m.control,p);}).then(function(I){return f(C,m,I,p);}).catch(function(k){return g(k,C,m,p);});}var r={success:true};C.markFinished(r);return r;}).catch(function(j){return{success:false,error:j};});},applyAllChangesForControl:function(G,o,j,C){var m=G();var s=C.getId();var k=m.mChanges[s]||[];var p={modifier:J,appComponent:o,view:a.getViewForControl(C)};k.forEach(function(n){b(C,n,m,j,p);if(!n.isApplyProcessFinished()&&!n._ignoreOnce){n.setQueuedForApply();}});l=l.then(function(C,p){var P=[];var s=C.getId();var k=m.mChanges[s]||[];var n;if(m.mControlsWithDependencies[s]){D.removeControlsDependencies(m,s);n=true;}k.forEach(function(q){if(q.originalSelectorToBeAdjusted){i(q,C,o);delete q.originalSelectorToBeAdjusted;}if(q._ignoreOnce){delete q._ignoreOnce;}else if(q.isApplyProcessFinished()){D.resolveDependenciesForChange(m,q.getId(),s);}else if(!m.mDependencies[q.getId()]){P.push(function(){return A.applyChangeOnControl(q,C,p).then(function(){D.resolveDependenciesForChange(m,q.getId(),s);});});}else{var r=A.applyChangeOnControl.bind(A,q,C,p);D.addChangeApplyCallbackToDependency(m,q.getId(),r);}});if(k.length||n){return a.execPromiseQueueSequentially(P).then(function(){return D.processDependentQueue(m,o,s);});}return undefined;}.bind(null,C,p));return l;},applyAllChangesForXMLView:function(p,C){if(!Array.isArray(C)){var s="No list of changes was passed for processing the flexibility on view: "+p.view+".";L.error(s,undefined,"sap.ui.fl.apply._internal.changes.Applier");C=[];}return C.reduce(function(P,o){var j;return P.then(_.bind(null,o,p)).then(function(r){j=r;o.setQueuedForApply();return d(j,o,undefined,undefined,p);}).then(function(){if(!o.isApplyProcessFinished()){return A.applyChangeOnControl(o,j,p);}return{success:true};}).then(function(r){if(!r.success){throw Error(r.error);}}).catch(function(k){h(k,o);});},new a.FakePromise()).then(function(){return p.view;});}};return A;});
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/Reverter',["sap/base/Log","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/Utils"],function(L,F,U,a){"use strict";var R={};
function _(c){if(!c.isApplyProcessFinished()&&c.hasApplyProcessStarted()){return c.addPromiseForApplyProcessing().then(function(o){if(o&&o.error){c.markRevertFinished(o.error);throw Error(o.error);}});}return Promise.resolve();}
function r(c,C,m,p){return R.revertChangeOnControl(c,C,m).then(function(v){return F.destroyAppliedCustomData(v||C,c,p.modifier).then(function(){return!!v;});}).then(function(s){if(s){p.flexController._oChangePersistence._deleteChangeInMap(c);}});}
R.revertChangeOnControl=function(c,C,p){var m=U.getControlIfTemplateAffected(c,C,p);var o;return U.getChangeHandler(c,m,p).then(function(b){o=b;}).then(_.bind(null,c)).then(function(){if(c.isApplyProcessFinished()){c.startReverting();return o.revertChange(c,m.control,p);}throw Error("Change was never applied");}).then(function(){m.control=p.modifier.bySelector(c.getSelector(),p.appComponent,p.view);if(m.bTemplateAffected){return p.modifier.updateAggregation(m.control,c.getContent().boundAggregation);}return undefined;}).then(function(){c.markRevertFinished();return m.control;}).catch(function(e){var E="Change could not be reverted: "+e.message;L.error(E);c.markRevertFinished(E);return false;});};
R.revertMultipleChanges=function(c,p){var P=[];c.forEach(function(C){C.setQueuedForRevert();P.push(function(){var s=C.getSelector&&C.getSelector();var o=p.modifier.bySelector(s,p.appComponent);if(!o){L.warning("A flexibility change tries to revert changes on a nonexistent control with id "+s.id);return new a.FakePromise();}var m={modifier:p.modifier,appComponent:p.appComponent,view:a.getViewForControl(o)};return r(C,o,m,p);});});return a.execPromiseQueueSequentially(P);};
return R;});
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/Utils',["sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/Utils"],function(F,C,a){"use strict";
function i(c,h){if(h||c.hasApplyProcessStarted()){return false;}return true;}
var U={getControlIfTemplateAffected:function(c,o,p){var m=p.modifier;var b=c.getDefinition();var d={originalControl:o};var O=b.dependentSelector&&b.dependentSelector.originalSelector;if(c.getContent().boundAggregation&&O){d.control=m.bySelector(O,p.appComponent,p.view);d.controlType=m.getControlType(d.control);d.bTemplateAffected=true;}else{d.control=o;d.controlType=m.getControlType(o);d.bTemplateAffected=false;}return d;},getChangeHandler:function(c,m,p){var l=p.modifier.getLibraryName(m.control);return a.requireAsync("sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration").then(function(b){return b.waitForChangeHandlerRegistration(l);}).then(function(){var s=c.getChangeType();var L=c.getLayer();return C.getChangeHandler(s,m.controlType,m.control,p.modifier,L);});},checkIfDependencyIsStillValidSync:function(A,m,c,s){var o=a.getChangeFromChangesMap(c.mChanges,s);var b=m.bySelector(o.getSelector(),A);var h=F.sync.hasChangeApplyFinishedCustomData(b,o);return i(o,h);},checkIfDependencyIsStillValid:function(A,m,c,s){var o=a.getChangeFromChangesMap(c.mChanges,s);var b=m.bySelector(o.getSelector(),A);return F.hasChangeApplyFinishedCustomData(b,o,m).then(i.bind(null,o));}};return U;});
sap.ui.predefine('sap/ui/fl/apply/_internal/controlVariants/URLHandler',["sap/ui/core/Component","sap/ui/fl/Utils","sap/base/Log","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/util/isEmptyObject","sap/ui/base/ManagedObjectObserver","sap/ui/thirdparty/hasher","sap/base/util/includes","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState"],function(C,U,L,m,O,i,M,h,a,V,b){"use strict";var _={};
function c(n,o){var A=[];return n.reduce(function(r,v){var l=o.getVariantManagementReference(v).variantManagementReference;if(l){if(a(A,l)){r.updateRequired=true;return r;}A.push(l);}if(l&&o.oData[l].currentVariant!==v){r.updateRequired=true;if(o.oData[l].currentVariant!==o.oData[l].defaultVariant){r.parameters.push(o.oData[l].currentVariant);}}else{r.parameters.push(v);}return r;},{updateRequired:false,parameters:[]});}
function d(p,o){var r=O.get(["params",V.VARIANT_TECHNICAL_PARAMETER],p);if(r){var u=c(r,o);if(u.updateRequired){k.update({updateURL:!o._bDesignTimeMode,parameters:u.parameters,updateHashEntry:true,model:o});}}}
function e(o,n){try{var u=o.getUShellService("URLParsing");if(u){var N=u.parseShellHash(n);d(N,o);}}catch(E){L.error(E.message);}var S=o.getUShellService("ShellNavigation");return S&&S.NavigationFilterStatus.Continue;}
function f(o){var S=o.getUShellService("ShellNavigation");if(!_[o.sFlexReference]){_[o.sFlexReference]=e.bind(null,o);if(S){S.registerNavigationFilter(_[o.sFlexReference]);}}}
function g(o){var S=o.getUShellService("ShellNavigation");if(S){S.unregisterNavigationFilter(_[o.sFlexReference]);delete _[o.sFlexReference];}}
function s(p){var o=p.model;var u=o.getUShellService("URLParsing");var l=o.getUShellService("CrossApplicationNavigation");var P=u&&u.parseShellHash(h.getHash());if(P&&P.params){var t=U.getTechnicalParametersForComponent(o.oAppComponent);if(!t){L.warning("Component instance not provided, so technical parameters in component data and browser history remain unchanged");}if(p.parameters.length===0){delete P.params[V.VARIANT_TECHNICAL_PARAMETER];t&&delete t[V.VARIANT_TECHNICAL_PARAMETER];}else{P.params[V.VARIANT_TECHNICAL_PARAMETER]=p.parameters;t&&(t[V.VARIANT_TECHNICAL_PARAMETER]=p.parameters);}if(p.silent){h.changed.active=false;h.replaceHash(u.constructShellHash(P));h.changed.active=true;}else{l.toExternal({target:{semanticObject:P.semanticObject,action:P.action,context:P.contextRaw},params:P.params,appSpecificRoute:P.appSpecificRoute,writeHistory:false});}}}
function j(p){var r={index:-1};var o=p.model;var u=o.getUShellService("URLParsing");var l=u&&u.parseShellHash(h.getHash()).params;if(l){r.parameters=[];if(o._bDesignTimeMode){l[V.VARIANT_TECHNICAL_PARAMETER]=k.getStoredHashParams(p);}if(Array.isArray(l[V.VARIANT_TECHNICAL_PARAMETER])){l[V.VARIANT_TECHNICAL_PARAMETER]=l[V.VARIANT_TECHNICAL_PARAMETER].map(decodeURIComponent);l[V.VARIANT_TECHNICAL_PARAMETER].some(function(P,I){var v=b.getVariant({vmReference:p.vmReference,vReference:P,reference:o.oChangePersistence.getComponentName()});if(v){r.index=I;return true;}});}}return m(r,l&&l[V.VARIANT_TECHNICAL_PARAMETER]&&{parameters:l[V.VARIANT_TECHNICAL_PARAMETER]});}
var k={variantTechnicalParameterName:"sap-ui-fl-control-variant-id",initialize:function(p){var o=p.model;var u=o.getUShellService("URLParsing");var P=u&&u.parseShellHash(h.getHash());var l=P&&P.params&&P.params[V.VARIANT_TECHNICAL_PARAMETER];k.attachHandlers(p);k.update({model:o,parameters:l,updateHashEntry:Array.isArray(l)&&l.length>0});d(P,o);},updateVariantInURL:function(p){var u=k.removeURLParameterForVariantManagement(p);if(!u.parameters){return;}var P=u.parameters||[];var I=u.index;var l=p.newVReference===p.model.oData[p.vmReference].defaultVariant;if(!l){if(I===-1){P=P.concat([p.newVReference]);}else{P=P.slice(0,I).concat([p.newVReference],P.slice(I));}}if(!l||I>-1){k.update({parameters:P,updateURL:!p.model._bDesignTimeMode,updateHashEntry:true,model:p.model});}},removeURLParameterForVariantManagement:function(p){var v=j(p);if(v.index>-1){v.parameters.splice(v.index,1);}return v;},attachHandlers:function(p){function o(){return p.model._oVariantSwitchPromise.then(function(){p.model._oHashData.controlPropertyObservers.forEach(function(l){l.destroy();});g(p.model);p.model.resetMap(true).then(p.model.destroy.bind(p.model));p.model.oComponentDestroyObserver.unobserve(p.model.oAppComponent,{destroy:true});p.model.oComponentDestroyObserver.destroy();});}f(p.model);if(!p.model.oComponentDestroyObserver&&p.model.oAppComponent instanceof C){p.model.oComponentDestroyObserver=new M(o.bind(null));p.model.oComponentDestroyObserver.observe(p.model.oAppComponent,{destroy:true});}},registerControl:function(p){if(p.updateURL){p.model._oHashData.variantControlIds.push(p.vmReference);}},update:function(p){if(!p.model._oHashData){p.model._oHashData={hashParams:[],controlPropertyObservers:[],variantControlIds:[]};}if(!p||!Array.isArray(p.parameters)){L.info("Variant URL parameters could not be updated since invalid parameters were received");return;}if(p.updateURL){s(p);}if(p.updateHashEntry&&!i(p.model)){p.model._oHashData.hashParams=p.parameters;}},getStoredHashParams:function(p){return Array.prototype.slice.call(p.model._oHashData.hashParams);},handleModelContextChange:function(p){var l="modelContextChange";function n(E,P){var v=P.model.getVariantManagementReferenceForControl(E.getSource());var q=P.model._oHashData.variantControlIds;var I=q.indexOf(v);if(I>-1){q.slice(I).forEach(function(r){if(j({vmReference:r,model:p.model}).index===-1){P.model.switchToDefaultForVariantManagement(r);}});}}var o=new M(function(E){if(E.current===true&&E.old===false){E.object.attachEvent(l,{model:p.model},n);}else if(E.current===false&&E.old===true){E.object.detachEvent(l,n);}});o.observe(p.vmControl,{properties:["resetOnContextChange"]});p.model._oHashData.controlPropertyObservers.push(o);if(p.vmControl.getResetOnContextChange()!==false){p.vmControl.attachEvent(l,{model:p.model},n);}},clearAllVariantURLParameters:function(p){k.update({updateURL:true,parameters:[],updateHashEntry:false,model:p.model});}};return k;});
sap.ui.predefine('sap/ui/fl/apply/_internal/controlVariants/Utils',["sap/base/util/includes","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/Variant"],function(i,J,V){"use strict";
function g(A,c){if(!c){return undefined;}if(A.indexOf(c.getId())>-1){return c.getId();}return g(A,c.getParent());}
var a={DEFAULT_AUTHOR:"SAP",VARIANT_TECHNICAL_PARAMETER:"sap-ui-fl-control-variant-id",compareVariants:function(v,o){if(v.content.content.title.toLowerCase()<o.content.content.title.toLowerCase()){return-1;}else if(v.content.content.title.toLowerCase()>o.content.content.title.toLowerCase()){return 1;}return 0;},getIndexToSortVariant:function(v,o){var s=v.length;v.some(function(e,b){if(a.compareVariants(o,e)<0){s=b;return true;}});return s;},createVariant:function(p){var v;var o;var s=p.variantSpecificData.content.variantManagementReference;if(s){var b=J.checkControlId(s,p.model.oAppComponent);if(!b){throw new Error("Generated ID attribute found - to offer flexibility a stable VariantManagement ID is needed to assign the changes to, but for this VariantManagement control the ID was generated by SAPUI5 "+s);}}p.variantSpecificData.content.reference=p.model.sFlexReference;p.variantSpecificData.content.packageName="$TMP";o=V.createInitialFileContent(p.variantSpecificData);v=new V(o);return v;},getRelevantVariantManagementControlId:function(c,v){var A={};var b=v.reduce(function(C,d){var o=sap.ui.getCore().byId(d);var f=o.getFor();f.forEach(function(e){A[e]=d;});return C.concat(f);},[]);var s=g(b,c);return A[s];}};return a;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/FlexState',["sap/base/util/restricted/_omit","sap/base/util/each","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/appDescriptorChanges/prepareAppDescriptorMap","sap/ui/fl/apply/_internal/flexState/changes/prepareChangesMap","sap/ui/fl/apply/_internal/flexState/compVariants/prepareCompVariantsMap","sap/ui/fl/apply/_internal/flexState/controlVariants/prepareVariantsMap","sap/ui/fl/apply/_internal/flexState/Loader","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(_,e,m,O,L,C,p,a,b,c,d,M,S,f,U){"use strict";var F={};var g={};var h={};var i={};var j;var k;var l;var n={appDescriptorChanges:{prepareFunction:p,pathInResponse:[]},changes:{prepareFunction:a,pathInResponse:["changes"]},variants:{prepareFunction:c,pathInResponse:["variants","variantChanges","variantDependentControlChanges","variantManagementChanges"]},compVariants:{prepareFunction:b,pathInResponse:["comp.variants","comp.standardVariants","comp.defaultVariants","comp.changes"]}};var o={compVariants:{},variants:{}};
function u(P){var N=C.get(P.componentId);g[P.reference].componentData=N?N.getComponentData():P.componentData;}
function q(P){var N=C.get(P.componentId);P.componentData=P.componentData||N.getComponentData()||{};P.manifest=P.manifest||P.rawManifest||N.getManifestObject();P.reference=P.reference||M.getFlexReference(P);}
function r(R,N){if(!g[R]){throw new Error("State is not yet initialized");}if(!g[R].preparedMaps[N]){var P={unfilteredStorageResponse:g[R].unfilteredStorageResponse,storageResponse:g[R].storageResponse,componentId:g[R].componentId,componentData:g[R].componentData};g[R].preparedMaps[N]=F.callPrepareFunction(N,P);}return g[R].preparedMaps[N];}
function s(R){return r(R,"appDescriptorChanges");}
function t(R){return r(R,"changes");}
function v(R){return r(R,"variants");}
function w(R){return r(R,"compVariants");}
function x(P){if(P.reference.endsWith(".Component")){var N=P.reference.split(".");N.pop();var R=N.join(".");g[R]=m({},{storageResponse:{changes:S.getEmptyFlexDataResponse()},unfilteredStorageResponse:{changes:S.getEmptyFlexDataResponse()},preparedMaps:{},componentId:P.componentId,partialFlexState:P.partialFlexState});i[R]=i[P.reference];}}
function y(R){var N=m({},R);var P=N.changes;var Q=J("URLParsing");if(f.isLayerFilteringRequired(Q)){e(n,function(T,V){V.pathInResponse.forEach(function(W){O.set(W,f.filterChangeDefinitionsByMaxLayer(O.get(W,P),Q),P);});});}return N;}
function z(P){i[P.reference]=d.loadFlexData(P).then(function(R){g[P.reference]=m({},{unfilteredStorageResponse:R,preparedMaps:{},componentId:P.componentId,componentData:P.componentData,partialFlexState:P.partialFlexState});x(P);A(P.reference);return R;});return i[P.reference];}
function A(R){var N=J("ShellNavigation");if(N){h[R]=D.bind(null,R);N.registerNavigationFilter(h[R]);}}
function B(R){var N=J("ShellNavigation");if(N){if(h[R]){N.unregisterNavigationFilter(h[R]);delete h[R];}}}
function D(R,N,P){var Q=J("ShellNavigation");if(Q){try{var T=f.getMaxLayerTechnicalParameter(N,J("URLParsing"));var V=f.getMaxLayerTechnicalParameter(P,J("URLParsing"));if(T!==V){F.clearFilteredResponse(R);}}catch(W){L.error(W.message);}return Q.NavigationFilterStatus.Continue;}return undefined;}
function E(R){g[R].preparedMaps={};}
function G(N){var P=g[N.reference];if(P.partialFlexState===true&&N.partialFlexState!==true){P.partialFlexState=false;N.partialFlexData=m({},P.unfilteredStorageResponse.changes);N.reInitialize=true;}return N;}
function H(N){var P=g[N.reference].componentId;if(!N.reInitialize&&P!==N.componentId){N.reInitialize=true;}return N;}
function I(){return Promise.all([U.getUShellService("ShellNavigation"),U.getUShellService("URLParsing")]).then(function(N){j=N[0];k=N[1];}).catch(function(N){L.error("Error getting service from Unified Shell: "+N.message);});}
function J(N){if(U.getUshellContainer()){if(N==="ShellNavigation"){return j;}else if(N==="URLParsing"){return k;}}return undefined;}
function K(){return Promise.all([U.requireAsync("sap/ui/fl/ChangePersistenceFactory")]).then(function(N){l=N[0];}).catch(function(N){L.error("Error loading modules: "+N.message);});}
F.initialize=function(P){return Promise.all([I(),K()]).then(function(){q(P);var N=P.reference;if(i[N]){return i[N].then(G.bind(null,P)).then(H).then(function(Q){return Q.reInitialize?z(Q):g[N].unfilteredStorageResponse;});}return z(P);}).then(function(P,R){if(!g[P.reference].storageResponse){g[P.reference].storageResponse=y(R);u(P);}}.bind(null,P));};
F.clearAndInitialize=function(P){q(P);F.clearState(P.reference);F.clearState(U.normalizeReference(P.reference));return F.initialize(P);};
F.clearState=function(R){if(R){B(R);delete g[R];delete i[R];if(l&&(l._instanceCache||{}).hasOwnProperty(R)){l._instanceCache[R].removeDirtyChanges();}}else{Object.keys(g).forEach(function(R){B(R);});g={};i={};}};
F.setInitialNonFlCompVariantData=function(R,P,N,V){o.compVariants[R]={};o.compVariants[R][P]={};o.compVariants[R][P].standardVariant=N;o.compVariants[R][P].variants=V;};
F.getInitialNonFlCompVariantData=function(R){return o.compVariants[R];};
F.setFakeStandardVariant=function(R,N,P){var V=F.getVariantsState(R);if(!V[Object.keys(P)[0]]){m(V,P);o.variants[R]=o.variants[R]||{};o.variants[R][N]=o.variants[R][N]||{};m(o.variants[R][N],P);}};
F.resetFakedStandardVariants=function(R,N){if(o.variants[R]){delete o.variants[R][N];}};
F.clearFilteredResponse=function(R,N){if(g[R]&&(!N||N===g[R].componentId)){E(R);delete g[R].storageResponse;}};
F.getUIChanges=function(R){return t(R).changes;};
F.getAppDescriptorChanges=function(R){return s(R).appDescriptorChanges;};
F.getVariantsState=function(R){var V=v(R);if(o.variants[R]){e(o.variants[R],function(N,P){if(g[R].componentId===N){e(P,function(Q,T){if(!V[Q]){V[Q]=T;}});}});}return V;};
F.getUI2Personalization=function(R){return g[R].unfilteredStorageResponse.changes.ui2personalization;};
F.getCompVariantsMap=function(R){return w(R);};
F.callPrepareFunction=function(N,P){return n[N].prepareFunction(P);};
F.getStorageResponse=function(R){if(i[R]){return i[R].then(function(){return g[R].unfilteredStorageResponse;});}return undefined;};
F.getFlexObjectsFromStorageResponse=function(R){return g[R]&&g[R].unfilteredStorageResponse.changes;};
return F;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/Loader',["sap/base/util/deepClone","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/initial/_internal/Storage","sap/ui/fl/Utils"],function(d,M,A,U){"use strict";
function g(s){if(typeof s==="string"){s={id:s};}s.idIsLocal=true;return s;}
function m(b,F){if(b){[F.changes,F.variantChanges,F.variantDependentControlChanges,F.variantManagementChanges].forEach(function(c){for(var i=c.length-1;i>=0;i--){var o=c[i];if(!o.selector.idIsLocal){var e=d(o);o.cloned=true;e.selector=g(e.selector);if(e.dependentSelector){Object.keys(e.dependentSelector).forEach(function(e,C){if(Array.isArray(e.dependentSelector[C])){e.dependentSelector[C]=e.dependentSelector[C].map(g);}else{e.dependentSelector[C]=g(e.dependentSelector[C]);}}.bind(undefined,e));}c.splice(i,0,e);}}});}return F;}
function a(o){return o&&!!M.getOvpEntry(o);}
function f(F){return{changes:F,cacheKey:F.cacheKey};}
return{loadFlexData:function(p){var c=M.getBaseComponentNameFromManifest(p.manifest);if(p.partialFlexData){return A.completeFlexData({reference:p.reference,componentName:c,partialFlexData:p.partialFlexData}).then(f);}var C=p.reInitialize?undefined:M.getCacheKeyFromAsyncHints(p.reference,p.asyncHints);return A.loadFlexData({preview:M.getPreviewSectionFromAsyncHints(p.asyncHints),reference:p.reference,componentName:c,cacheKey:C,siteId:U.getSiteIdByComponentData(p.componentData),appDescriptor:p.manifest.getRawJson?p.manifest.getRawJson():p.manifest,version:p.version,allContexts:p.allContexts}).then(m.bind(undefined,a(p.manifest))).then(f);}};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/appDescriptorChanges/prepareAppDescriptorMap',["sap/ui/fl/Change"],function(C){"use strict";return function(p){var c=p.storageResponse.changes.appDescriptorChanges||[];var a=c.map(function(o){return new C(o);});return{appDescriptorChanges:a};};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler',["sap/base/util/includes","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/Utils"],function(i,J,U){"use strict";var P="sap.ui.fl:PendingChange";var D={};
function g(s,A){return J.getControlIdBySelector(s,A);}
function c(C){return{changeObject:C,dependencies:[],controlsDependencies:[],dependentIds:[]};}
function a(s,C,o){d(o,C,s);b(o,C);}
function b(C,o){if(!i(C.aChanges,o)){C.aChanges.push(o);}}
function d(C,o,s){if(!C.mChanges[s]){C.mChanges[s]=[];}if(!i(C.mChanges[s],o)){C.mChanges[s].push(o);}}
function e(C,A,o){var s=C.getSelector();if(s){if(s.id){a(g(s,A),C,o);}else{b(o,C);}}return o.aChanges;}
function f(E,o){return E.some(function(p){return(p.id===o.id&&p.idIsLocal===o.idIsLocal);});}
function h(t,o,E,C,A,p,q){var r=E.getDependentSelectorList();o.some(function(s){if(f(r,s)){var u=g(s,A);var I=C&&p.indexOf(t)<p.indexOf(E);if(I){l(E,t,u,q,true);}else{l(t,E,u,q);}return true;}});}
function j(t,A,C,o){if(t.isValidForDependencyMap()){var p=t.getDependentSelectorList();k(t,p,A,o);var I=C.indexOf(t);var q=I<(C.length-1);var O=C.slice();O.splice(I,1);O.reverse().forEach(function(E){if(E.isValidForDependencyMap()){h(t,p,E,q,A,C,o);}});}}
function k(o,p,A,C){if(p.length){var q=p.map(function(s){return g(s,A);});if(!C.mDependencies[o.getId()]){C.mDependencies[o.getId()]=c(o);}C.mDependencies[o.getId()].controlsDependencies=q;q.forEach(function(I){C.mControlsWithDependencies[I]=C.mControlsWithDependencies[I]||[];C.mControlsWithDependencies[I].push(o.getId());});}}
function l(o,C,s,p,I){if(m(o,C,s,p,I)){p.mDependencies[o.getId()].dependencies.push(C.getId());if(!i(p.mDependencies[o.getId()].dependentIds,s)){p.mDependencies[o.getId()].dependentIds.push(s);}if(!p.mDependentChangesOnMe[C.getId()]){p.mDependentChangesOnMe[C.getId()]=[];}p.mDependentChangesOnMe[C.getId()].push(o.getId());}}
function m(o,C,s,p,I){var S=!I&&i(p.mDependencies[o.getId()].dependentIds,s);var q=false;if(p.mDependentChangesOnMe[C.getId()]){p.mDependentChangesOnMe[C.getId()].some(function(r){q=i(p.mDependencies[o.getId()].dependencies,r);return q;});}return!S&&!q;}
function n(C,s){var o=[];var p=[];var q=[];if(C.dependencyRemovedInLastBatch[s]){C.dependencyRemovedInLastBatch[s].forEach(function(r){var t=C.mDependencies[r];if(t&&t.dependencies.length===0&&!(t.controlsDependencies&&t.controlsDependencies.length)){p.push(r);o.push(t.changeObject.getId());if(t[P]){q.push(function(){return t[P]();});}}});}return U.execPromiseQueueSequentially(q).then(function(o,p,s){delete C.dependencyRemovedInLastBatch[s];p.forEach(function(r){delete C.mDependencies[r];});o.forEach(function(r){D.resolveDependenciesForChange(C,r,s);});return!!o.length;}.bind(undefined,o,p,s));}
D.createEmptyDependencyMap=function(){return{aChanges:[],mChanges:{},mDependencies:{},mDependentChangesOnMe:{},mControlsWithDependencies:{},dependencyRemovedInLastBatch:{}};};
D.addChangeAndUpdateDependencies=function(C,A,o){var p=e(C,A,o);j(C,A,p,o);};
D.insertChange=function(C,o,r){var I=o&&o.aChanges&&o.aChanges.indexOf(r);if(I>-1){o.aChanges.splice(I+1,0,C);}};
D.addRuntimeChangeAndUpdateDependencies=function(C,A,o,I){var p=e(C,A,o);j(C,A,p,I);};
D.processDependentQueue=function(C,A,s){return n(C,s).then(function(s,o){if(o){return D.processDependentQueue(C,A,s);}}.bind(undefined,s));};
D.addChangeApplyCallbackToDependency=function(C,s,o){C.mDependencies[s][P]=o;};
D.removeControlsDependencies=function(C,s){var o=C.mControlsWithDependencies[s];if(o){o.forEach(function(p){var q=C.mDependencies[p];if(q&&q.controlsDependencies&&q.controlsDependencies.length){var I=q.controlsDependencies.indexOf(s);if(I>-1){q.controlsDependencies.splice(I,1);delete C.mControlsWithDependencies[s];C.dependencyRemovedInLastBatch[s]=C.dependencyRemovedInLastBatch[s]||[];if(!i(C.dependencyRemovedInLastBatch[s],p)){C.dependencyRemovedInLastBatch[s].push(p);}}}});delete C.mControlsWithDependencies[s];}};
D.resolveDependenciesForChange=function(C,s,o){var p=C.mDependentChangesOnMe[s];if(p){p.forEach(function(K){var q=C.mDependencies[K];var I=q?q.dependencies.indexOf(s):-1;if(I>-1){q.dependencies.splice(I,1);C.dependencyRemovedInLastBatch[o]=C.dependencyRemovedInLastBatch[o]||[];if(!i(C.dependencyRemovedInLastBatch[o],K)){C.dependencyRemovedInLastBatch[o].push(K);}}});delete C.mDependentChangesOnMe[s];}};
D.removeChangeFromMap=function(C,s){Object.keys(C.mChanges).some(function(o){var p=C.mChanges[o];var q=p.map(function(E){return E.getId();}).indexOf(s);if(q!==-1){p.splice(q,1);return true;}});var I=C.aChanges.map(function(E){return E.getId();}).indexOf(s);if(I!==-1){C.aChanges.splice(I,1);}};
D.removeChangeFromDependencies=function(C,s,o){D.resolveDependenciesForChange(C,s,o);delete C.mDependencies[s];};
D.checkForOpenDependenciesForControl=function(C,s,A){return Object.keys(C.mDependencies).some(function(K){return C.mDependencies[K].changeObject.getDependentSelectorList().some(function(o){return J.getControlIdBySelector(o,A)===s;});});};
return D;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/changes/prepareChangesMap',["sap/ui/fl/Change"],function(C){"use strict";return function(p){var c=p.storageResponse.changes.changes;var a=c.map(function(o){return new C(o);});return{changes:a};};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger',["sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/base/Log"],function(C,L){"use strict";var c={addFavorite:function(v){v.setFavorite(true);},removeFavorite:function(v){v.setFavorite(false);},updateVariant:function(v,o){var a=o.getContent();if(a.executeOnSelection!==undefined){v.setExecuteOnSelection(a.executeOnSelection);}if(a.favorite!==undefined){v.setFavorite(a.favorite);}if(a.contexts){v.setContexts(a.contexts);}if(a.variantContent){v.setContent(a.variantContent);}var V=o.getText("variantName");if(V){v.setName(V);}},standardVariant:function(v,o){v.setExecuteOnSelection(o.getContent().executeOnSelect);}};
function g(m){var a={};m.changes.forEach(function(o){var v=o.getSelector().variantId||o.getContent().key;if(!a[v]){a[v]=[];}a[v].push(o);});return a;}
function l(v,o){L.error("No change handler for change with the ID '"+o.getId()+"' and type '"+o.getChangeType()+"' defined.\n"+"The variant '"+v.getId()+"'was not modified'");}
function d(p,v){var V={fileName:v.id||C.STANDARD_VARIANT_ID,persisted:v.persisted,content:v.content||{},texts:{variantName:{value:v.name||""}},selector:{persistencyKey:p}};if(v.favorite!==undefined){V.favorite=v.favorite;}if(v.executeOnSelection!==undefined){V.executeOnSelection=v.executeOnSelection;}return new C(V);}
function e(v,o){var a=c[o.getChangeType()]||l;a(v,o);v.addChange(o);}
function f(m,v){var V=v.getId();if(m[V]){m[V].forEach(function(o){e(v,o);});}}
return{merge:function(p,m,s){var v=m.nonPersistedVariants.concat(m.variants);var h=g(m);var S;v.forEach(function(V){if(V.getContent()&&V.getContent().standardvariant){S=V;}});if(!S){S=d(p,s);}else{v=v.filter(function(V){return!V.getContent()||!V.getContent().standardvariant;});}v.forEach(f.bind(undefined,h));S.setFavorite(true);S.setStandardVariant(true);m.byId[S.getId()]=S;var o=m.standardVariantChange;if(o){h[S.getId()]=h[S.getId()]||[];h[S.getId()].push(o);h[S.getId()].sort(function(a,b){if(a.getDefinition().creation<b.getDefinition().creation){return-1;}if(a.getDefinition().creation>b.getDefinition().creation){return 1;}return 0;});}f(h,S);m.standardVariant=S;return{standardVariant:S,variants:v};},createVariant:function(p,v){return d(p,v);},applyChangeOnVariant:e};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/compVariants/prepareCompVariantsMap',["sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UpdatableChange","sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger"],function(C,S,U,a){"use strict";
function g(m,p){m[p]=m[p]||{byId:{},variants:[],nonPersistedVariants:[],changes:[],defaultVariants:[],standardVariantChange:undefined,standardVariant:undefined};return m[p];}
function i(m,p,v){v=v||[];var M=g(m,p);M.nonPersistedVariants.forEach(function(V){delete M.byId[V.getId()];});M.nonPersistedVariants=v.map(function(V){var o=Object.assign({id:V.id,persisted:false},V);o=a.createVariant(p,o);M.byId[V.id]=o;return o;});return M;}
function b(c,s,m){var o=s==="variants"?C:U;var f=c[s].map(function(d){var F=new o(d);F.setState(S.PERSISTED);return F;});f.forEach(function(F){var p=F.getSelector().persistencyKey;g(m,p).byId[F.getId()]=F;switch(s){case"standardVariants":g(m,p).standardVariantChange=F;break;default:g(m,p)[s].push(F);}});}
return function(p){var c={};c._getOrCreate=g.bind(undefined,c);c._initialize=i.bind(undefined,c);if(p.storageResponse.changes.comp){["variants","changes","defaultVariants","standardVariants"].forEach(function(s){b(p.storageResponse.changes.comp,s,c);});}return c;};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/controlVariants/Switcher',["sap/base/util/includes","sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/changes/Reverter"],function(i,_,V,R){"use strict";
function a(p){var c=V.getControlChangesForVariant(Object.assign(_(p,["vmReference","variantsMap","reference"]),{changeInstance:true,vReference:p.currentVReference}));var n=V.getControlChangesForVariant(Object.assign(_(p,["vmReference","variantsMap","reference"]),{changeInstance:true,vReference:p.newVReference}));var m=Object.keys(p.changesMap).reduce(function(b,d){return b.concat(p.changesMap[d]);},[]);var C=m.map(function(o){return o.getId();});var f=c.reduce(function(F,o){var M=C.indexOf(o.getId());if(M>-1){F=F.concat(m[M]);}return F;},[]);var r=[];if(n.length>0){r=f.slice();f.some(function(o){if(n[0]&&o.getId()===n[0].getId()){n.shift();r.shift();}else{return true;}});}else{r=f;}var s={changesToBeReverted:r.reverse(),changesToBeApplied:n};return s;}
var S={switchVariant:function(p){return Promise.resolve().then(function(){p.changesMap=p.flexController._oChangePersistence.getChangesMapForComponent().mChanges;p.variantsMap=V.getContent(p.reference);var c=a(p);return R.revertMultipleChanges(c.changesToBeReverted,p).then(p.flexController.applyVariantChanges.bind(p.flexController,c.changesToBeApplied,p.appComponent)).then(V.setCurrentVariant.bind(null,p));});}};return S;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState',["sap/base/util/restricted/_omit","sap/base/util/restricted/_pick","sap/base/util/includes","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/util/each","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/Change","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/fl/Variant"],function(_,a,i,b,m,O,e,L,J,V,S,F,C,c,U,d){"use strict";var f={};
function g(p){var r=[];if(p.variantData.content.variantReference){r=f.getControlChangesForVariant(Object.assign(p,{vReference:p.variantData.content.variantReference,changeInstance:true}));return r.filter(function(R){return c.compareAgainstCurrentLayer(R.getDefinition().layer,p.variantData.content.layer)===-1;});}return r;}
function h(p){var v=f.getContent(p.reference);var o=O.get([p.vmReference,"variants"],v);return o||[];}
function j(v,o,A){var s=o.changeType;if(!v){v={};}if(!v[s]){v[s]=[];}if(A){v[s].push(o);return true;}return v[s].some(function(E,I){if(E.fileName===o.fileName){v[s].splice(I,1);return true;}});}
function k(o,p){var s=n(o);p[s].push(o);}
function l(o,p){var s=n(o);var q=-1;p[s].some(function(E,I){if(E.fileName===o.fileName){q=I;return true;}});if(q>-1){p[s].splice(q,1);}}
function n(o){switch(o.fileType){case"change":return"variantDependentControlChanges";case"ctrl_variant":return"variants";case"ctrl_variant_change":return"variantChanges";case"ctrl_variant_management_change":return"variantManagementChanges";default:}}
f.getContent=function(r){return F.getVariantsState(r);};
f.addFakeStandardVariant=function(r,s,o){F.setFakeStandardVariant(r,s,o);};
f.clearFakedStandardVariants=function(r,s){F.resetFakedStandardVariants(r,s);};
f.resetContent=function(r,s){F.clearFilteredResponse(r,s);};
f.getControlChangesForVariant=function(p){var r=[];var v=f.getVariant(p);if(v){r=v.controlChanges;if(!p.changeInstance){r=r.map(function(o){return o.getDefinition();});}}return r;};
f.getVariantChangesForVariant=function(p){var v=f.getVariant(p);return v&&v.variantChanges||{};};
f.getVariant=function(p){var v;var o=f.getContent(p.reference);p.vReference=p.vReference||o[p.vmReference].defaultVariant;var q=h(p);q.some(function(r){if(r.content.fileName===p.vReference){v=r;return true;}});return v;};
f.getCurrentVariantReference=function(p){var v=f.getContent(p.reference);var o=v[p.vmReference];return o.currentVariant||o.defaultVariant;};
f.getVariantManagementReferences=function(r){var v=f.getContent(r);return Object.keys(v);};
f.addVariantToVariantManagement=function(p){var v=f.getContent(p.reference);var o=v[p.vmReference].variants.slice().splice(1);var I=V.getIndexToSortVariant(o,p.variantData);if(p.variantData.content.variantReference){var r=g(p);p.variantData.controlChanges=r.concat(p.variantData.controlChanges);}v[p.vmReference].variants.splice(I+1,0,p.variantData);return I+1;};
f.removeVariantFromVariantManagement=function(p){var I;var v=f.getContent(p.reference);var o=v[p.vmReference].variants.some(function(q,r){var s=new d(q);if(s.getId()===p.variant.getId()){I=r;return true;}});if(o){v[p.vmReference].variants.splice(I,1);}return I;};
f.setVariantData=function(p){var v=f.getContent(p.reference);var o=v[p.vmReference].variants;var q=o[p.previousIndex];Object.keys(p.variantData).forEach(function(P){if(q.content.content[P]){q.content.content[P]=p.variantData[P];}});if(q.content.fileName!==p.vmReference){o.splice(p.previousIndex,1);var s=V.getIndexToSortVariant(o.slice(1),q);o.splice(s+1,0,q);return s+1;}o.splice(p.previousIndex,1,q);return p.previousIndex;};
f.addChangeToVariant=function(p){var E=f.getControlChangesForVariant(Object.assign(p,{changeInstance:true}));var o=E.map(function(q){return q.getDefinition().fileName;});if(!i(o,p.change.getDefinition().fileName)){var v=f.getVariant(p);v.controlChanges=E.concat([p.change]);return true;}return false;};
f.removeChangeFromVariant=function(p){var o=f.getControlChangesForVariant(Object.assign(p,{changeInstance:true}));var v=f.getVariant(p);var q=false;if(v){v.controlChanges=o.filter(function(r){if(!q&&r.getId()===p.change.getId()){q=true;return false;}return true;});}return q;};
f.getInitialChanges=function(p){var v=f.getContent(p.reference);return Object.keys(v).reduce(function(I,s){if((p.vmReference&&p.vmReference===s)||!p.vmReference){var o=v[s].currentVariant?"currentVariant":"defaultVariant";var A={vmReference:s,vReference:v[s][o],reference:p.reference,changeInstance:p.changeInstance};return I.concat(f.getControlChangesForVariant(Object.assign({},p,A)));}return I;},[]);};
f.fillVariantModel=function(p){var v=f.getContent(p.reference);return Object.keys(v).reduce(function(o,s){o[s]={defaultVariant:v[s].defaultVariant,variants:[]};if(v[s].currentVariant){o[s].currentVariant=v[s].currentVariant;}h(Object.assign(p,{vmReference:s})).forEach(function(q,r){o[s].variants[r]=JSON.parse(JSON.stringify({key:q.content.fileName,title:q.content.content.title,layer:q.content.layer,favorite:q.content.content.favorite,executeOnSelect:q.content.content.executeOnSelect,visible:q.content.content.visible,author:O.get("content.support.user",q)}));});return o;},{});};
f.updateChangesForVariantManagementInMap=function(p){var v=f.getContent(p.reference);var o=v[p.vmReference];if(p.changeContent.fileType==="ctrl_variant_change"){o.variants.some(function(q){if(q.content.fileName===p.changeContent.selector.id){j(q.variantChanges,p.changeContent,p.add);}});}else if(p.changeContent.fileType==="ctrl_variant_management_change"){j(o.variantManagementChanges,p.changeContent,p.add);}};
f.setCurrentVariant=function(p){var v=f.getContent(p.reference);if(O.get([p.vmReference],v)){v[p.vmReference].currentVariant=p.newVReference;}};
f.updateVariantsState=function(p){var v=f.getContent(p.reference);if(b(v)){L.error("Variant state is not initialized yet");return;}var o=F.getFlexObjectsFromStorageResponse(p.reference);if(p.changeToBeAddedOrDeleted){switch(p.changeToBeAddedOrDeleted.getState()){case S.NEW:k(p.changeToBeAddedOrDeleted.getDefinition(),o);break;case S.DELETE:l(p.changeToBeAddedOrDeleted.getDefinition(),o);break;default:}}};
f.waitForInitialVariantChanges=function(p){var o=f.getInitialChanges({vmReference:p.vmReference,reference:p.reference,changeInstance:true});var q=o.reduce(function(r,s){var t=s.getSelector();var u=J.bySelector(t,p.appComponent);if(u&&U.indexOfObject(r,{selector:u})===-1){r.push({selector:u});}return r;},[]);return q.length?p.flexController.waitForChangesToBeApplied(q):Promise.resolve();};
return f;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/controlVariants/prepareVariantsMap',["sap/base/util/ObjectPath","sap/base/Log","sap/ui/fl/Change","sap/base/util/includes","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/base/util/isEmptyObject","sap/base/util/each","sap/base/util/values","sap/base/util/merge","sap/ui/fl/LayerUtils"],function(O,L,C,i,V,a,e,v,m,b){"use strict";
function c(z,A){var B=m({},z);A.forEach(function(D){B[D.fileName]={content:D,controlChanges:[],variantChanges:{}};});return B;}
function d(z,A){var B=m({},z);A.forEach(function(D){var E=new C(D);E.setState(C.states.PERSISTED);B[D.variantReference]=B[D.variantReference]||s(D.variantReference);B[D.variantReference].controlChanges.push(E);});return B;}
function f(z,A){var B=m({},z);A.forEach(function(D){B[D.selector.id]=B[D.selector.id]||s(D.selector.id);var E=B[D.selector.id].variantChanges[D.changeType]||[];E.push(D);B[D.selector.id].variantChanges[D.changeType]=E;});return B;}
function g(z){var A=m({},z);v(z).forEach(function(B){var S=O.get("variantChanges.setVisible",B);if(S&&S.length>0){var D=w(S);if(!D.getContent().visible&&D.getContent().createdByReset){delete A[B.content.fileName];}}});return A;}
function r(z){var A=m({},z);v(A).forEach(function(B){var D=B.content.variantReference;var R;if(D){R=j(A,D,B.content.variantManagementReference);}B.controlChanges=h(R,B.content.layer).concat(B.controlChanges);});return A;}
function h(R,z){if(!R){return[];}return v(m({},R.controlChanges)).filter(function(A){return b.compareAgainstCurrentLayer(A.getLayer(),z)===-1;});}
function j(z,A,B){var R=z[A];if(!R&&A===B){R=s(A);z[A]=R;}return R;}
function k(S){var z={};z=c(z,S.variants);z=d(z,S.variantDependentControlChanges);z=f(z,S.variantChanges);z=g(z);z=r(z);return z;}
function l(){return{variantManagementChanges:{},variants:[]};}
function n(R,z,T){var A=m({},R);v(z).forEach(function(B){var D=B.content.variantManagementReference;if(!A[D]){A[D]=l();}B=y(B);B=u(B);if(!A[D].currentVariant&&B.content.content.visible&&i(T,B.content.fileName)){A[D].currentVariant=B.content.fileName;}A[D].defaultVariant=D;var S=V.getIndexToSortVariant(A[D].variants,B);A[D].variants.splice(S,0,B);});return A;}
function o(R,z){var A=m({},R);z.forEach(function(B){var D=B.selector.id;if(!A[D]){A[D]=l();}var E=B.changeType;if(!A[D].variantManagementChanges[E]){A[D].variantManagementChanges[E]=[];}A[D].variantManagementChanges[E].push(B);A[D]=t(A[D]);});return A;}
function p(R){var z=m({},R);e(z,function(A,B){var S=B.variants.findIndex(function(E){return E.content.fileName===A;});var D;if(S===-1){D=s(A);}else{D=B.variants[S];B.variants.splice(S,1);}B.variants.unshift(D);});return z;}
function q(z,A,T){var R={};R=n(R,z,T);R=o(R,A);R=p(R);return R;}
function s(z){var R=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");return{content:{fileName:z,variantManagementReference:z,variantReference:"",content:{title:R.getText("STANDARD_VARIANT_TITLE"),favorite:true,visible:true},support:{user:V.DEFAULT_AUTHOR}},variantChanges:{},controlChanges:[]};}
function t(z){var A=m({},z);var B=A.variantManagementChanges;var D;if(!a(B)){D=w(B["setDefault"]);if(D){A.defaultVariant=D.getContent().defaultVariant;}}return A;}
function u(z){var A=m({},z);var B=A.variantChanges;var D;e(B,function(E,F){switch(E){case"setTitle":D=w(F);if(D){A.content.content.title=D.getText("title");}break;case"setFavorite":D=w(F);if(D){A.content.content.favorite=D.getContent().favorite;}break;case"setExecuteOnSelect":D=w(F);if(D){A.content.content.executeOnSelect=D.getContent().executeOnSelect;}break;case"setVisible":D=w(F);if(D){A.content.content.visible=D.getContent().visible;}break;default:L.error("No valid changes on variant "+A.content.content.title+" available");}});return A;}
function w(z){if(z.length>0){return new C(z[z.length-1]);}return false;}
function x(T){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl").getText(T);}
function y(z){var A=m({},z);if(A.content.fileName===A.content.variantManagementReference){if(!O.get("content.support.user",A)){var S={support:{user:V.DEFAULT_AUTHOR}};m(A.content,S);}}if(!A.content.content.favorite){A.content.content.favorite=true;}if(!A.content.content.visible){A.content.content.visible=true;}if(!A.content.content.executeOnSelect){A.content.content.executeOnSelect=false;}var T=A.content.content.title.match(/.i18n>(\w+)./);if(T){A.content.content.title=x(T[1]);}return A;}
return function(P){if(a(P)||!O.get("storageResponse.changes.variants",P)){return{};}var T=O.get(["technicalParameters",V.VARIANT_TECHNICAL_PARAMETER],P.componentData)||[];var z=k(P.storageResponse.changes);z=q(z,P.storageResponse.changes.variantManagementChanges,T);return z;};});
sap.ui.predefine('sap/ui/fl/apply/api/DelegateMediatorAPI',["sap/ui/fl/apply/_internal/DelegateMediator"],function(D){"use strict";var a={registerDefaultDelegate:function(p){D.registerDefaultDelegate(p);},getDelegateForControl:function(p){return D.getDelegateForControl(p.control,p.modifier,p.modelType,p.supportsDefault);},getKnownDefaultDelegateLibraries:function(){return D.getKnownDefaultDelegateLibraries();},getRequiredLibrariesForDefaultDelegate:function(p){return D.getRequiredLibrariesForDefaultDelegate(p.delegateName,p.control,p.modelType);}};return a;},false);
sap.ui.predefine('sap/ui/fl/initial/_internal/Storage',["sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/Utils","sap/ui/fl/initial/_internal/StorageResultMerger","sap/ui/fl/initial/_internal/storageResultDisassemble"],function(S,F,a,s){"use strict";
function _(C,o,p){if(!o.layers||(o.layers[0]!=="ALL"&&o.layers.indexOf("CUSTOMER")===-1)){delete C.version;return C;}if(p.version!==undefined){C.version=p.version;return C;}var v=F.getUrlParameter(sap.ui.fl.Versions.UrlParameter);if(v===null){delete C.version;}else{C.version=parseInt(v);}return C;}
function b(p,C){var h=C.map(function(o){var i=Object.assign({},p,{url:o.url,path:o.path});i=_(i,o,p);return o.loadConnectorModule.loadFlexData(i).then(function(r){return r||S.getEmptyFlexDataResponse();}).catch(S.logAndResolveDefault.bind(undefined,S.getEmptyFlexDataResponse(),o,"loadFlexData"));});return Promise.all(h);}
function c(r){var h=[];r.forEach(function(R){if(Array.isArray(R)){h=h.concat(R);}else{h.push(R);}});return h;}
function d(r){return r.map(function(R){return s(R);});}
function e(r){return Promise.resolve(r).then(c).then(d).then(c).then(a.merge);}
function f(p){return S.getStaticFileConnector().then(b.bind(this,p));}
var g={};
g.completeFlexData=function(p){if(!p||!p.reference){return Promise.reject("No reference was provided");}return Promise.all([f(p),p.partialFlexData]).then(e);};
g.loadFlexData=function(p){if(!p||!p.reference){return Promise.reject("No reference was provided");}return S.getLoadConnectors().then(b.bind(this,p)).then(e);};
return g;});
sap.ui.predefine('sap/ui/fl/initial/_internal/StorageResultMerger',["sap/base/util/merge","sap/base/util/ObjectPath"],function(m,O){"use strict";var s={};
function c(r,p){var f=r.reduce(function(f,R){if(O.get(p,R)){return f.concat(O.get(p,R));}return f;},[]);var F=[];return f.filter(function(o){var b=o.fileName;var d=F.indexOf(b)!==-1;if(d&&!o.cloned){return false;}F.push(b);return true;});}
function a(r){return r.reduce(function(u,R){return m({},u,R.ui2personalization);},{});}
function _(r){return r.reduce(function(C,R){return R.cacheKey?C+=R.cacheKey:C;},"")||null;}
s.merge=function(r){return{appDescriptorChanges:c(r,"appDescriptorChanges"),changes:c(r,"changes"),ui2personalization:a(r),comp:{variants:c(r,"comp.variants"),changes:c(r,"comp.changes"),defaultVariants:c(r,"comp.defaultVariants"),standardVariants:c(r,"comp.standardVariants")},variants:c(r,"variants"),variantChanges:c(r,"variantChanges"),variantDependentControlChanges:c(r,"variantDependentControlChanges"),variantManagementChanges:c(r,"variantManagementChanges"),cacheKey:_(r)};};
return s;});
sap.ui.predefine('sap/ui/fl/initial/_internal/StorageUtils',["sap/base/security/encodeURLParameters","sap/base/Log","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/base/util/isEmptyObject"],function(e,L,c,d,i){"use strict";var C={load:{LrepConnector:"sap/ui/fl/initial/_internal/connectors/LrepConnector",NeoLrepConnector:"sap/ui/fl/initial/_internal/connectors/NeoLrepConnector",PersonalizationConnector:"sap/ui/fl/initial/_internal/connectors/PersonalizationConnector",KeyUserConnector:"sap/ui/fl/initial/_internal/connectors/KeyUserConnector",StaticFileConnector:"sap/ui/fl/initial/_internal/connectors/StaticFileConnector",ObjectStorageConnector:"sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector",JsObjectConnector:"sap/ui/fl/write/_internal/connectors/JsObjectConnector",ObjectPathConnector:"sap/ui/fl/write/_internal/connectors/ObjectPathConnector",LocalStorageConnector:"sap/ui/fl/write/_internal/connectors/LocalStorageConnector",SessionStorageConnector:"sap/ui/fl/write/_internal/connectors/SessionStorageConnector"},write:{LrepConnector:"sap/ui/fl/write/_internal/connectors/LrepConnector",NeoLrepConnector:"sap/ui/fl/write/_internal/connectors/NeoLrepConnector",PersonalizationConnector:"sap/ui/fl/write/_internal/connectors/PersonalizationConnector",KeyUserConnector:"sap/ui/fl/write/_internal/connectors/KeyUserConnector",StaticFileConnector:"sap/ui/fl/write/_internal/connectors/StaticFileConnector",JsObjectConnector:"sap/ui/fl/write/_internal/connectors/JsObjectConnector",ObjectPathConnector:"sap/ui/fl/write/_internal/connectors/ObjectPathConnector",LocalStorageConnector:"sap/ui/fl/write/_internal/connectors/LocalStorageConnector",SessionStorageConnector:"sap/ui/fl/write/_internal/connectors/SessionStorageConnector"}};var I="sap/ui/fl/initial/_internal/connectors/";var S={connector:"StaticFileConnector"};
function _(l,v){return l.filter(function(a){return v.indexOf(a)!==-1||v[0]==="ALL";});}
function s(r){function b(o,a){return new Date(o.creation)-new Date(a.creation);}["changes","variantChanges","variants","variantDependentControlChanges","variantManagementChanges"].forEach(function(a){r[a]=r[a].sort(b);});if(r.comp){["changes","defaultVariants","standardVariants"].forEach(function(a){r.comp[a]=r.comp[a].sort(b);});}return r;}
function f(n,l,m){return m.map(function(a){var b=a.connector;var h;if(!a.loadConnector&&!a.applyConnector&&!a.loadConnector){h=l?C.load[b]:C.write[b];}else if(l){h=a.loadConnector||a.applyConnector;}else{h=a.writeConnector||"sap/ui/fl/write/connectors/BaseConnector";}return h;});}
function g(n,l,m){var a=f(n,l,m);return new Promise(function(r){sap.ui.require(a,function(){Array.from(arguments).forEach(function(o,b){if(!m[b].layers){m[b].layers=o.layers;}else{m[b].layers=_(m[b].layers,o.layers);}if(l){m[b].loadConnectorModule=o;}else{m[b].writeConnectorModule=o;}});r(m);});});}
return{getConnectors:function(n,l){var a=sap.ui.getCore().getConfiguration().getFlexibilityServices();var m=[];if(l){m=[S];}m=m.concat(a);return g(n,l,m);},getLoadConnectors:function(){return this.getConnectors(I,true);},getStaticFileConnector:function(){return g(I,true,[S]);},logAndResolveDefault:function(r,o,F,E){L.error("Connector ("+o.connector+") failed call '"+F+"': "+E+"\nApplication startup continues without data from this storage.");return r;},filterAndSortResponses:function(G){var r=[];Object.keys(G).forEach(function(l){r.push(G[l]);});r=r.filter(function(R){return R.changes.length>0||R.variants.length>0||R.variantChanges.length>0||R.variantManagementChanges.length>0||R.variantDependentControlChanges.length>0||R.comp.variants.length>0||R.comp.changes.length>0||R.comp.defaultVariants.length>0||R.comp.standardVariants.length>0;});r.sort(function(a,b){return a.index-b.index;});return r;},getGroupedFlexObjects:function(F){var G={};Object.keys(c).forEach(function(l){G[l]=this.getEmptyFlexDataResponse();G[l].index=d.getLayerIndex(l);}.bind(this));F.forEach(function(o){var l=o.layer;if(o.fileType==="ctrl_variant"&&o.variantManagementReference){G[l].variants.push(o);}else if(o.fileType==="ctrl_variant_change"){G[l].variantChanges.push(o);}else if(o.fileType==="ctrl_variant_management_change"){G[l].variantManagementChanges.push(o);}else if(o.fileType==="variant"){G[l].comp.variants.push(o);}else if(o.fileType==="change"){if(o.variantReference){G[l].variantDependentControlChanges.push(o);}else{switch(o.changeType){case"addFavorite":case"removeFavorite":case"updateVariant":G[l].comp.changes.push(o);break;case"defaultVariant":G[l].comp.defaultVariants.push(o);break;case"standardVariant":G[l].comp.standardVariants.push(o);break;default:G[l].changes.push(o);}}}});Object.keys(G).forEach(function(l){s(G[l]);});return G;},getEmptyFlexDataResponse:function(){return Object.assign({},{appDescriptorChanges:[],changes:[],comp:{variants:[],changes:[],defaultVariants:[],standardVariants:[]},variants:[],variantChanges:[],variantDependentControlChanges:[],variantManagementChanges:[],ui2personalization:{}});},isStorageResponseFilled:function(r){return Object.keys(r||{}).some(function(k){if(Array.isArray(r[k])){return r[k].length!==0;}return!i(r[k]);});},addLanguageInfo:function(p){if(!p){p={};}p["sap-language"]=sap.ui.getCore().getConfiguration().getLanguage();}};});
sap.ui.predefine('sap/ui/fl/initial/_internal/connectors/StaticFileConnector',["sap/base/Log","sap/base/util/LoaderExtensions"],function(L,a){"use strict";
function _(r,b){var B=r.replace(/\./g,"/")+"/changes/"+b+".json";var c=!!sap.ui.loader._.getModuleState(B);var C=sap.ui.getCore().getConfiguration();if(c||C.getDebug()||C.getComponentPreload()==="off"){try{return a.loadResource(B);}catch(e){if(e.name.includes("SyntaxError")){L.error(e);}L.warning("flexibility did not find a "+b+".json for the application: "+r);}}}
return{loadFlexData:function(p){var c=p.componentName;if(!c){c=p.reference.replace(/.Component/g,"");}var f=_(c,"flexibility-bundle");if(f){f.changes=f.changes.concat(f.compVariants);delete f.compVariants;return Promise.resolve(f);}var C=_(c,"changes-bundle");if(C){return Promise.resolve({changes:C});}return Promise.resolve();}};});
sap.ui.predefine('sap/ui/fl/initial/_internal/storageResultDisassemble',["sap/ui/fl/initial/_internal/StorageUtils","sap/base/util/merge","sap/base/util/isEmptyObject"],function(S,m,i){"use strict";
function _(f,c){if(c.content.fileName!==c.content.variantManagementReference){f.push(c.content);}c.controlChanges.forEach(function(o){f.push(o);});for(var C in c.variantChanges){f=f.concat(c.variantChanges[C]);}return f;}
function a(c){var I=true;if(c){Object.keys(c).some(function(k){if(c[k].length){I=false;return true;}});}return I;}
return function(r){var f;if(!i(r.variantSection)){f=r.changes||[];for(var v in r.variantSection){var V=r.variantSection[v];for(var c in V.variantManagementChanges){f=f.concat(V.variantManagementChanges[c]);}f=V.variants.reduce(_,f);}var g=S.getGroupedFlexObjects(f);var d=S.filterAndSortResponses(g);delete r.changes;delete r.variantSection;m(d[0]||{},r);return d;}if(a(r.comp)){f=r.changes||[];r.comp={variants:[],changes:[],defaultVariants:[],standardVariants:[]};f.slice().reverse().forEach(function(F,n,A){var M=false;if(F.fileType==="variant"){r.comp.variants.unshift(F);M=true;}else{switch(F.changeType){case"addFavorite":case"removeFavorite":case"updateVariant":r.comp.changes.unshift(F);M=true;break;case"defaultVariant":r.comp.defaultVariants.unshift(F);M=true;break;case"standardVariant":r.comp.standardVariants.unshift(F);M=true;break;default:break;}}if(M){var b=A.length-1-n;r.changes.splice(b,1);}});}return[r];};});
sap.ui.predefine('sap/ui/fl/interfaces/BaseLoadConnector',[],function(){"use strict";var B={loadFlexData:function(){return Promise.reject("loadFlexData is not implemented");}};return B;});
sap.ui.predefine('sap/ui/fl/requireAsync',[],function(){"use strict";return function(m){return new Promise(function(r,R){sap.ui.require([m],function(M){r(M);},function(e){R(e);});});};});
sap.ui.predefine('sap/ui/fl/variants/VariantModel',["sap/base/util/restricted/_omit","sap/base/util/restricted/_isEqual","sap/base/util/each","sap/base/util/includes","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/BusyIndicator","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/fl/apply/_internal/flexState/controlVariants/Switcher","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/changeHandler/Base","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/fl/registry/Settings","sap/ui/model/json/JSONModel"],function(_,a,e,i,b,m,O,L,J,B,R,U,S,V,c,d,C,f,g,h,j,k){"use strict";var l={};
function n(E,P){return q(function(A,D){var M=D.model;var F=D.vmReference;var G=false;var T=A.key;var H=A.key;return Promise.resolve().then(function(){if(O.get([F,"currentVariant"],M.oData)&&M.oData[F].currentVariant!==M.oData[F].originalCurrentVariant){H=M.oData[F].originalCurrentVariant;G=true;return M.updateCurrentVariant({variantManagementReference:F,newVariantReference:T,appComponent:M.oAppComponent,internallyCalled:true});}}).then(function(){if(O.get([F,"modified"],M.oData)===true){var I=V.getControlChangesForVariant({reference:M.sFlexReference,vmReference:F,vReference:H,changeInstance:true});return o({changes:I,vmReference:F,vReference:H,revert:!G,model:M}).then(function(){M.oData[F].originalCurrentVariant=T;M.oData[F].modified=false;M.checkUpdate(true);});}}).then(function(){if(!G){M._callVariantSwitchListeners(F,M.oData[F].currentVariant);}});}.bind(null,E.getParameters(),P),P.model,P.vmReference);}
function o(P){var A=P.model._getDirtyChangesFromVariantChanges(P.changes);A=A.reverse();return Promise.resolve().then(function(){if(P.revert){return R.revertMultipleChanges(A,{appComponent:P.model.oAppComponent,modifier:J,flexController:P.model.oFlexController});}}).then(function(){A.forEach(function(D){V.removeChangeFromVariant({reference:P.model.sFlexReference,change:D,vmReference:P.vmReference,vReference:P.vReference});P.model.oFlexController.deleteChange(D,P.model.oAppComponent);});});}
function p(M,A,D){if(D||M.oData[A]){M.oData[A].variantBusy=D;}M.checkUpdate();}
function q(A,M,D){M._oVariantSwitchPromise=M._oVariantSwitchPromise.catch(function(){}).then(p.bind(null,M,D,true)).then(A).then(p.bind(null,M,D,false)).catch(function(E){p(M,D,false);throw E;});M.oFlexController.setVariantSwitchPromise(M._oVariantSwitchPromise);return M._oVariantSwitchPromise;}
function s(A,D){l[A]=D;}
function r(P){return S.switchVariant(P).then(function(){delete this.oData[P.vmReference];}.bind(this)).catch(function(E){L.warning(E.message);});}
function t(P,A){return S.switchVariant(P).then(function(){this.oData[P.vmReference].originalCurrentVariant=P.newVReference;this.oData[P.vmReference].currentVariant=P.newVReference;if(this.oData[P.vmReference].updateVariantInURL){U.updateVariantInURL({vmReference:P.vmReference,newVReference:P.newVReference,model:this});}this._callVariantSwitchListeners(P.vmReference,P.newVReference,undefined,A);this.checkUpdate();}.bind(this));}
function u(A){j.getInstance().then(function(D){if(!D.isVariantPersonalizationEnabled()){A.remove=false;A.rename=false;A.change=false;}});}
function v(A,D,E){var F=E?g.getCurrentLayer():f.USER;if((A.layer===F)&&(A.key!==D)){return true;}return false;}
function w(A){return new Promise(function(D){if(A.getDomRef()){D();}else{A.addEventDelegate({onAfterRendering:function(){D();}});}});}
var x=k.extend("sap.ui.fl.variants.VariantModel",{constructor:function(D,P){this.pSequentialImportCompleted=Promise.resolve();k.apply(this,[D]);this.sharing={PRIVATE:"private",PUBLIC:"public"};this.oFlexController=P.flexController;this.oChangePersistence=this.oFlexController._oChangePersistence;this.sFlexReference=this.oChangePersistence.getComponentName();this.oAppComponent=P.appComponent;this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");this._oVariantSwitchPromise=Promise.resolve();this._oVariantAppliedListeners={};if(b(D)){try{D=V.fillVariantModel({reference:this.sFlexReference});}catch(E){L.error("Variants Map was not found: "+E.message);}}if(D&&typeof D==="object"){Object.keys(D).forEach(function(K){D[K].variants.forEach(function(A){if(!D[K].currentVariant&&(A.key===D[K].defaultVariant)){D[K].currentVariant=A.key;}A.originalTitle=A.title;A.originalFavorite=A.favorite;A.originalExecuteOnSelect=A.executeOnSelect;A.originalVisible=A.visible;A.originalContexts=A.contexts;});D[K].originalCurrentVariant=D[K].currentVariant;D[K].originalDefaultVariant=D[K].defaultVariant;});this.setData(D);}}});
x.prototype.initialize=function(){return Promise.resolve().then(function(){var A=h.getUshellContainer();if(A){var D=[h.getUShellService("UserInfo"),h.getUShellService("URLParsing"),h.getUShellService("CrossApplicationNavigation"),h.getUShellService("ShellNavigation")];return Promise.all(D).then(function(E){s("UserInfo",E[0]);s("URLParsing",E[1]);s("CrossApplicationNavigation",E[2]);s("ShellNavigation",E[3]);}).catch(function(E){throw new Error("Error getting service from Unified Shell: "+E);});}return undefined;}).then(function(){U.initialize({model:this});}.bind(this));};
x.prototype.updateCurrentVariant=function(P){var A={vmReference:P.variantManagementReference,currentVReference:this.oData[P.variantManagementReference].originalCurrentVariant,newVReference:P.newVariantReference,flexController:this.oFlexController,appComponent:P.appComponent||this.oAppComponent,modifier:J,reference:this.sFlexReference};if(P.internallyCalled){return t.call(this,A,P.scenario);}return q(t.bind(this,A,P.scenario),this,P.variantManagementReference);};
x.prototype.getCurrentVariantReference=function(A){return this.oData[A].currentVariant;};
x.prototype.getVariantManagementReference=function(A){var D="";var I=-1;Object.keys(this.oData).some(function(K){return this.oData[K].variants.some(function(E,F){if(E.key===A){D=K;I=F;return true;}});}.bind(this));return{variantManagementReference:D,variantIndex:I};};
x.prototype.getVariant=function(A,D){return V.getVariant({reference:this.sFlexReference,vmReference:D||this.getVariantManagementReference(A).variantManagementReference,vReference:A});};
x.prototype.getVariantProperty=function(A,P){return this.getVariant(A).content.content[P];};
function y(A,D){var E=V.getVariantChangesForVariant({vmReference:A,reference:this.sFlexReference});var F=this.oData[A].currentVariant;var G=this.oData[A].defaultVariant;if(D.getExecuteOnSelectionForStandardDefault()&&F===G&&F===A&&!E.setExecuteOnSelect){var H=V.getVariant({reference:this.sFlexReference,vmReference:A,vReference:A});H.content.content.executeOnSelect=true;this.oData[A].variants[0].originalExecuteOnSelect=true;this.oData[A].variants[0].executeOnSelect=true;return true;}return false;}
x.prototype.attachVariantApplied=function(P){var A=sap.ui.getCore().byId(P.vmControlId);var D=this.getVariantManagementReferenceForControl(A);return this.waitForVMControlInit(D).then(function(D,P){if(!this._oVariantAppliedListeners[D]){this._oVariantAppliedListeners[D]={};}var I=y.call(this,D,A);if(P.callAfterInitialVariant||I){var E={appComponent:this.oAppComponent,reference:this.sFlexReference,vmReference:D,flexController:this.oFlexController};V.waitForInitialVariantChanges(E).then(function(){var F=V.getCurrentVariantReference({vmReference:D,reference:this.sFlexReference});this._callVariantSwitchListeners(D,F,P.callback);}.bind(this));}return w(P.control).then(function(){if(c.getRelevantVariantManagementControlId(P.control,this.getVariantManagementControlIds())===P.vmControlId){this.oData[D].showExecuteOnSelection=true;this.checkUpdate(true);this._oVariantAppliedListeners[D][P.control.getId()]=P.callback;}else{L.error("Error in attachVariantApplied: The passed VariantManagement ID does not match the responsible VariantManagement control");}}.bind(this));}.bind(this,D,P));};
x.prototype._callVariantSwitchListeners=function(A,N,D,E){if(this._oVariantAppliedListeners[A]){var F;this.oData[A].variants.some(function(G){if(G.key===N){F=m({},G);return true;}});if(E){F.createScenario=E;}if(D){D(F);}else{e(this._oVariantAppliedListeners[A],function(G,D){D(F);});}}};
x.prototype.detachVariantApplied=function(A,D){var E=this.getVariantManagementReferenceForControl(sap.ui.getCore().byId(A));if(this._oVariantAppliedListeners[E]){delete this._oVariantAppliedListeners[E][D];}};
x.prototype.addChange=function(A){var D=A.getVariantReference();var E=this.getVariantManagementReference(D).variantManagementReference;if(A.getState()===C.states.NEW){this.oData[E].modified=true;}this.checkUpdate(true);return V.addChangeToVariant({reference:this.sFlexReference,change:A,vmReference:E,vReference:D});};
x.prototype.removeChange=function(A){var D=A.getVariantReference();var E=this.getVariantManagementReference(D).variantManagementReference;var F=V.removeChangeFromVariant({reference:this.sFlexReference,change:A,vmReference:E,vReference:D});this.checkDirtyStateForControlModels([E]);return F;};
x.prototype._getVariantTitleCount=function(N,A){var D=this.getData();return D[A].variants.reduce(function(E,F){if(N.toLowerCase()===F.title.toLowerCase()&&F.visible){E++;}return E;},0);};
x.prototype._duplicateVariant=function(P){var N=P.newVariantReference;var A=P.sourceVariantReference;var D=P.variantManagementReference;var E=this.getVariant(A);var F=V.getControlChangesForVariant({vmReference:D,vReference:A,changeInstance:true,reference:this.sFlexReference}).map(function(M){return M.getDefinition();});var G={content:{},controlChanges:F,variantChanges:{}};var H=g.compareAgainstCurrentLayer(E.content.layer,P.layer);Object.keys(E.content).forEach(function(M){if(M==="fileName"){G.content[M]=N;}else if(M==="variantReference"){if(H===1){var Q=this.getVariant(E.content.variantReference);if(Q.content.layer===P.layer){G.content[M]=Q.content.variantReference;}else{G.content[M]=E.content.variantReference;}}else if(H===0){G.content[M]=E.content.variantReference;}else if(H===-1){G.content[M]=A;}}else if(M==="content"){G.content[M]=JSON.parse(JSON.stringify(E.content[M]));G.content.content.title=P.title;}else{G.content[M]=E.content[M];}}.bind(this));G.content.layer=P.layer;G.content.contexts=P.contexts;F=G.controlChanges.slice();var I={};var K;G.controlChanges=F.reduce(function(M,Q){if(g.compareAgainstCurrentLayer(Q.layer,P.layer)>=0){I=m({},Q);I.layer=P.layer;I.variantReference=G.content.fileName;if(!I.support){I.support={};}I.support.sourceChangeFileName=Q.fileName;I.packageName="$TMP";K=C.createInitialFileContent(I);M.push(new C(K));}return M;},[]);return G;};
x.prototype.copyVariant=function(P){var D=this._duplicateVariant(P);D.generator=P.generator;var A={key:D.content.fileName,layer:P.layer,title:D.content.content.title,originalTitle:D.content.content.title,originalExecuteOnSelect:D.content.content.executeOnSelect,executeOnSelect:false,favorite:true,originalFavorite:true,rename:true,change:true,remove:true,visible:true,originalVisible:true,sharing:P.layer===f.USER?this.sharing.PRIVATE:this.sharing.PUBLIC,contexts:D.content.contexts,originalContexts:D.originalContexts};var E=c.createVariant({model:this,variantSpecificData:D});var F=[];[E].concat(E.getControlChanges()).forEach(function(G){F.push(this.oChangePersistence.addDirtyChange(G));}.bind(this));var I=V.addVariantToVariantManagement({variantData:m({},E.getDefinitionWithChanges(),{content:{content:{visible:A.visible,favorite:A.favorite}}}),reference:this.sFlexReference,vmReference:P.variantManagementReference});this.oData[P.variantManagementReference].variants.splice(I,0,A);return this.updateCurrentVariant({variantManagementReference:P.variantManagementReference,newVariantReference:E.getId(),appComponent:P.appComponent,internallyCalled:true,scenario:"saveAs"}).then(function(){return F;});};
x.prototype.removeVariant=function(P){var A=this.oChangePersistence.getDirtyChanges().filter(function(D){return(D.getVariantReference&&D.getVariantReference()===P.variant.getId())||D.getId()===P.variant.getId();});return this.updateCurrentVariant({variantManagementReference:P.variantManagementReference,newVariantReference:P.sourceVariantReference,appComponent:P.component}).then(function(){var I=V.removeVariantFromVariantManagement({reference:this.sFlexReference,variant:P.variant,vmReference:P.variantManagementReference});this.oData[P.variantManagementReference].variants.splice(I,1);this.checkUpdate();A.forEach(function(D){this.oChangePersistence.deleteChange(D);}.bind(this));}.bind(this));};
x.prototype.collectModelChanges=function(A,D){var E=this.getData()[A];var M=E.variants;var F=[];var P={};M.forEach(function(G){if(G.originalTitle!==G.title){P={variantReference:G.key,changeType:"setTitle",title:G.title,originalTitle:G.originalTitle,layer:D};F.push(P);}if(G.originalFavorite!==G.favorite){P={variantReference:G.key,changeType:"setFavorite",favorite:G.favorite,originalFavorite:G.originalFavorite,layer:D};F.push(P);}if(G.originalExecuteOnSelect!==G.executeOnSelect){P={variantReference:G.key,changeType:"setExecuteOnSelect",executeOnSelect:G.executeOnSelect,originalExecuteOnSelect:G.originalExecuteOnSelect,layer:D};F.push(P);}if(!G.visible&&G.originalVisible){P={variantReference:G.key,changeType:"setVisible",visible:false,layer:D};F.push(P);}if(!a(G.originalContexts,G.contexts)){P={variantReference:G.key,changeType:"setContexts",layer:D,contexts:G.contexts,originalContexts:G.originalContexts};F.push(P);}});if(E.originalDefaultVariant!==E.defaultVariant){P={variantManagementReference:A,changeType:"setDefault",defaultVariant:E.defaultVariant,originalDefaultVariant:E.originalDefaultVariant,layer:D};F.push(P);}return F;};
x.prototype.manageVariants=function(A,D,E,F,G){return new Promise(function(H){A.attachEventOnce("manage",{resolve:H,variantManagementReference:D,layer:E},this.fnManageClickRta,this);A.openManagementDialog(true,F,G);}.bind(this));};
x.prototype.addVariantChange=function(A,P){var D=this.setVariantProperties(A,P);var N={};var E={vmReference:A,add:true,reference:this.sFlexReference};N.changeType=P.changeType;N.layer=P.layer;N.generator=P.generator;if(P.changeType==="setDefault"){N.fileType="ctrl_variant_management_change";N.selector=J.getSelector(A,P.appComponent);}else{if(P.changeType==="setTitle"){d.setTextInChange(N,"title",P.title,"XFLD");}N.fileType="ctrl_variant_change";N.selector=J.getSelector(P.variantReference,P.appComponent);}var F=this.oFlexController.createBaseChange(N,P.appComponent);F.setContent(D);E.changeContent=F.getDefinition();V.updateChangesForVariantManagementInMap(E);this.oChangePersistence.addDirtyChange(F);return F;};
x.prototype.deleteVariantChange=function(A,P,D){var E={vmReference:A,add:false,reference:this.sFlexReference,changeContent:undefined};this.setVariantProperties(A,P,true);E.changeContent=D.getDefinition();V.updateChangesForVariantManagementInMap(E);this.oChangePersistence.deleteChange(D);};
x.prototype.setVariantProperties=function(A,P,D){var E=-1;var F;var G=this.getData();if(P.variantReference){E=this.getVariantManagementReference(P.variantReference).variantIndex;F=G[A].variants[E];}var H={};switch(P.changeType){case"setTitle":H.title=P.title;F.title=P.title;F.originalTitle=F.title;break;case"setFavorite":H.favorite=P.favorite;F.favorite=P.favorite;F.originalFavorite=F.favorite;break;case"setExecuteOnSelect":H.executeOnSelect=P.executeOnSelect;if(F){F.executeOnSelect=P.executeOnSelect;F.originalExecuteOnSelect=F.executeOnSelect;}break;case"setVisible":H.visible=P.visible;H.createdByReset=false;F.visible=P.visible;F.originalVisible=F.visible;break;case"setContexts":H.contexts=P.contexts;F.contexts=P.contexts;F.originalContexts=P.contexts;break;case"setDefault":H.defaultVariant=P.defaultVariant;G[A].defaultVariant=P.defaultVariant;G[A].originalDefaultVariant=G[A].defaultVariant;var I=U.getStoredHashParams({model:this});if(I){if(G[A].defaultVariant!==G[A].currentVariant&&I.indexOf(G[A].currentVariant)===-1){U.update({parameters:I.concat(G[A].currentVariant),updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this});}else if(G[A].defaultVariant===G[A].currentVariant&&I.indexOf(G[A].currentVariant)>-1){I.splice(I.indexOf(G[A].currentVariant),1);U.update({parameters:I,updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this});}}if(D&&G[A].currentVariant!==P.defaultVariant){this.updateCurrentVariant({variantManagementReference:A,newVariantReference:P.defaultVariant,appComponent:P.appComponent});}break;default:break;}var K=V.getContent(this.sFlexReference);if(E>-1){var M=V.setVariantData({variantData:H,vmReference:A,previousIndex:E,reference:this.sFlexReference});G[A].variants.splice(E,1);G[A].variants.splice(M,0,F);}else if(K[A]){K[A].defaultVariant=P.defaultVariant;}this.setData(G);this.checkUpdate(true);return H;};
x.prototype._ensureStandardVariantExists=function(A){var D=this.getData();var E=D[A]||{};var F=_(E,["initPromise"]);if(!D[A]||b(F)){D[A]=m(E,{currentVariant:A,originalCurrentVariant:A,defaultVariant:A,originalDefaultVariant:A,variants:[{key:A,title:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE"),originalTitle:this._oResourceBundle.getText("STANDARD_VARIANT_ORIGINAL_TITLE"),favorite:true,originalFavorite:true,executeOnSelect:false,originalExecuteOnSelect:false,visible:true,originalVisible:true,contexts:{},originalContexts:{},author:c.DEFAULT_AUTHOR}]});this.setData(D);var G={};G[A]={defaultVariant:A,variantManagementChanges:{},variants:[{content:{fileName:A,fileType:"ctrl_variant",variantManagementReference:A,variantReference:"",support:{user:c.DEFAULT_AUTHOR},content:{title:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE"),favorite:true,visible:true,executeOnSelect:false},contexts:{}},controlChanges:[],variantChanges:{}}]};try{V.addFakeStandardVariant(this.sFlexReference,this.oAppComponent.getId(),G);}catch(H){L.error("Variants Map was not found: "+H.message);}}};
x.prototype.setModelPropertiesForControl=function(A,D,E){this.oData[A].modified=false;this.oData[A].showFavorites=true;var F=this._bDesignTimeMode;if(F!==D){this._bDesignTimeMode=D;if(D){U.clearAllVariantURLParameters({model:this});}else if(F){U.update({parameters:U.getStoredHashParams({model:this}),updateURL:true,updateHashEntry:false,model:this});}}if(!(typeof this.fnManageClick==="function"&&typeof this.fnManageClickRta==="function")){this._initializeManageVariantsEvents();}E.detachManage(this.fnManageClick,this);if(D&&this.oData[A]._isEditable){this.oData[A].variantsEditable=false;this.oData[A].variants.forEach(function(G){G.rename=true;G.change=true;G.sharing=this.sharing.PUBLIC;G.remove=v(G,A,D);}.bind(this));}else if(this.oData[A]._isEditable){E.attachManage({variantManagementReference:A},this.fnManageClick,this);this.oData[A].variantsEditable=true;this.oData[A].variants.forEach(function(G){G.remove=v(G,A,D);switch(G.layer){case f.USER:G.rename=true;G.change=true;G.sharing=this.sharing.PRIVATE;u(G);break;case f.PUBLIC:var H=this._oUserInfoService&&this._oUserInfoService.getUser();var I=!H||H.getId().toUpperCase()===G.author.toUpperCase()||j.getInstanceOrUndef().isKeyUser();G.remove=I;G.rename=I;G.change=I;G.sharing=this.sharing.PUBLIC;break;default:G.rename=false;G.change=false;G.sharing=this.sharing.PUBLIC;}}.bind(this));}else{this.oData[A].variantsEditable=false;this.oData[A].variants.forEach(function(G){G.remove=false;G.rename=false;G.change=false;});}};
x.prototype._initializeManageVariantsEvents=function(){this.fnManageClickRta=function(E,D){var A=this.collectModelChanges(D.variantManagementReference,D.layer);D.resolve(A);};this.fnManageClick=function(E,D){if(!this.oFlexController||!V.getContent(this.sFlexReference)){return;}var A=this.collectModelChanges(D.variantManagementReference,f.USER);var F=[];A.forEach(function(G){G.appComponent=this.oAppComponent;F.push(this.addVariantChange(D.variantManagementReference,G));}.bind(this));this.oChangePersistence.saveDirtyChanges(this.oAppComponent,false,F);};};
function z(F,A,D,E){if(!this._bDesignTimeMode){return F.saveSequenceOfDirtyChanges(A,E).then(function(G){if(G){var H=G.response[0];this.oData[D].variants.forEach(function(I){if(I.key===H.fileName){I.author=H.support.user;}});}}.bind(this));}return Promise.resolve();}
x.prototype._handleSaveEvent=function(E){if(!this._bDesignTimeMode){var A=E.getSource();var P=E.getParameters();return this._handleSave(A,P);}return Promise.resolve();};
x.prototype._handleSave=function(A,P){var D=h.getAppComponentForControl(A);var E=this.getLocalId(A.getId(),D);var N;return q(function(F,D,P){var G=P.def;var H=P.execute;var I=this.getCurrentVariantReference(F);var K=V.getControlChangesForVariant({reference:this.sFlexReference,vmReference:F,vReference:I,changeInstance:true});if(P.overwrite){return this.oFlexController.saveSequenceOfDirtyChanges(this._getDirtyChangesFromVariantChanges(K),D);}var M=P.layer||(P.public?f.PUBLIC:f.USER);var Q=P.layer||f.USER;var T=P.newVariantReference||h.createDefaultFileName();var W={variantManagementReference:F,appComponent:D,layer:M,title:P.name,contexts:P.contexts,sourceVariantReference:I,newVariantReference:T,generator:P.generator};return this.copyVariant(W).then(function(X){if(G){var Y={changeType:"setDefault",defaultVariant:T,originalDefaultVariant:this.oData[F].defaultVariant,appComponent:D,layer:Q,variantManagementReference:F};var Z=this.addVariantChange(F,Y);X.push(Z);}if(H){var $={changeType:"setExecuteOnSelect",executeOnSelect:true,variantReference:T,appComponent:D,layer:Q,variantManagementReference:F};var a1=this.addVariantChange(F,$);X.push(a1);}N=X;return o({changes:K,vmReference:F,vReference:I,model:this}).then(z.bind(this,this.oFlexController,X,F,D));}.bind(this));}.bind(this,E,D,P),this,E).then(function(){this.oData[E].modified=false;this.checkUpdate(true);return N;}.bind(this));};
x.prototype.getLocalId=function(I,A){return J.getSelector(I,A).id;};
x.prototype.getVariantManagementReferenceForControl=function(A){var D=A.getId();var E=h.getAppComponentForControl(A);return(E&&E.getLocalId(D))||D;};
x.prototype.switchToDefaultForVariantManagement=function(A){if(this.oData[A].currentVariant!==this.oData[A].defaultVariant){B.show(200);this.updateCurrentVariant({variantManagementReference:A,newVariantReference:this.oData[A].defaultVariant}).then(function(){B.hide();});}};
x.prototype.switchToDefaultForVariant=function(A){Object.keys(this.oData).forEach(function(D){if(!A||this.oData[D].currentVariant===A){this.switchToDefaultForVariantManagement(D);}}.bind(this));};
x.prototype.registerToModel=function(A){var D=this.getVariantManagementReferenceForControl(A);this._ensureStandardVariantExists(D);this.oData[D]._isEditable=A.getEditable();this.oData[D].showExecuteOnSelection=false;A.attachEvent("select",{vmReference:D,model:this},n);A.attachSave(this._handleSaveEvent,this);this.setModelPropertiesForControl(D,false,A);var E=A.getUpdateVariantInURL();this.oData[D].updateVariantInURL=E;U.registerControl({vmReference:D,updateURL:!!E,model:this});U.handleModelContextChange({model:this,vmControl:A});if(this.oData[D].initPromise){this.oData[D].initPromise.resolveFunction();delete this.oData[D].initPromise;}this.oData[D].init=true;};
x.prototype.waitForVMControlInit=function(A){if(!this.oData[A]){this.oData[A]={};}else if(this.oData[A].init){return Promise.resolve();}this.oData[A].initPromise={};this.oData[A].initPromise.promise=new Promise(function(D){this.oData[A].initPromise.resolveFunction=D;}.bind(this));return this.oData[A].initPromise.promise;};
x.prototype._getDirtyChangesFromVariantChanges=function(A){var D=A.map(function(E){return E.getDefinition().fileName;});return this.oChangePersistence.getDirtyChanges().filter(function(E){return i(D,E.getId())&&!E.assignedToVariant;});};
x.prototype.checkDirtyStateForControlModels=function(A){A.forEach(function(D){var E=this.oData[D];var F=this.getCurrentVariantReference(D);var G=V.getControlChangesForVariant({reference:this.sFlexReference,vmReference:D,vReference:F,changeInstance:true});var H=this._getDirtyChangesFromVariantChanges(G);E.modified=H.length>0;}.bind(this));this.checkUpdate(true);};
x.prototype.getCurrentControlVariantIds=function(){return Object.keys(this.oData||{}).reduce(function(A,D){return A.concat([this.oData[D].currentVariant]);}.bind(this),[]);};
x.prototype.getVariantManagementControlIds=function(){var A;return Object.keys(this.oData||{}).reduce(function(D,E){if(this.oAppComponent.byId(E)){A=this.oAppComponent.createId(E);}else{A=E;}D.push(A);return D;}.bind(this),[]);};
x.prototype.resetMap=function(A){var D=Object.keys(this.oData);D.forEach(function(E){var P={vmReference:E,currentVReference:this.oData[E].currentVariant||this.oData[E].defaultVariant,newVReference:true,appComponent:this.oAppComponent,flexController:this.oFlexController,modifier:J,reference:this.sFlexReference};return q(r.bind(this,P),this,E);}.bind(this));return this._oVariantSwitchPromise.then(function(){V.clearFakedStandardVariants(this.sFlexReference,this.oAppComponent.getId());V.resetContent(this.sFlexReference,this.oAppComponent.getId());if(!A){U.initialize({model:this});U.update({parameters:[],updateHashEntry:true,model:this});}}.bind(this));};
x.prototype.getUShellService=function(A){return h.getUshellContainer()&&l[A];};
return x;});
sap.ui.predefine('sap/ui/fl/write/_internal/Storage',["sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/write/_internal/StorageFeaturesMerger","sap/ui/fl/apply/_internal/flexObjects/States","sap/base/util/ObjectPath"],function(S,a,b,O){"use strict";var W="sap/ui/fl/write/_internal/connectors/";
function _(){return S.getConnectors(W,false);}
function f(l,C){var F=C.filter(function(o){return o.layers.indexOf("ALL")!==-1||o.layers.indexOf(l)!==-1;});if(F.length===1){return F[0];}if(F.length===0){throw new Error("No Connector configuration could be found to write into layer: "+l);}if(F.length>1){throw new Error("sap.ui.core.Configuration 'flexibilityServices' has a misconfiguration: Multiple Connector configurations were found to write into layer: "+l);}}
function c(C){var j=C.map(function(o){return o.writeConnectorModule.loadFeatures({url:o.url}).then(function(F){return{features:F,layers:o.layers};}).catch(S.logAndResolveDefault.bind(null,{features:{},layers:o.layers},o,"loadFeatures"));});return Promise.all(j);}
function d(l){if(!l){return Promise.reject("No layer was provided");}return _().then(f.bind(this,l));}
function e(p){if(p.draft){return new Promise(function(r,j){sap.ui.require(["sap/ui/fl/write/api/FeaturesAPI"],function(F){F.isVersioningEnabled(p.layer).then(function(D){if(D){r();}else{j("Draft is not supported for the given layer: "+p.layer);}});});});}return Promise.resolve();}
function g(p){var C;if(p.allChanges&&p.allChanges.length&&p.condensedChanges){C={namespace:p.allChanges[0].getDefinition().namespace,layer:p.layer,"delete":{change:[]},update:{change:[]},reorder:{change:[]},create:{change:[],ctrl_variant_change:[],ctrl_variant_management_change:[]}};var o=0;var A=false;p.allChanges.forEach(function(j,k){if(j.getFileType()==="ctrl_variant"){return;}var l=C.create[j.getFileType()].length;if(j.condenserState){var D=false;if(j.condenserState==="delete"){if(j.getState()===b.PERSISTED){C.delete.change.push(j.getFileName());}o++;}else if(p.condensedChanges.length){D=p.allChanges[k].getFileName()!==p.condensedChanges[k-o].getFileName();}if((j.condenserState==="select"||j.condenserState==="update")&&D&&!A){var r=p.condensedChanges.slice(k-o).map(function(j){return j.getFileName();});C.reorder.change=r;A=true;}if(j.condenserState==="select"&&j.getState()===b.NEW){C.create.change[l]={};C.create.change[l][j.getFileName()]=j.getDefinition();}else if(j.condenserState==="update"){var m=C.update.change.length;C.update.change[m]={};C.update.change[m][j.getFileName()]={content:j.getContent()};}delete j.condenserState;}else if(j.getState()===b.NEW){C.create[j.getFileType()][l]={};C.create[j.getFileType()][l][j.getId()]=j.getDefinition();}});}return C;}
function h(A,p){return e(p).then(d.bind(undefined,p.layer)).then(function(C){p.url=C.url;var o=O.get(A,C.writeConnectorModule);return o.call(C.writeConnectorModule,p);});}
var i={};
i.write=function(p){return h("write",p);};
i.condense=function(p){p.flexObjects=g(p);if(!p.flexObjects){return Promise.reject("No changes were provided");}return h("condense",p);};
i.remove=function(p){return h("remove",p);};
i.update=function(p){return h("update",p);};
i.reset=function(p){return h("reset",p);};
i.getFlexInfo=function(p){return h("getFlexInfo",p);};
i.getContexts=function(p){return h("getContexts",p);};
i.loadContextDescriptions=function(p){return h("loadContextDescriptions",p);};
i.isContextSharingEnabled=function(p){return h("isContextSharingEnabled",p);};
i.loadFeatures=function(){return _().then(c).then(a.mergeResults);};
i.publish=function(p){return h("publish",p);};
i.versions={load:function(p){return _().then(h.bind(undefined,"versions.load",p));},activate:function(p){return _().then(h.bind(undefined,"versions.activate",p));},discardDraft:function(p){return _().then(h.bind(undefined,"versions.discardDraft",p));}};return i;});
sap.ui.predefine('sap/ui/fl/write/_internal/StorageFeaturesMerger',["sap/base/util/merge"],function(m){"use strict";var D={isKeyUser:false,isKeyUserTranslationEnabled:false,isVariantSharingEnabled:false,isPublicFlVariantEnabled:false,isVariantPersonalizationEnabled:true,isAtoAvailable:false,isAtoEnabled:false,versioning:{},isProductiveSystem:true,isPublicLayerAvailable:false,isZeroDowntimeUpgradeRunning:false,system:"",client:""};
function _(r){var v={};var V=!!r.features.isVersioningEnabled;r.layers.forEach(function(l){v[l]=V;});return v;}
return{mergeResults:function(r){var R=D;r.forEach(function(o){Object.keys(o.features).forEach(function(k){if(k!=="isVersioningEnabled"){R[k]=o.features[k];}});R.versioning=m(R.versioning,_(o));});return R;}};});
sap.ui.predefine('sap/ui/fl/write/_internal/Versions',["sap/ui/fl/registry/Settings","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/write/_internal/Storage","sap/ui/model/json/JSONModel","sap/ui/fl/Utils","sap/ui/model/BindingMode"],function(S,C,a,J,U,B){"use strict";var _={};var M=9;var b=M+1;
function c(p,v,g){var h=f(g);var n=sap.ui.fl.Versions.Original;g.forEach(function(o){if(o.version===sap.ui.fl.Versions.Draft){o.type="draft";}else if(n===sap.ui.fl.Versions.Original){o.type="active";n=o.version;}else{o.type="inactive";}});return U.getUShellService("URLParsing").then(function(u){var P=U.getParameter(sap.ui.fl.Versions.UrlParameter,u);var i;if(P){i=parseInt(P);}else if(g.length>0){i=g[0].version;}else{i=sap.ui.fl.Versions.Original;}var m=new J({versioningEnabled:v,versions:g,activeVersion:n,backendDraft:h,dirtyChanges:false,draftAvailable:h,activateEnabled:h,persistedVersion:i,displayedVersion:i});m.setDefaultBindingMode(B.OneWay);m.setSizeLimit(M);m.setDirtyChanges=function(D){m.setProperty("/dirtyChanges",D);m.updateDraftVersion();m.updateBindings(true);};m.updateDraftVersion=function(){var g=m.getProperty("/versions");var v=m.getProperty("/versioningEnabled");var D=m.getProperty("/dirtyChanges");var h=m.getProperty("/backendDraft");var j=v&&(D||h);m.setProperty("/draftAvailable",j);var k=D?sap.ui.fl.Versions.Draft:m.getProperty("/persistedVersion");m.setProperty("/displayedVersion",k);if(!f(g)&&j){g.splice(0,0,{version:sap.ui.fl.Versions.Draft,type:"draft"});}if(f(g)&&!j){g.shift();m.setProperty("/displayedVersion",m.getProperty("/persistedVersion"));}var A=m.getProperty("/displayedVersion")!==m.getProperty("/activeVersion");m.setProperty("/activateEnabled",A);};return m;});}
function d(p,D){var g=[];var h=D.changePersistences;h.forEach(function(o){g=o.getDirtyChanges().concat();g.forEach(function(i){o.deleteChange(i,true);});});return g.length>0;}
function e(p){var D={dirtyChangesExist:false,changePersistences:[]};if(p.reference){var o=C.getChangePersistenceForComponent(p.reference);if(o.getDirtyChanges().length>0){D.dirtyChangesExist=true;D.changePersistences.push(o);}}if(p.nonNormalizedReference){var g=C.getChangePersistenceForComponent(p.nonNormalizedReference);if(g.getDirtyChanges().length>0){D.dirtyChangesExist=true;D.changePersistences.push(g);}}return D;}
function f(v){return v.some(function(o){return o.version===sap.ui.fl.Versions.Draft;});}
var V={};
V.initialize=function(p){var r=p.reference;var l=p.layer;p.limit=b;return S.getInstance().then(function(s){var v=s.isVersioningEnabled(l);var g=v?a.versions.load(p):Promise.resolve([]);return g.then(function(h){return c(p,v,h);}).then(function(m){_[r]=_[r]||{};_[r][l]=_[r][l]||{};_[r][l]=m;return _[r][l];});});};
V.getVersionsModel=function(p){var r=p.reference;var l=p.layer;if(!_[r]||!_[r][l]){throw Error("Versions Model for reference '"+r+"' and layer '"+l+"' were not initialized.");}var D=e(p);if(D.dirtyChangesExist){_[r][l].updateDraftVersion(p);}return _[r][l];};
V.clearInstances=function(){_={};};
V.onAllChangesSaved=function(p){p.reference=U.normalizeReference(p.reference);var m=V.getVersionsModel(p);var v=m.getProperty("/versioningEnabled");var D=m.getProperty("/dirtyChanges");m.setProperty("/dirtyChanges",true);m.setProperty("/backendDraft",v&&D);m.updateDraftVersion();};
V.activate=function(p){var m=V.getVersionsModel(p);var v=m.getProperty("/versions");var D=f(v);var s=m.getProperty("/displayedVersion");var A=m.getProperty("/activeVersion");var n=m.getProperty("/persistedVersion");if(s===A){return Promise.reject("Version is already active");}p.version=s;var g=[];if(m.getProperty("/dirtyChanges")){var o=e(p);var h=o.changePersistences;g=h.map(function(i){return i.saveDirtyChanges(p.appComponent,false,undefined,n);});}return Promise.all(g).then(a.versions.activate.bind(undefined,p)).then(function(i){v.forEach(function(j){j.type="inactive";});i.type="active";if(D){v.shift();}v.splice(0,0,i);m.setProperty("/backendDraft",false);m.setProperty("/dirtyChanges",false);m.setProperty("/draftAvailable",false);m.setProperty("/activateEnabled",false);m.setProperty("/activeVersion",i.version);m.setProperty("/displayedVersion",i.version);m.setProperty("/persistedVersion",i.version);m.updateBindings(true);});};
V.discardDraft=function(p){var m=V.getVersionsModel(p);var v=m.getProperty("/versions");var D=e(p);var g=m.getProperty("/backendDraft");var o=g?a.versions.discardDraft(p):Promise.resolve();return o.then(function(){v.shift();m.setProperty("/backendDraft",false);m.setProperty("/dirtyChanges",false);m.setProperty("/draftAvailable",false);m.setProperty("/activateEnabled",false);m.setProperty("/displayedVersion",m.getProperty("/persistedVersion"));m.updateBindings(true);var h=d(p,D);return{backendChangesDiscarded:g,dirtyChangesDiscarded:h};});};
return V;});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine('sap/ui/fl/Cache',["sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/Utils","sap/base/Log"],function(F,U,L){"use strict";var C=function(){};
function _(c,o){var s=F.getFlexObjectsFromStorageResponse(c);if(o.fileType==="variant"){return s.comp.variants;}if(o.selector.persistencyKey){return s.comp.changes;}return s.changes;}
function a(c,s){if(!s){return c;}return c===C.NOTAG?c.replace(/>$/,''.concat('-',s,'>')):c.concat('-',s);}
function b(c){return c.replace(/(^W\/|")/g,'');}
C.NOTAG="<NoTag>";
C.clearEntries=function(){F.clearState();};
C.getChangesFillingCache=function(c,p,i){var P=Promise.resolve();if(i){P=F.clearAndInitialize(p);}return P.then(function(){return F.getStorageResponse(c.name);}).catch(function(){return{};});};
C.getCacheKey=function(c,A){if(!c||!c.name||!A){L.warning("Not all parameters were passed to determine a flexibility cache key.");return Promise.resolve(C.NOTAG);}return this.getChangesFillingCache(c).then(function(w){if(w&&w.cacheKey){return b(w.cacheKey);}return C.NOTAG;}).then(function(s){var v=A.getModel(U.VARIANT_MODEL_NAME);var d=v?v.getCurrentControlVariantIds():[];return a(s,d.join("-"));});};
C.addChange=function(c,o){var d=_(c.name,o);if(!d){return;}d.push(o);};
C.updateChange=function(c,o){var d=_(c.name,o);if(!d){return;}for(var i=0;i<d.length;i++){if(d[i].fileName===o.fileName){d.splice(i,1,o);break;}}};
C.deleteChange=function(c,o){var d=_(c.name,o);if(!d){return;}for(var i=0;i<d.length;i++){if(d[i].fileName===o.fileName){d.splice(i,1);break;}}};
C.removeChanges=function(c,d){var e=F.getFlexObjectsFromStorageResponse(c.name);e.changes=e.changes.filter(function(o){return d.indexOf(o.fileName)===-1;});var v=F.getVariantsState(c.name);Object.keys(v).forEach(function(i){v[i].variants.forEach(function(V){V.controlChanges=V.controlChanges.filter(function(o){return d.indexOf(o.getFileName())===-1;});});});};
return C;},true);
sap.ui.predefine('sap/ui/fl/Change',["sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/registry/Settings","sap/base/Log","sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes","sap/ui/fl/apply/_internal/flexObjects/States","sap/base/util/includes"],function(q,M,L,U,a,S,b,D,c,i){"use strict";
var C=M.extend("sap.ui.fl.Change",{
constructor:function(f){M.apply(this);if(!q.isPlainObject(f)){b.error("Constructor : sap.ui.fl.Change : oFile is not defined");}this._oDefinition=f;this._sRequest='';this._bUserDependent=(f.layer===L.USER);this._vRevertData=null;this._aUndoOperations=null;this._oExtensionPointInfo=null;this.setState(C.states.NEW);this._sPreviousState=null;this._oChangeProcessedPromise=null;this.setInitialApplyState();this._oChangeProcessingPromises={};},
metadata:{properties:{state:{type:"string"},applyState:{type:"int"}}}
});
C.states={NEW:c.NEW,PERSISTED:c.PERSISTED,DELETED:c.DELETED,DIRTY:c.DIRTY};C.applyState={INITIAL:0,APPLYING:1,APPLY_FINISHED:2,REVERTING:3,REVERT_FINISHED:4};C.operations={APPLY:0,REVERT:1};
C.prototype.setState=function(s){var d=this.getState();if(d!==s&&this._isValidState(s)){this._sPreviousState=d;this.setProperty("state",s);}return this;};
C.prototype.setQueuedForRevert=function(){if(this._aQueuedProcesses[this._aQueuedProcesses.length-1]!==C.operations.REVERT){this._aQueuedProcesses.unshift(C.operations.REVERT);}};
C.prototype.isQueuedForRevert=function(){return this._aQueuedProcesses.indexOf(C.operations.REVERT)>-1;};
C.prototype.setQueuedForApply=function(){if(this._aQueuedProcesses[this._aQueuedProcesses.length-1]!==C.operations.APPLY){this._aQueuedProcesses.unshift(C.operations.APPLY);}};
C.prototype.isQueuedForApply=function(){return this._aQueuedProcesses.indexOf(C.operations.APPLY)>-1;};
C.prototype.setInitialApplyState=function(){this._aQueuedProcesses=[];delete this._ignoreOnce;this.setApplyState(C.applyState.INITIAL);this._oChangeProcessedPromise={};this._oChangeProcessedPromise.promise=new Promise(function(r){this._oChangeProcessedPromise.resolveFunction={resolve:r};}.bind(this));};
C.prototype.isInInitialState=function(){return(this._aQueuedProcesses.length===0)&&(this.getApplyState()===C.applyState.INITIAL);};
C.prototype.isValidForDependencyMap=function(){return this._oDefinition.selector&&this._oDefinition.selector.id;};
C.prototype.startApplying=function(){this.setApplyState(C.applyState.APPLYING);};
C.prototype.markFinished=function(r){this._aQueuedProcesses.pop();this._resolveChangeProcessingPromiseWithError(C.operations.APPLY,r);this.setApplyState(C.applyState.APPLY_FINISHED);};
C.prototype.startReverting=function(){this.setApplyState(C.applyState.REVERTING);};
C.prototype.markRevertFinished=function(r){this._aQueuedProcesses.pop();this._resolveChangeProcessingPromiseWithError(C.operations.REVERT,r);this.setApplyState(C.applyState.REVERT_FINISHED);};
C.prototype.hasApplyProcessStarted=function(){return this.getApplyState()===C.applyState.APPLYING;};
C.prototype.isApplyProcessFinished=function(){return this.getApplyState()===C.applyState.APPLY_FINISHED;};
C.prototype.hasRevertProcessStarted=function(){return this.getApplyState()===C.applyState.REVERTING;};
C.prototype.isRevertProcessFinished=function(){return this.getApplyState()===C.applyState.REVERT_FINISHED;};
C.prototype.isCurrentProcessFinished=function(){return this._aQueuedProcesses.length===0&&this.getApplyState()!==C.applyState.INITIAL;};
C.prototype.addChangeProcessingPromise=function(k){if(!this._oChangeProcessingPromises[k]){this._oChangeProcessingPromises[k]={};this._oChangeProcessingPromises[k].promise=new Promise(function(r){this._oChangeProcessingPromises[k].resolveFunction={resolve:r};}.bind(this));}return this._oChangeProcessingPromises[k].promise;};
C.prototype.addChangeProcessingPromises=function(){var r=[];if(this.getApplyState()===C.applyState.INITIAL&&this._oChangeProcessedPromise){r.push(this._oChangeProcessedPromise.promise);}this._aQueuedProcesses.forEach(function(p){r.push(this.addChangeProcessingPromise(p));},this);return r;};
C.prototype.addPromiseForApplyProcessing=function(){return this.addChangeProcessingPromise(C.operations.APPLY);};
C.prototype._resolveChangeProcessingPromiseWithError=function(k,r){if(this._oChangeProcessingPromises[k]){this._oChangeProcessingPromises[k].resolveFunction.resolve(r);delete this._oChangeProcessingPromises[k];}if(this._oChangeProcessedPromise){this._oChangeProcessedPromise.resolveFunction.resolve(r);this._oChangeProcessedPromise=null;}};
C.prototype._isValidState=function(s){var d=false;Object.keys(C.states).some(function(k){if(C.states[k]===s){d=true;}return d;});if(!d){return false;}if((this.getState()===C.states.NEW)&&(s===C.states.DIRTY)){return false;}return true;};
C.prototype.isValid=function(){var I=true;if(typeof(this._oDefinition)!=="object"){I=false;}if(!this._oDefinition.fileType){I=false;}if(!this._oDefinition.fileName){I=false;}if(!this._oDefinition.changeType){I=false;}if(!this._oDefinition.layer){I=false;}if(!this._oDefinition.originalLanguage){I=false;}return I;};
C.prototype.isVariant=function(){return this._oDefinition.fileType==="variant";};
C.prototype.getChangeType=function(){if(this._oDefinition){return this._oDefinition.changeType;}};
C.prototype.getFileName=function(){if(this._oDefinition){return this._oDefinition.fileName;}};
C.prototype.getFileType=function(){if(this._oDefinition){return this._oDefinition.fileType;}};
C.prototype.getOriginalLanguage=function(){if(this._oDefinition&&this._oDefinition.originalLanguage){return this._oDefinition.originalLanguage;}return"";};
C.prototype.getPackage=function(){return this._oDefinition.packageName;};
C.prototype.setPackage=function(p){if(typeof(p)!=="string"){b.error("sap.ui.fl.Change.setPackage : sPackage is not defined");}this._oDefinition.packageName=p;};
C.prototype.getNamespace=function(){return this._oDefinition.namespace;};
C.prototype.setNamespace=function(n){this._oDefinition.namespace=n;};
C.prototype.getModuleName=function(){return this._oDefinition.moduleName;};
C.prototype.setModuleName=function(m){this._oDefinition.moduleName=m;};
C.prototype.getProjectId=function(){return this._oDefinition.projectId;};
C.prototype.setProjectId=function(p){this._oDefinition.projectId=p;};
C.prototype.getId=function(){return this._oDefinition.fileName;};
C.prototype.getContent=function(){return this._oDefinition.content;};
C.prototype.setContent=function(o){this._oDefinition.content=o;this.setState(C.states.DIRTY);};
C.prototype.getVariantReference=function(){return this._oDefinition.variantReference||"";};
C.prototype.setVariantReference=function(v){this._oDefinition.variantReference=v;this.setState(C.states.DIRTY);};
C.prototype.getSelector=function(){return this._oDefinition.selector;};
C.prototype.setSelector=function(s){this._oDefinition.selector=s;};
C.prototype.getSourceSystem=function(){return this._oDefinition.sourceSystem;};
C.prototype.getSourceClient=function(){return this._oDefinition.sourceClient;};
C.prototype.getOwnerId=function(){return this._oDefinition.support?this._oDefinition.support.user:"";};
C.prototype.getText=function(t){if(typeof(t)!=="string"){b.error("sap.ui.fl.Change.getTexts : sTextId is not defined");}if(this._oDefinition.texts){if(this._oDefinition.texts[t]){return this._oDefinition.texts[t].value;}}return"";};
C.prototype.getTexts=function(){return this._oDefinition.texts;};
C.prototype.setText=function(t,n){if(typeof(t)!=="string"){b.error("sap.ui.fl.Change.setTexts : sTextId is not defined");return;}if(this._oDefinition.texts){if(this._oDefinition.texts[t]){this._oDefinition.texts[t].value=n;this.setState(C.states.DIRTY);}}};
C.prototype.isReadOnly=function(){return this._isReadOnlyDueToLayer()||this._isReadOnlyWhenNotKeyUser()||this.isChangeFromOtherSystem();};
C.prototype._isReadOnlyWhenNotKeyUser=function(){if(this.isUserDependent()){return false;}var r=this.getDefinition().reference;if(!r){return true;}var s=S.getInstanceOrUndef();if(!s){return true;}return!s.isKeyUser();};
C.prototype.isLabelReadOnly=function(){if(this._isReadOnlyDueToLayer()){return true;}return this._isReadOnlyDueToOriginalLanguage();};
C.prototype._isReadOnlyDueToLayer=function(){var s;s=this._bUserDependent?L.USER:a.getCurrentLayer();return(this._oDefinition.layer!==s);};
C.prototype.isChangeFromOtherSystem=function(){var s=this.getSourceSystem();var d=this.getSourceClient();if(!s||!d){return false;}var o=S.getInstanceOrUndef();if(!o){return true;}var e=o.getSystem();var f=o.getClient();if(!e||!f){return false;}return(s!==e||d!==f);};
C.prototype._isReadOnlyDueToOriginalLanguage=function(){var s;var o;o=this.getOriginalLanguage();if(!o){return false;}s=U.getCurrentLanguage();return(s!==o);};
C.prototype.markForDeletion=function(){this.setState(C.states.DELETED);};
C.prototype.restorePreviousState=function(){if(this._sPreviousState){this.setState(this._sPreviousState);delete this._sPreviousState;}};
C.prototype.setRequest=function(r){if(typeof(r)!=="string"){b.error("sap.ui.fl.Change.setRequest : sRequest is not defined");}this._sRequest=r;};
C.prototype.getRequest=function(){return this._sRequest;};
C.prototype.getLayer=function(){return this._oDefinition.layer;};
C.prototype.getComponent=function(){return this._oDefinition.reference;};
C.prototype.setComponent=function(s){this._oDefinition.reference=s;};
C.prototype.getCreation=function(){return this._oDefinition.creation;};
C.prototype.isUserDependent=function(){return(this._bUserDependent);};
C.prototype.getDefinition=function(){return this._oDefinition;};
C.prototype.setResponse=function(r){var R=JSON.stringify(r);if(R){this._oDefinition=JSON.parse(R);this.setState(C.states.PERSISTED);}};
C.prototype.getFullFileIdentifier=function(){var l=this.getLayer();var n=this.getNamespace();var f=this.getDefinition().fileName;var F=this.getDefinition().fileType;return l+"/"+n+"/"+f+"."+F;};
C.prototype.addDependentControl=function(v,A,p,m){if(!v){throw new Error("Parameter vControl is mandatory");}if(!A){throw new Error("Parameter sAlias is mandatory");}if(!p){throw new Error("Parameter mPropertyBag is mandatory");}if(!this._oDefinition.dependentSelector){this._oDefinition.dependentSelector={};}if(this._oDefinition.dependentSelector[A]){throw new Error("Alias '"+A+"' already exists in the change.");}var o=p.modifier;var d=p.appComponent;if(Array.isArray(v)){var s=[];v.forEach(function(e){s.push(o.getSelector(e,d,m));});this._oDefinition.dependentSelector[A]=s;}else{this._oDefinition.dependentSelector[A]=o.getSelector(v,d,m);}delete this._aDependentSelectorList;};
C.prototype.getDependentControl=function(A,p){var d=[];var o;if(!A){throw new Error("Parameter sAlias is mandatory");}if(!p){throw new Error("Parameter mPropertyBag is mandatory");}var m=p.modifier;var e=p.appComponent;if(!this._oDefinition.dependentSelector){return undefined;}o=this._oDefinition.dependentSelector[A];if(Array.isArray(o)){o.forEach(function(s){d.push(m.bySelector(s,e,p.view));});return d;}return m.bySelector(o,e,p.view);};
C.prototype.getOriginalSelector=function(){return this.getDefinition().dependentSelector&&this.getDefinition().dependentSelector.originalSelector;};
C.prototype.getDependentSelectorList=function(){var t=this;var d=[this.getSelector()];if(!this._aDependentSelectorList){if(this._oDefinition.dependentSelector){Object.keys(this._oDefinition.dependentSelector).some(function(A){if(A==="originalSelector"){d=[this.getSelector()];return true;}var e=t._oDefinition.dependentSelector[A];if(!Array.isArray(e)){e=[e];}e.forEach(function(o){if(o&&U.indexOfObject(d,o)===-1){d.push(o);}});}.bind(this));}this._aDependentSelectorList=d;}return this._aDependentSelectorList;};
C.prototype.getDependentControlSelectorList=function(){var d=this.getDependentSelectorList().concat();if(d.length>0){var s=this.getSelector();var I=U.indexOfObject(d,s);if(I>-1){d.splice(I,1);}}return d;};
C.prototype.getRevertData=function(){return this._vRevertData;};
C.prototype.hasRevertData=function(){return this._vRevertData!==null;};
C.prototype.setRevertData=function(d){if(d===undefined){throw new Error("Change cannot be applied in XML as revert data is not available yet. Retrying in JS.");}this._vRevertData=d;};
C.prototype.resetRevertData=function(){this.setRevertData(null);};
C.prototype.getUndoOperations=function(){return this._aUndoOperations;};
C.prototype.setUndoOperations=function(d){this._aUndoOperations=d;};
C.prototype.getExtensionPointInfo=function(){return this._oExtensionPointInfo;};
C.prototype.setExtensionPointInfo=function(e){this._oExtensionPointInfo=e;};
C.prototype.resetUndoOperations=function(){this.setUndoOperations(null);};
C.createInitialFileContent=function(p){if(!p){p={};}var f;if(p.fileType){f=p.fileType;}else{f=p.isVariant?"variant":"change";}var n={fileName:p.id||U.createDefaultFileName(p.changeType),fileType:f,changeType:p.changeType||"",moduleName:p.moduleName||"",reference:p.reference||"",packageName:p.packageName||"",content:p.content||{},selector:p.selector||{id:""},layer:p.layer||(p.isUserDependent?L.USER:a.getCurrentLayer()),texts:p.texts||{},namespace:p.namespace||U.createNamespace(p,f),projectId:p.projectId||(p.reference&&p.reference.replace(".Component",""))||"",creation:"",originalLanguage:U.getCurrentLanguage(),support:{generator:p.generator||"Change.createInitialFileContent",service:p.service||"",user:"",sapui5Version:sap.ui.version,sourceChangeFileName:p.support&&p.support.sourceChangeFileName||"",compositeCommand:p.support&&p.support.compositeCommand||"",command:p.command||""},oDataInformation:p.oDataInformation||{},dependentSelector:p.dependentSelector||{},jsOnly:p.jsOnly||false,variantReference:p.variantReference||"",appDescriptorChange:i(D.getChangeTypes(),p.changeType)};return n;};
return C;},true);
sap.ui.predefine('sap/ui/fl/ChangePersistence',["sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/Variant","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/Cache","sap/ui/fl/registry/Settings","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/write/_internal/Storage","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Component","sap/ui/model/json/JSONModel","sap/ui/performance/Measurement","sap/base/util/includes","sap/base/util/merge","sap/base/util/restricted/_union","sap/base/util/UriParameters","sap/base/Log","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/write/_internal/condenser/Condenser"],function(D,S,C,L,V,U,a,b,c,A,d,J,e,f,M,i,m,u,g,h,j,F,k){"use strict";var l=function(x){this._mComponent=x;this._mChanges=D.createEmptyDependencyMap();this._bChangesMapCreated=false;this._mChangesInitial=m({},this._mChanges);if(!this._mComponent||!this._mComponent.name){h.error("The Control does not belong to an SAPUI5 component. Personalization and changes for this control might not work as expected.");throw new Error("Missing component name.");}this._aDirtyChanges=[];this._oMessagebundle=undefined;this._mChangesEntries={};this._bHasChangesOverMaxLayer=false;this.HIGHER_LAYER_CHANGES_EXIST="higher_layer_changes_exist";};
function n(x,y){var z;if(y instanceof C){z=y;this._mChangesEntries[z.getFileName()]=z;}else{if(!this._mChangesEntries[y.fileName]){this._mChangesEntries[y.fileName]=new C(y);}z=this._mChangesEntries[y.fileName];z.setState(C.states.PERSISTED);}return z;}
l.prototype.getComponentName=function(){return this._mComponent.name;};
l.prototype.getCacheKey=function(x){return b.getCacheKey(this._mComponent,x);};
l.prototype._preconditionsFulfilled=function(x){var y=x instanceof C?x.getDefinition():x;function _(){if((y.fileType==="ctrl_variant")||(y.fileType==="ctrl_variant_change")||(y.fileType==="ctrl_variant_management_change")){return y.variantManagementReference||y.variantReference||(y.selector&&y.selector.id);}}return y.fileType==="change"||_();};
l.prototype.getChangesForComponent=function(P,I){return U.getUShellService("URLParsing").then(function(x){this._oUShellURLParsingService=x;return b.getChangesFillingCache(this._mComponent,P,I);}.bind(this)).then(function(P,W){var x=m({},W);var y=P&&P.component&&U.getAppComponentForControl(P.component);var H=S.isStorageResponseFilled(x.changes);if(!H){return[];}var z=x.changes.changes;if(!this._oMessagebundle&&x.messagebundle&&y){if(!y.getModel("i18nFlexVendor")){if(z.some(function(Q){return Q.layer===L.VENDOR;})){this._oMessagebundle=x.messagebundle;var B=new f(this._oMessagebundle);y.setModel(B,"i18nFlexVendor");}}}var E=P&&P.currentLayer;var G=!(P&&P.ignoreMaxLayerParameter);var K=function(){return true;};if(E){z=a.filterChangeOrChangeDefinitionsByCurrentLayer(z,E);}else if(a.isLayerFilteringRequired(this._oUShellURLParsingService)&&G){K=this._filterChangeForMaxLayer.bind(this);z=z.filter(K);}else if(this._bHasChangesOverMaxLayer&&!G){this._bHasChangesOverMaxLayer=false;return this.HIGHER_LAYER_CHANGES_EXIST;}var N=x.changes&&P&&P.includeCtrlVariants;var O=this._getAllCtrlVariantChanges(x,N,K);z=z.concat(O);return this._checkAndGetChangeInstances(z,x);}.bind(this,P));};
l.prototype._checkAndGetChangeInstances=function(x,y){return x.filter(this._preconditionsFulfilled).map(n.bind(this,y));};
l.prototype._filterChangeForMaxLayer=function(x){if(a.isOverMaxLayer(this._getLayerFromChangeOrChangeContent(x),this._oUShellURLParsingService)){if(!this._bHasChangesOverMaxLayer){this._bHasChangesOverMaxLayer=true;}return false;}return true;};
l.prototype._getLayerFromChangeOrChangeContent=function(x){var y;if(x instanceof V||x instanceof C){y=x.getLayer();}else{y=x.layer;}return y;};
l.prototype._getAllCtrlVariantChanges=function(x,I,y){if(!I){return j.getInitialChanges({reference:this._mComponent.name});}return["variants","variantChanges","variantDependentControlChanges","variantManagementChanges"].reduce(function(R,z){if(x.changes[z]){return R.concat(x.changes[z]);}return R;},[]).filter(y);};
l.prototype.loadChangesMapForComponent=function(x){return this.getChangesForComponent({component:x}).then(y.bind(this));function y(z){M.start("fl.createDependencyMap","Measurement of creating initial dependency map");this._mChanges=D.createEmptyDependencyMap();z.forEach(this.addChangeAndUpdateDependencies.bind(this,x));this._mChangesInitial=m({},this._mChanges);M.end("fl.createDependencyMap","Measurement of creating initial dependency map");this._bChangesMapCreated=true;return this.getChangesMapForComponent.bind(this);}};
l.prototype.checkForOpenDependenciesForControl=function(x,y){return D.checkForOpenDependenciesForControl(this._mChanges,J.getControlIdBySelector(x,y),y);};
function o(x){var I=m({},this._mChangesInitial.mDependencies);return I[x.getId()];}
function p(I,N,x,y){var z;var B=[];I.controlsDependencies.forEach(function(E){if(!J.bySelector(E,x)){z=J.getControlIdBySelector(E,x);B.push(E);this._mChanges.mControlsWithDependencies[z]=this._mChanges.mControlsWithDependencies[z]||[];if(!i(this._mChanges.mControlsWithDependencies[z],y.getId())){this._mChanges.mControlsWithDependencies[z].push(y.getId());}}}.bind(this));I.dependencies=N;I.controlsDependencies=B;if(N.length||B.length){this._mChanges.mDependencies[y.getId()]=I;}}
l.prototype.copyDependenciesFromInitialChangesMapSync=function(x,y,z){var I=o.call(this,x);if(I){var N=[];I.dependencies.forEach(function(B){if(y(B)){this._mChanges.mDependentChangesOnMe[B]=this._mChanges.mDependentChangesOnMe[B]||[];this._mChanges.mDependentChangesOnMe[B].push(x.getId());N.push(B);}}.bind(this));p.call(this,I,N,z,x);}return this._mChanges;};
l.prototype.copyDependenciesFromInitialChangesMap=function(x,y,z){var I=o.call(this,x);if(I){var N=[];return I.dependencies.reduce(function(P,B){return P.then(function(){return y(B);}).then(function(E){if(E){this._mChanges.mDependentChangesOnMe[B]=this._mChanges.mDependentChangesOnMe[B]||[];this._mChanges.mDependentChangesOnMe[B].push(x.getId());N.push(B);}}.bind(this));}.bind(this),Promise.resolve()).then(function(){p.call(this,I,N,z,x);return this._mChanges;}.bind(this));}return Promise.resolve(this._mChanges);};
l.prototype.addChangeAndUpdateDependencies=function(x,y,R){y.setInitialApplyState();if(R){D.insertChange(y,this._mChanges,R);}D.addChangeAndUpdateDependencies(y,x,this._mChanges);};
l.prototype._addRunTimeCreatedChangeAndUpdateDependencies=function(x,y){D.addRuntimeChangeAndUpdateDependencies(y,x,this._mChanges,this._mChangesInitial);};
l.prototype.getChangesMapForComponent=function(){return this._mChanges;};
l.prototype.getAllUIChanges=function(P){var x=u(this.getChangesMapForComponent().aChanges,P.includeDirtyChanges&&this.getDirtyChanges()).filter(function(y){return(Boolean(y)&&y.getFileType()==="change"&&a.compareAgainstCurrentLayer(y.getLayer(),P.layer)===0);});return x;};
l.prototype.isChangeMapCreated=function(){return this._bChangesMapCreated;};
l.prototype.changesHavingCorrectViewPrefix=function(P,x){var y=P.modifier;var z=P.appComponent;var B=x.getSelector();if(!B||!P){return false;}if(B.viewSelector){var E=y.getControlIdBySelector(B.viewSelector,z);return E===P.viewId;}var G=B.id;if(G){var H;if(x.getSelector().idIsLocal){if(z){H=z.getLocalId(P.viewId);}}else{H=P.viewId;}var I=0;var K;do{I=G.indexOf("--",I);K=G.slice(0,I);I++;}while(K!==H&&I>0);return K===H;}return false;};
l.prototype.getChangesForView=function(P){return this.getChangesForComponent(P).then(function(x){return x.filter(this.changesHavingCorrectViewPrefix.bind(this,P));}.bind(this));};
l.prototype.addChange=function(x,y){var z=this.addDirtyChange(x);this._addRunTimeCreatedChangeAndUpdateDependencies(y,z);this._mChangesEntries[z.getFileName()]=z;this._addPropagationListener(y);return z;};
l.prototype.addDirtyChange=function(x){var N;if(x instanceof C||x instanceof V){N=x;}else{N=new C(x);}if(this._aDirtyChanges.indexOf(N)===-1){this._aDirtyChanges.push(N);}return N;};
l.prototype._addPropagationListener=function(x){var y=U.getAppComponentForControl(x);if(y instanceof e){var z=function(P){return!P._bIsSapUiFlFlexControllerApplyChangesOnControl;};var N=y.getPropagationListeners().every(z);if(N){var B=sap.ui.require("sap/ui/fl/FlexControllerFactory");var E=B.create(this.getComponentName());var P=A.applyAllChangesForControl.bind(A,this.getChangesMapForComponent.bind(this),y,E);P._bIsSapUiFlFlexControllerApplyChangesOnControl=true;y.addPropagationListener(P);}}};
l.prototype._deleteNotSavedChanges=function(x,y,z){x.filter(function(B){return!y.some(function(E){return B.getId()===E.getId();});}).forEach(function(B){if(z){this.removeChange(B);b.deleteChange(this._mComponent,B.getDefinition());}else{this.deleteChange(B);}}.bind(this));};
function q(x,y){var P=x.map(function(B){return B[y]();});var z=P.filter(function(B,I,P){return P.indexOf(B)===I;});return z.length===1;}
function s(x,y){var z=false;if(!x||y.length<2){return false;}if(!q(y,"getLayer")){return false;}var B=y[0].getLayer();if(B==="CUSTOMER"||B==="USER"){z=true;}var E=g.fromURL(window.location.href);if(E.has("sap-ui-xx-condense-changes")){z=E.get("sap-ui-xx-condense-changes")==="true";}return z;}
function r(x){var E=c.getInstanceOrUndef()&&c.getInstanceOrUndef().isCondensingEnabled();if(E&&!q(x,"getNamespace")){E=false;}return E;}
function t(x,y,z,B){this._massUpdateCacheAndDirtyState(y,z);this._deleteNotSavedChanges(x,y,B);}
function v(x){if(!x.length){return[];}var y=x[0].getLayer();var P=this._mChanges.aChanges.filter(function(z){return z.getState()===C.states.PERSISTED&&a.compareAgainstCurrentLayer(z.getLayer(),y)===0;});return P.concat(x);}
l.prototype.saveDirtyChanges=function(x,y,z,B){var E=z||this._aDirtyChanges;var R=v.call(this,E);var I=(r(R)&&s(x,R));var G=I?R:E;var H=G.slice(0);var K=E.slice(0);var N=this._getRequests(E);var O=this._getStates(E);if(O.length===1&&N.length===1&&O[0]===C.states.NEW){var P=Promise.resolve(H);if(s(x,H)){P=k.condense(x,H);}return P.then(function(Q){var T=N[0];var W=E[0].getDefinition().layer;if(I){return d.condense({allChanges:G,condensedChanges:Q,layer:W,transport:T,isLegacyVariant:false,parentVersion:B}).then(function(X){t.call(this,G,Q,y,true);return X;}.bind(this));}if(Q.length){return d.write({layer:W,flexObjects:this._prepareDirtyChanges(Q),transport:T,isLegacyVariant:false,parentVersion:B}).then(function(X){t.call(this,G,Q,y);return X;}.bind(this));}this._deleteNotSavedChanges(G,Q);}.bind(this));}return this.saveSequenceOfDirtyChanges(K,y,B);};
l.prototype.saveSequenceOfDirtyChanges=function(x,y,z){var B;if(z){var N=x.filter(function(E){return E.getState()===C.states.NEW;});B=[].concat(N).shift();}return x.reduce(function(P,E){return P.then(this._performSingleSaveAction(E,B,z)).then(this._updateCacheAndDirtyState.bind(this,E,y));}.bind(this),Promise.resolve());};
l.prototype._performSingleSaveAction=function(x,y,z){return function(){switch(x.getState()){case C.states.NEW:if(z!==undefined){z=x===y?z:sap.ui.fl.Versions.Draft;}return d.write({layer:x.getLayer(),flexObjects:[x.getDefinition()],transport:x.getRequest(),parentVersion:z});case C.states.DELETED:return d.remove({flexObject:x.getDefinition(),layer:x.getLayer(),transport:x.getRequest()});}};};
l.prototype._updateCacheAndDirtyState=function(x,y){if(!y){if(U.isChangeRelatedToVariants(x)){j.updateVariantsState({reference:this._mComponent.name,changeToBeAddedOrDeleted:x});}else{switch(x.getState()){case C.states.NEW:x.setState(C.states.PERSISTED);b.addChange(this._mComponent,x.getDefinition());break;case C.states.DELETED:b.deleteChange(this._mComponent,x.getDefinition());break;case C.states.DIRTY:x.setState(C.states.PERSISTED);b.updateChange(this._mComponent,x.getDefinition());break;}}}this._aDirtyChanges=this._aDirtyChanges.filter(function(E){return x.getId()!==E.getId();});};
l.prototype._massUpdateCacheAndDirtyState=function(x,y){x.forEach(function(z){this._updateCacheAndDirtyState(z,y);},this);};
l.prototype._getRequests=function(x){var R=[];x.forEach(function(y){var z=y.getRequest();if(R.indexOf(z)===-1){R.push(z);}});return R;};
l.prototype._getStates=function(x){var y=[];x.forEach(function(z){var B=z.getState();if(y.indexOf(B)===-1){y.push(B);}});return y;};
l.prototype._prepareDirtyChanges=function(x){var y=[];x.forEach(function(z){y.push(z.getDefinition());});return y;};
l.prototype.getDirtyChanges=function(){return this._aDirtyChanges;};
l.prototype.deleteChange=function(x,R){var y=this._aDirtyChanges.indexOf(x);if(y>-1){if(x.getState()===C.states.DELETED){return;}this._aDirtyChanges.splice(y,1);this._deleteChangeInMap(x,R);return;}x.markForDeletion();this.addDirtyChange(x);this._deleteChangeInMap(x,R);};
l.prototype.removeChange=function(x){var y=this._aDirtyChanges.indexOf(x);if(y>-1){this._aDirtyChanges.splice(y,1);}this._deleteChangeInMap(x);};
l.prototype._deleteChangeInMap=function(x,R){var y=x.getId();D.removeChangeFromMap(this._mChanges,y);D.removeChangeFromDependencies(R?this._mChangesInitial:this._mChanges,y);};
function w(x,O){return(O.getRequest()==="$TMP"||O.getRequest()==="")&&O.getLayer()===x;}
l.prototype.transportAllUIChanges=function(R,x,y,z){return Promise.all([this.getChangesForComponent({currentLayer:y,includeCtrlVariants:true}),F.getCompVariantsMap(this.getComponentName())]).then(function(B){var E=B[0];var G=B[1];var H=[];for(var P in G){for(var I in G[P].byId){H.push(G[P].byId[I]);}}E=E.concat(H.filter(w.bind(this,y)));return d.publish({transportDialogSettings:{rootControl:R,styleClass:x},layer:y,reference:this.getComponentName(),localChanges:E,appVariantDescriptors:z});}.bind(this));};
l.prototype._getChangesFromMapByNames=function(N){return this._mChanges.aChanges.filter(function(x){return N.indexOf(x.getFileName())!==-1;});};
l.prototype.removeDirtyChanges=function(x,y,z,G,B){var E=[].concat(x||[]);var H=this._aDirtyChanges;var I=H.filter(function(K){var N=true;if(E.length&&!E.includes(K.getLayer())){return false;}if(G&&K.getDefinition().support.generator!==G){return false;}if(z){var O=K.getSelector();N=z.getId()===J.getControlIdBySelector(O,y);}if(B){N=N&&B.indexOf(K.getChangeType())!==-1;}return N;});I.forEach(function(K){var N=H.indexOf(K);H.splice(N,1);});return Promise.resolve(I);};
l.prototype.resetChanges=function(x,G,y,z){var B=y&&y.length>0;var E=z&&z.length>0;return this.getChangesForComponent({currentLayer:x,includeCtrlVariants:true}).then(function(H){var P={reference:this.getComponentName(),layer:x,changes:H};if(G){P.generator=G;}if(B){P.selectorIds=y;}if(E){P.changeTypes=z;}return d.reset(P);}.bind(this)).then(function(R){var H=[];if(y||z){var N=[];if(R&&R.response&&R.response.length>0){R.response.forEach(function(I){N.push(I.fileName);});}b.removeChanges(this._mComponent,N);H=this._getChangesFromMapByNames(N);}return H;}.bind(this));};
l.prototype.getResetAndPublishInfo=function(P){return d.getFlexInfo(P);};
return l;});
sap.ui.predefine('sap/ui/fl/ChangePersistenceFactory',["sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/ChangePersistence","sap/ui/fl/Utils","sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory","sap/ui/fl/apply/_internal/changes/descriptor/Applier"],function(C,F,a,U,A,b){"use strict";var c={};c._instanceCache={};
c.getChangePersistenceForComponent=function(s){var o=c._instanceCache[s];if(!o){var d={name:s};o=new a(d);c._instanceCache[s]=o;}return o;};
c.getChangePersistenceForControl=function(o){var s;s=U.getComponentClassName(o);return c.getChangePersistenceForComponent(s);};
c.registerLoadComponentEventHandler=function(){C._fnLoadComponentCallback=this._onLoadComponent.bind(this);};
c._onLoadComponent=function(o,m){if(!U.isApplication(m)||!o.id){return Promise.resolve();}F.initialize({componentData:o.componentData||(o.settings&&o.settings.componentData),asyncHints:o.asyncHints,manifest:m,componentId:o.id});return b.applyChangesIncludedInManifest(m,A.getRuntimeStrategy());};
return c;},true);
sap.ui.predefine('sap/ui/fl/EventHistory',function(){"use strict";var E=function(){};E._aEventIds=["ControlForPersonalizationRendered"];E._aUnsubscribedEventIds=[];E._oHistory={};
E.start=function(){E._aEventIds.forEach(function(e){if(E._aUnsubscribedEventIds.indexOf(e)===-1){sap.ui.getCore().getEventBus().subscribe("sap.ui",e,E.saveEvent);E._oHistory[e]=[];}});};
E.saveEvent=function(c,e,p){var o={channelId:c,eventId:e,parameters:p.getId()};if(E._oHistory[e]){var b=E._oHistory[e].some(function(O){return(O.channelId===o.channelId&&O.eventId===o.eventId&&O.parameters===o.parameters);});if(!b){E._oHistory[e].push(o);}}};
E.getHistoryAndStop=function(e){sap.ui.getCore().getEventBus().unsubscribe("sap.ui",e,E.saveEvent);E._addUnsubscribedEvent(e);return E._oHistory[e]||[];};
E._addUnsubscribedEvent=function(e){if(E._aUnsubscribedEventIds.indexOf(e)===-1){E._aUnsubscribedEventIds.push(e);}};
return E;},true);
sap.ui.predefine('sap/ui/fl/FlexController',["sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/fl/Change","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/write/_internal/Versions","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/util/reflection/XmlTreeModifier","sap/ui/core/Component","sap/base/Log"],function(C,U,L,a,b,V,A,R,c,J,X,d,e){"use strict";
function r(o,s,h){return Promise.resolve().then(function(){if(h.length!==0){h.reverse();return R.revertMultipleChanges(h,{appComponent:o,modifier:J,flexController:this});}}.bind(this)).then(function(){if(o){var m=o.getModel(U.VARIANT_MODEL_NAME);if(m){h.forEach(function(i){var v=i.getVariantReference();if(v){m.removeChange(i);}});if(!s){c.update({parameters:[],updateURL:true,updateHashEntry:true,model:m});}}}return h;});}
var F=function(s){this._oChangePersistence=undefined;this._sComponentName=s||"";if(this._sComponentName){this._createChangePersistence();}};
F.prototype.getComponentName=function(){return this._sComponentName;};
F.prototype.setVariantSwitchPromise=function(p){this._oVariantSwitchPromise=p;};
F.prototype.waitForVariantSwitch=function(){if(!this._oVariantSwitchPromise){this._oVariantSwitchPromise=Promise.resolve();}return this._oVariantSwitchPromise;};
F.prototype.createBaseChange=function(o,h){var i;var j;if(!h){throw new Error("No application component found. To offer flexibility a valid relation to its owning component must be present.");}o.reference=this.getComponentName();o.packageName="$TMP";i=a.createInitialFileContent(o);j=new a(i);if(o.variantReference){j.setVariantReference(o.variantReference);}return j;};
F.prototype._createChange=function(o,h,i){var s=i&&(i.controlType||U.getControlType(i));var j=this.createBaseChange(o,h);return this._getChangeHandler(j,s,i,J).then(function(k){if(k){return k.completeChangeContent(j,o,{modifier:J,appComponent:h,view:U.getViewForControl(i)});}throw new Error("Change handler could not be retrieved for change "+JSON.stringify(o)+".");}).then(function(){return j;}).catch(function(E){return Promise.reject(E);});};
F.prototype.createChangeWithExtensionPointSelector=function(o,E){return Promise.resolve().then(function(){if(!E){throw new Error("A flexibility change on extension point cannot be created without a valid extension point reference.");}var v=E.view;var h=U.getAppComponentForControl(v);o.selector={name:E.name,viewSelector:J.getSelector(v.getId(),h)};return h;}).then(function(h){return this._createChange(o,h);}.bind(this));};
F.prototype.createChangeWithControlSelector=function(o,h){var i;return new U.FakePromise().then(function(){if(!h){throw new Error("A flexibility change cannot be created without a targeted control.");}var s=h.id||h.getId();if(!o.selector){o.selector={};}i=h.appComponent||U.getAppComponentForControl(h);if(!i){throw new Error("No application component found. To offer flexibility, the control with the ID '"+s+"' has to have a valid relation to its owning application component.");}Object.assign(o.selector,J.getSelector(s,i));return i;}).then(function(i){return this._createChange(o,i,h);}.bind(this));};
F.prototype.addChange=function(o,h){return this.createChangeWithControlSelector(o,h).then(function(i){var j=U.getAppComponentForControl(h);i._ignoreOnce=true;this.addPreparedChange(i,j);i.setQueuedForApply();return i;}.bind(this));};
F.prototype.addPreparedChange=function(o,h){if(o.getVariantReference()){var m=h.getModel(U.VARIANT_MODEL_NAME);m.addChange(o);}this._oChangePersistence.addChange(o,h);return o;};
F.prototype.deleteChange=function(o,h){this._oChangePersistence.deleteChange(o);if(o.getVariantReference()){h.getModel(U.VARIANT_MODEL_NAME).removeChange(o);}};
F.prototype.applyChange=function(o,h){var p={modifier:J,appComponent:U.getAppComponentForControl(h),view:U.getViewForControl(h)};return A.applyChangeOnControl(o,h,p).then(function(i){if(!i.success){var E=i.error||new Error("The change could not be applied.");this._oChangePersistence.deleteChange(o,true);throw E;}return o;}.bind(this));};
function f(o,D,m,h,j){var k=g(o,h);if(!k){return[];}j.push(o);var s=o.getId();var l=D[s]&&D[s].dependencies||[];for(var i=0,n=l.length;i<n;i++){var p=U.getChangeFromChangesMap(m,l[i]);k=f(p,D,m,h,j);if(k.length===0){j=[];break;}delete D[s];}return j;}
function g(o,h){var s=o.getDependentControlSelectorList();s.push(o.getSelector());return!s.some(function(S){return!J.bySelector(S,h);});}
F.prototype.waitForChangesToBeApplied=function(s){var p=s.map(function(S){return this._waitForChangesToBeApplied(S);}.bind(this));return Promise.all(p).then(function(){return undefined;});};
F.prototype._waitForChangesToBeApplied=function(p){function h(q){return!q.isCurrentProcessFinished()&&(p.changeTypes.length===0||p.changeTypes.includes(q.getChangeType()));}p.changeTypes=p.changeTypes||[];var o=p.selector.id&&sap.ui.getCore().byId(p.selector.id)||p.selector;var m=this._oChangePersistence.getChangesMapForComponent();var P=[];var D=Object.assign({},m.mDependencies);var i=m.mChanges;var j=i[o.getId()]||[];var n=j.filter(h);var k=p.selector.appComponent||U.getAppComponentForControl(o);var l=[];n.forEach(function(q){var s=f(q,D,m.mChanges,k,[]);s.forEach(function(t){if(l.indexOf(t)===-1){l.push(t);}});});l.forEach(function(q){P=P.concat(q.addChangeProcessingPromises());},this);P.push(this.waitForVariantSwitch());return Promise.all(P);};
F.prototype._removeOtherLayerChanges=function(o,l,h){if(h&&l){var i=Object.values(L).filter(function(s){return s!==l;});return this.removeDirtyChanges(i,o,undefined,undefined,undefined,true);}return Promise.resolve();};
F.prototype.saveAll=function(o,s,D,l,h){var n=D?V.getVersionsModel({reference:U.normalizeReference(this._sComponentName),layer:L.CUSTOMER}).getProperty("/persistedVersion"):undefined;return this._removeOtherLayerChanges(o,l,h).then(this._oChangePersistence.saveDirtyChanges.bind(this._oChangePersistence,o,s,undefined,n)).then(function(i){if(D&&i&&i.response){var v=i.response;if(Array.isArray(v)){v=v[0];}V.onAllChangesSaved({reference:v.reference,layer:v.layer});}return i;});};
F.prototype.processXmlView=function(v,p){var o=d.get(p.componentId);var h=U.getAppComponentForControl(o);p.appComponent=h;p.modifier=X;p.view=v;return this._oChangePersistence.getChangesForView(p).then(A.applyAllChangesForXMLView.bind(A,p)).catch(this._handlePromiseChainError.bind(this,p.view));};
F.prototype._handlePromiseChainError=function(v,E){e.error("Error processing view "+E+".");return v;};
F.prototype._getChangeHandler=function(o,s,h,m){var i=o.getChangeType();var l=o.getLayer();return C.getChangeHandler(i,s,h,m,l);};
F.prototype.getComponentChanges=function(p,i){return this._oChangePersistence.getChangesForComponent(p,i);};
F.prototype.checkForOpenDependenciesForControl=function(s,o){return this._oChangePersistence.checkForOpenDependenciesForControl(s,o);};
F.prototype._createChangePersistence=function(){this._oChangePersistence=b.getChangePersistenceForComponent(this.getComponentName());return this._oChangePersistence;};
F.prototype.resetChanges=function(l,G,o,s,h){return this._oChangePersistence.resetChanges(l,G,s,h).then(r.bind(this,o,undefined));};
F.prototype.removeDirtyChanges=function(l,o,h,G,i,s){return this._oChangePersistence.removeDirtyChanges(l,o,h,G,i).then(r.bind(this,o,s));};
F.prototype.applyVariantChanges=function(h,o){var i;return h.reduce(function(p,j){return p.then(function(){var P={modifier:J,appComponent:o};this._oChangePersistence._addRunTimeCreatedChangeAndUpdateDependencies(o,j);i=P.modifier.bySelector(j.getSelector(),o);if(i){return A.applyChangeOnControl(j,i,P);}e.error("A flexibility change tries to change a nonexistent control.");}.bind(this));}.bind(this),new U.FakePromise());};
F.prototype.saveSequenceOfDirtyChanges=function(D,o){return this._oChangePersistence.saveDirtyChanges(o,false,D);};
F.prototype.getResetAndPublishInfo=function(p){p.reference=this._sComponentName;return this._oChangePersistence.getResetAndPublishInfo(p);};
return F;},true);
sap.ui.predefine('sap/ui/fl/FlexControllerFactory',["sap/ui/fl/FlexController","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/variants/VariantModel","sap/base/Log","sap/ui/performance/Measurement"],function(F,U,L,A,a,V,b,M){"use strict";var c={};c._instanceCache={};c._componentInstantiationPromises=new WeakMap();
c.create=function(C){var f=c._instanceCache[C];if(!f){f=new F(C);c._instanceCache[C]=f;}return f;};
c.createForControl=function(C){try{var o=U.getAppComponentForControl(C);var s=U.getComponentClassName(o||C);return c.create(s);}catch(e){b.error(e.message,undefined,"sap.ui.fl.FlexControllerFactory");}};
function d(r,C){if(U.getUshellContainer()){return Promise.resolve(r);}var R=window.sessionStorage.getItem("sap.ui.rta.restart."+L.CUSTOMER);if(R){var s=U.getComponentClassName(C);if(R!==s&&R!=="true"){b.error("an application component was started "+"which does not match the component for which the restart was triggered:\n"+"Triggering component: "+R+"\n"+"Started component: "+s);return Promise.resolve(r);}window.sessionStorage.removeItem("sap.ui.rta.restart."+L.CUSTOMER);return new Promise(function(e){sap.ui.getCore().loadLibrary("sap.ui.rta",{async:true}).then(function(){sap.ui.require(["sap/ui/rta/api/startKeyUserAdaptation"],function(f){f({rootControl:C});e(r);});});});}return Promise.resolve(r);}
c.getChangesAndPropagate=function(C,v){if(U.isApplicationComponent(C)){var s=C.getId();var r=a.initialize({componentId:s,asyncHints:v.asyncHints}).then(_.bind(this,C));c._componentInstantiationPromises.set(C,r);return r;}else if(U.isEmbeddedComponent(C)){var o=U.getAppComponentForControl(C);if(o&&U.isApplicationComponent(o)){var i=Promise.resolve();if(c._componentInstantiationPromises.has(o)){i=c._componentInstantiationPromises.get(o);}return i.then(function(){var e=o.getModel(U.VARIANT_MODEL_NAME);if(!e){return _(o);}return e;}).then(function(e){C.setModel(e,U.VARIANT_MODEL_NAME);});}return Promise.resolve();}};
function _(o){var m=o.getManifestObject();var f=c.createForControl(o,m);var v;return f._oChangePersistence.loadChangesMapForComponent(o).then(function(g){var p=A.applyAllChangesForControl.bind(A,g,o,f);p._bIsSapUiFlFlexControllerApplyChangesOnControl=true;o.addPropagationListener(p);v=new V({},{flexController:f,appComponent:o});return v.initialize();}).then(function(){o.setModel(v,U.VARIANT_MODEL_NAME);M.end("flexProcessing");return v;}).then(function(r){return d(r,o);});}
return c;},true);
sap.ui.predefine('sap/ui/fl/LayerUtils',["sap/base/util/UriParameters","sap/ui/thirdparty/hasher","sap/ui/fl/Layer"],function(U,h,L){"use strict";var l=[L.BASE,L.VENDOR,L.PARTNER,L.CUSTOMER_BASE,L.CUSTOMER,L.PUBLIC,L.USER];var m={};l.forEach(function(s,i){m[s]=i;});
function g(p){return U.fromQuery(window.location.search).get(p);}
var a={_mLayersIndex:m,_sTopLayer:l[l.length-1],FL_MAX_LAYER_PARAM:"sap-ui-fl-max-layer",isValidLayer:function(s){return Object.keys(L).some(function(e){return e===s;});},isVendorLayer:function(){return this.getCurrentLayer()===L.VENDOR;},isCustomerDependentLayer:function(s){return([L.PUBLIC,L.CUSTOMER,L.CUSTOMER_BASE].indexOf(s)>-1);},isDeveloperLayer:function(s){return a.compareAgainstCurrentLayer(s,L.CUSTOMER)===-1;},doesCurrentLayerRequirePackage:function(){var c=this.getCurrentLayer();return(c===L.VENDOR)||(c===L.PARTNER)||(c===L.CUSTOMER_BASE);},getMaxLayer:function(u){var p=a.getMaxLayerTechnicalParameter(h.getHash(),u);return p||g(this.FL_MAX_LAYER_PARAM)||a._sTopLayer;},getLayerIndex:function(s){return this._mLayersIndex[s];},isOverMaxLayer:function(s,u){return this.isOverLayer(s,this.getMaxLayer(u));},isOverLayer:function(o,c){return this.getLayerIndex(o)>this.getLayerIndex(c);},compareAgainstCurrentLayer:function(s,c){var C=c||a.getCurrentLayer();if((this.getLayerIndex(C)>this.getLayerIndex(s))||!s){return-1;}else if(this.getLayerIndex(C)===this.getLayerIndex(s)){return 0;}return 1;},isLayerFilteringRequired:function(u){return this._sTopLayer!==this.getMaxLayer(u);},isSapUiLayerParameterProvided:function(){return!!g("sap-ui-layer");},getCurrentLayer:function(){var s=g("sap-ui-layer")||"";return s.toUpperCase()||L.CUSTOMER;},filterChangeDefinitionsByMaxLayer:function(c,u){return c.filter(function(C){return!C.layer||!a.isOverMaxLayer(C.layer,u);});},filterChangeOrChangeDefinitionsByCurrentLayer:function(c,C){if(!C){return c;}return c.filter(function(o){var s=o.getLayer&&o.getLayer()||o.layer;return C===s;});},getMaxLayerTechnicalParameter:function(H,u){if(u){var p=u.parseShellHash(H)||{};if(p.params&&p.params.hasOwnProperty(this.FL_MAX_LAYER_PARAM)){return p.params[this.FL_MAX_LAYER_PARAM][0];}}return undefined;}};return a;});
sap.ui.predefine('sap/ui/fl/PreprocessorImpl',["sap/ui/core/Component","sap/ui/fl/Utils","sap/ui/fl/ChangePersistenceFactory","sap/base/Log"],function(C,U,a,L){"use strict";
function i(c){return c.getChangeType()==="codeExt";}
function b(c,o){var s=o.getSelector().controllerName;return c===s;}
var P=function(){};
P.prototype.getControllerExtensions=function(c,s,A){if(A){if(!s){L.warning("No component ID for determining the anchor of the code extensions was passed.");return Promise.resolve([]);}var o=C.get(s);var d=U.getAppComponentForControl(o);if(!d){L.warning("No application component for determining the anchor of the code extensions was identified.");return Promise.resolve([]);}if(!U.isApplication(d.getManifestObject())){return Promise.resolve([]);}var f=U.getComponentClassName(d);var e=a.getChangePersistenceForComponent(f);return e.getChangesForComponent().then(function(g){var E=g.filter(function(h){return i(h)&&b(c,h);}).map(function(h){return h.getModuleName();});return P.getExtensionModules(E);});}L.warning("Synchronous extensions are not supported by sap.ui.fl.PreprocessorImpl");return[];};
P.getExtensionModules=function(c){if(c.length===0){return Promise.resolve([]);}return new Promise(function(r){sap.ui.require(c,function(){var m=Array.prototype.slice.call(arguments);r(m);},function(e){L.error("Code Extension not found",e.message);r([]);});});};
return P;},true);
sap.ui.predefine('sap/ui/fl/RegistrationDelegator',["sap/ui/fl/FlexControllerFactory","sap/ui/core/Component","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration","sap/ui/fl/ChangePersistenceFactory","sap/ui/core/mvc/Controller","sap/ui/core/mvc/XMLView","sap/ui/core/ExtensionPoint","sap/ui/fl/EventHistory","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/apply/_internal/changes/descriptor/Preprocessor","sap/ui/fl/apply/_internal/DelegateMediator","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/ui/fl/PreprocessorImpl","sap/ui/fl/XmlPreprocessorImpl"],function(F,C,a,b,M,X,E,c,d,P,D,e){"use strict";var R={};
function _(){C._fnOnInstanceCreated=F.getChangesAndPropagate;}
function f(){a.registerPredefinedChangeHandlers();a.getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs();}
function g(){C._fnLoadComponentCallback=b._onLoadComponent.bind(b);}
function h(){M.registerExtensionProvider("sap.ui.fl.PreprocessorImpl");}
function i(){if(X.registerPreprocessor){X.registerPreprocessor("viewxml","sap.ui.fl.XmlPreprocessorImpl",true);}}
function j(){c.start();}
function k(){C._fnPreprocessManifest=P.preprocessManifest;}
function l(v){if(d.isFlexExtensionPointHandlingEnabled(v)){return"sap/ui/fl/apply/_internal/extensionPoint/Processor";}if(sap.ui.getCore().getConfiguration().getDesignMode()){return"sap/ui/fl/write/_internal/extensionPoint/Processor";}return undefined;}
function m(){E.registerExtensionProvider(l);}
function n(){e.registerDefaultDelegate({modelType:"sap.ui.model.odata.v4.ODataModel",delegate:"sap/ui/fl/write/_internal/delegates/ODataV4ReadDelegate",delegateType:D.types.READONLY});}
R.registerAll=function(){j();f();g();h();_();i();k();m();n();};
return R;},true);
sap.ui.predefine('sap/ui/fl/Utils',["sap/ui/thirdparty/jquery","sap/ui/core/Component","sap/ui/core/util/reflection/BaseTreeModifier","sap/ui/thirdparty/hasher","sap/base/Log","sap/base/util/UriParameters","sap/base/util/uid","sap/base/strings/formatMessage","sap/ui/base/ManagedObject","sap/ui/core/mvc/View","sap/base/util/isPlainObject","sap/ui/base/SyncPromise"],function(q,C,B,h,L,U,u,f,M,V,a,S){"use strict";
function b(s){if(s.length>0&&s.indexOf(".Component")<0){s+=".Component";}return s;}
var c={APP_ID_AT_DESIGN_TIME:"${pro"+"ject.art"+"ifactId}",VARIANT_MODEL_NAME:"$FlexVariants",formatAndLogMessage:function(l,m,v,s){var d=m.join(' ');d=f(d,v);L[l](d,s||"");},getXSRFTokenFromControl:function(o){var m;if(!o){return"";}if(o&&typeof o.getModel==="function"){m=o.getModel();return c._getXSRFTokenFromModel(m);}return"";},_getXSRFTokenFromModel:function(m){var H;if(!m){return"";}if(typeof m.getHeaders==="function"){H=m.getHeaders();if(H){return H["x-csrf-token"];}}return"";},getComponentClassName:function(o){var A;if(o){A=this.getAppComponentForControl(o);if(A){var v=this._getComponentStartUpParameter(A,"sap-app-id");if(v){return v;}if(A.getManifestEntry("sap.ui5")&&A.getManifestEntry("sap.ui5").appVariantId){return A.getManifestEntry("sap.ui5").appVariantId;}}}return c.getComponentName(A);},isVariantByStartupParameter:function(o){if(o){var A=this.getAppComponentForControl(o);if(A){return!!this._getComponentStartUpParameter(A,"sap-app-id");}}return false;},getAppComponentClassNameForComponent:function(o){return c.getComponentClassName(o);},getAppDescriptor:function(o){var m=null;var d=null;var e=null;if(o){d=this.getAppComponentForControl(o);if(d&&d.getMetadata){e=d.getMetadata();if(e&&e.getManifest){m=e.getManifest();}}}return m;},getSiteId:function(o){var s=null;var A=null;if(o){A=this.getAppComponentForControl(o);if(A){s=this._getComponentStartUpParameter(A,"hcpApplicationId");}}return s;},getSiteIdByComponentData:function(o){return this._getStartUpParameter(o,"hcpApplicationId");},isBinding:function(p){return((typeof p==="string"&&!!M.bindingParser(p))||(a(p)&&((p.hasOwnProperty("path")||p.hasOwnProperty("parts"))&&!p.hasOwnProperty("ui5object"))));},isApplicationVariant:function(o){var F=c.getComponentClassName(o);var A=c.getAppComponentForControl(o);var s=c.getComponentName(A);return F!==s;},isChangeRelatedToVariants:function(o){return o.getFileType()==="ctrl_variant_change"||o.getFileType()==="ctrl_variant_management_change"||o.getFileType()==="ctrl_variant"||o.getVariantReference();},_getComponentStartUpParameter:function(o,p){var s=null;if(p){if(o&&o.getComponentData){s=this._getStartUpParameter(o.getComponentData(),p);}}return s;},_getStartUpParameter:function(o,p){if(o&&o.startupParameters&&p){if(Array.isArray(o.startupParameters[p])){return o.startupParameters[p][0];}}},getComponentName:function(o){var s="";if(o){s=o.getMetadata().getName();}return b(s);},_getComponent:function(s){var o;if(s){o=C.get(s);}return o;},_getComponentIdForControl:function(o){var s=c._getOwnerIdForControl(o);if(!s){if(o&&typeof o.getParent==="function"){var p=o.getParent();if(p){return c._getComponentIdForControl(p);}}}return s||"";},getComponentForControl:function(o){return c._getComponentForControl(o);},getAppComponentForControl:function(o){var d=o instanceof C?o:this._getComponentForControl(o);return this._getAppComponentForComponent(d);},getAppDescriptorComponentObjectForControl:function(o){var A=this.getAppComponentForControl(o);var m=A.getManifest();return{name:this.getAppIdFromManifest(m)};},_getComponentForControl:function(o){var d=null;var s=null;if(o){s=c._getComponentIdForControl(o);if(s){d=c._getComponent(s);}}return d;},_getAppComponentForComponent:function(o){var s=null;if(o&&o.getAppComponent&&o.getAppComponent()instanceof C){return o.getAppComponent();}if(o&&o.oComponentData&&o.oComponentData.appComponent){return o.oComponentData.appComponent;}if(o&&o.getManifestEntry){s=o.getManifestEntry("sap.app");}else{return o;}if(s&&s.type&&s.type!=="application"){if(o instanceof C){o=this._getComponentForControl(o);}return this.getAppComponentForControl(o);}return o;},getViewForControl:function(o){return c.getFirstAncestorOfControlWithControlType(o,sap.ui.core.mvc.View);},getFirstAncestorOfControlWithControlType:function(o,d){if(o instanceof d){return o;}if(o&&typeof o.getParent==="function"){o=o.getParent();return c.getFirstAncestorOfControlWithControlType(o,d);}},hasControlAncestorWithId:function(s,A){var o;if(s===A){return true;}o=sap.ui.getCore().byId(s);while(o){if(o.getId()===A){return true;}if(typeof o.getParent==="function"){o=o.getParent();}else{return false;}}return false;},_isView:function(o){return o instanceof V;},_getOwnerIdForControl:function(o){return C.getOwnerIdFor(o);},getClient:function(){var o;var s;o=this._getUriParameters();s=o.get("sap-client");return s||undefined;},_getUriParameters:function(){return U.fromQuery(window.location.search);},isHotfixMode:function(){var o;var i;o=this._getUriParameters();i=o.get("hotfix");return(i==="true");},convertBrowserLanguageToISO639_1:function(s){if(!s||typeof s!=="string"){return"";}var n=s.indexOf("-");if((n<0)&&(s.length<=2)){return s.toUpperCase();}if(n>0&&n<=2){return s.substring(0,n).toUpperCase();}return"";},getLrepUrl:function(){var F=sap.ui.getCore().getConfiguration().getFlexibilityServices();var l=F.find(function(s){return s.connector==="LrepConnector";});return l?l.url:"";},getCurrentLanguage:function(){var l=sap.ui.getCore().getConfiguration().getLanguage();return c.convertBrowserLanguageToISO639_1(l);},getControlType:function(o){var m;if(o&&typeof o.getMetadata==="function"){m=o.getMetadata();if(m&&typeof m.getElementName==="function"){return m.getElementName();}}},asciiToString:function(d){var e=d.split(",");var p="";q.each(e,function(i,g){p+=String.fromCharCode(g);});return p;},stringToAscii:function(s){var d="";for(var i=0;i<s.length;i++){d+=s.charCodeAt(i)+",";}d=d.substring(0,d.length-1);return d;},checkControlId:function(v,A){if(!A){v=v instanceof M?v:sap.ui.getCore().byId(v);A=c.getAppComponentForControl(v);}return B.checkControlId(v,A);},hasLocalIdSuffix:B.hasLocalIdSuffix,_getAllUrlParameters:function(){return window.location.search.substring(1);},getTechnicalParametersForComponent:function(o){return o&&o.getComponentData&&o.getComponentData()&&o.getComponentData().technicalParameters;},getParsedURLHash:function(o){if(o){return o.parseShellHash(h.getHash())||{};}return{};},isDebugEnabled:function(){var o=this._getUriParameters();var d=o.get("sap-ui-debug")||"";if(sap.ui.getCore().getConfiguration().getDebug()||d==="true"){return true;}var D=d.split(",");return D.indexOf("sap/ui/fl")!==-1||D.indexOf("sap/ui/fl/")!==-1;},getUrlParameter:function(p){return U.fromQuery(window.location.search).get(p);},getUshellContainer:function(){return sap.ushell&&sap.ushell.Container;},createDefaultFileName:function(n){var F=u().replace(/-/g,"_");if(n){F+='_'+n;}return F;},createNamespace:function(p,F){var s="changes";if(F==="ctrl_variant"){s="variants";}var r=p.reference.replace('.Component','');var n='apps/'+r+"/"+s+"/";return n;},buildLrepRootNamespace:function(s,d,p){var r="apps/";var e=new Error("Error in sap.ui.fl.Utils#buildLrepRootNamespace: ");if(!s){e.message+="for every scenario you need a base ID";throw e;}switch(d){case sap.ui.fl.Scenario.VersionedAppVariant:if(!p){e.message+="in a versioned app variant scenario you additionally need a project ID";throw e;}r+=s+"/appVariants/"+p+"/";break;case sap.ui.fl.Scenario.AppVariant:if(!p){e.message+="in an app variant scenario you additionally need a project ID";throw e;}r+=s+"/appVariants/"+p+"/";break;case sap.ui.fl.Scenario.AdaptationProject:if(!p){e.message+="in a adaptation project scenario you additionally need a project ID";throw e;}r+=s+"/adapt/"+p+"/";break;case sap.ui.fl.Scenario.FioriElementsFromScratch:case sap.ui.fl.Scenario.UiAdaptation:default:r+=s+"/";}return r;},_getComponentTypeFromManifest:function(m){return m&&m.getEntry&&m.getEntry("sap.app")&&m.getEntry("sap.app").type;},_getComponentTypeFromRawManifest:function(m){return m&&m["sap.app"]&&m["sap.app"].type;},isApplication:function(m,i){var s=i?c._getComponentTypeFromRawManifest(m):c._getComponentTypeFromManifest(m);return s==="application";},isApplicationComponent:function(o){return o instanceof C&&c.isApplication(o.getManifestObject());},isEmbeddedComponent:function(o){return o instanceof C&&c._getComponentTypeFromManifest(o.getManifestObject())==="component";},getFlexReference:function(m){if(m){if(m.getEntry("sap.ui5")){if(m.getEntry("sap.ui5").appVariantId){return m.getEntry("sap.ui5").appVariantId;}if(m.getEntry("sap.ui5").componentName){return b(m.getEntry("sap.ui5").componentName);}}if(m.getEntry("sap.app")&&m.getEntry("sap.app").id){return b(c.getAppIdFromManifest(m));}}L.warning("No Manifest received.");return"";},getAppIdFromManifest:function(m){if(m){var s=(m.getEntry)?m.getEntry("sap.app"):m["sap.app"];var A=s&&s.id;if(A===c.APP_ID_AT_DESIGN_TIME&&m.getComponentName){A=m.getComponentName();}return A;}throw new Error("No Manifest received, descriptor changes are not possible");},getODataServiceUriFromManifest:function(m){var s="";if(m){var o=(m.getEntry)?m.getEntry("sap.app"):m["sap.app"];if(o&&o.dataSources&&o.dataSources.mainService&&o.dataSources.mainService.uri){s=o.dataSources.mainService.uri;}}else{L.warning("No Manifest received.");}return s;},indexOfObject:function(A,o){var O=-1;A.some(function(d,i){var k;var K;if(!d){k=[];}else{k=Object.keys(d);}if(!o){K=[];}else{K=Object.keys(o);}var s=k.length===K.length;var e=s&&!k.some(function(g){return d[g]!==o[g];});if(e){O=i;}return e;});return O;},execPromiseQueueSequentially:function(p,t,A){if(p.length===0){if(A){return Promise.resolve();}return new c.FakePromise();}var P=p.shift();if(typeof P==="function"){try{var r=P();}catch(e){r=Promise.reject(e);}return r.then(function(){if(!A&&r instanceof Promise){A=true;}}).catch(function(e){var E="Error during execPromiseQueueSequentially processing occured";E+=e?": "+e.message:"";L.error(E);if(t){throw new Error(E);}}).then(function(){return this.execPromiseQueueSequentially(p,t,A);}.bind(this));}L.error("Changes could not be applied, promise not wrapped inside function.");return this.execPromiseQueueSequentially(p,t,A);},FakePromise:function(i,e,I){c.FakePromise.fakePromiseIdentifier="sap.ui.fl.Utils.FakePromise";this.vValue=i;this.vError=e;this.bContinueWithFakePromise=arguments.length<3||(I===c.FakePromise.fakePromiseIdentifier);var r=function(p,d){try{var R=d(p,c.FakePromise.fakePromiseIdentifier);if(S.isThenable(R)){return R;}return new c.FakePromise(R);}catch(E){var v=E;return new c.FakePromise(undefined,v);}};c.FakePromise.prototype.then=function(s,E){if(!this.bContinueWithFakePromise){return Promise.resolve(s(this.vValue));}if(!this.vError){return r(this.vValue,s);}else if(E){return r(this.vError,E);}return this;};c.FakePromise.prototype.catch=function(d){if(!this.bContinueWithFakePromise){return Promise.reject(d(this.vError));}if(this.vError){return r(this.vError,d);}return this;};if(this.vValue instanceof Promise||this.vValue instanceof c.FakePromise){return this.vValue;}},getChangeFromChangesMap:function(m,s){var r;Object.keys(m).forEach(function(d){m[d].some(function(o){if(o.getId()===s){r=o;return true;}});});return r;},requireAsync:function(m){var o=sap.ui.require(m);if(o){return Promise.resolve(o);}return new Promise(function(r,R){sap.ui.require([m],function(o){r(o);},function(e){R(e);});});},normalizeReference:function(r){return r.replace(/(.Component)$/g,"");},handleUrlParameters:function(p,P,s,o){if(this.hasParameterAndValue(P,s,o)){if(p.startsWith("?")){p=p.substr(1,p.length);}var F=p.split("&").filter(function(d){return d!==P+"="+s;});p="";if(F.length>0){p="?"+F.toString();}}else{p+=(p.length>0?'&':'?')+P+"="+s;}return p;},hasParameterAndValue:function(p,P,o){return this.getParameter(p,o)===P;},getParameter:function(p,o){if(o){var P=c.getParsedURLHash(o);return P.params&&P.params[p]&&P.params[p][0];}var d=U.fromQuery(document.location.search);if(!d){return false;}return d.get(p);},findAggregation:function(o,A){if(o){if(o.getMetadata){var m=o.getMetadata();var d=m.getAllAggregations();if(d){return d[A];}}}return undefined;},getAggregation:function(p,A){var o=c.findAggregation(p,A);if(o){return p[o._sGetter]();}return undefined;},getProperty:function(o,p){var m=o.getMetadata().getPropertyLikeSetting(p);if(m){var P=m._sGetter;return o[P]();}return undefined;},getUShellService:function(s){if(s){var o=this.getUshellContainer();if(o){return o.getServiceAsync(s);}}return Promise.resolve();},getUShellServices:function(s){var d=s.map(function(e){return this.getUShellService(e);}.bind(this));return Promise.all(d).then(function(e){return s.reduce(function(m,g,i){m[g]=e&&e[i];return m;},{});});}};return c;},true);
sap.ui.predefine('sap/ui/fl/Variant',["sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/registry/Settings","sap/base/util/merge","sap/base/Log"],function(q,M,L,U,a,S,m,b){"use strict";
var V=M.extend("sap.ui.fl.Variant",{
constructor:function(f){M.apply(this);if(!q.isPlainObject(f)){b.error("Constructor : sap.ui.fl.Variant : oFile is not defined");}this._oDefinition=f;this._oOriginDefinition=m({},f);this._sRequest='';this._bUserDependent=(f.content.layer===L.USER);this._vRevertData=null;this.setState(V.states.NEW);},
metadata:{properties:{state:{type:"string"}}}
});
V.states={NEW:"NEW",PERSISTED:"NONE",DELETED:"DELETE",DIRTY:"UPDATE"};V.events={markForDeletion:"markForDeletion"};
V.prototype.setState=function(s){if(this._isValidState(s)){this.setProperty("state",s);}return this;};
V.prototype._isValidState=function(s){var c=false;Object.keys(V.states).some(function(k){if(V.states[k]===s){c=true;}return c;});if(!c){return false;}if((this.getState()===V.states.NEW)&&(s===V.states.DIRTY)){return false;}return true;};
V.prototype.isValid=function(){var i=true;if(typeof(this._oDefinition)!=="object"){i=false;}if(!this._oDefinition.content.fileType||this._oDefinition.content.fileType!=="ctrl_variant"){i=false;}if(!this._oDefinition.content.fileName){i=false;}if(!this._oDefinition.content.content.title){i=false;}if(!this._oDefinition.content.variantManagementReference){i=false;}if(!this._oDefinition.content.layer){i=false;}if(!this._oDefinition.content.originalLanguage){i=false;}return i;};
V.prototype.isVariant=function(){return true;};
V.prototype.getDefinitionWithChanges=function(){return this._oDefinition;};
V.prototype.getTitle=function(){if(this._oDefinition){return this._oDefinition.content.content.title;}};
V.prototype.getFileType=function(){if(this._oDefinition){return this._oDefinition.content.fileType;}};
V.prototype.getControlChanges=function(){return this._oDefinition.controlChanges;};
V.prototype.getOriginalLanguage=function(){if(this._oDefinition&&this._oDefinition.content.originalLanguage){return this._oDefinition.content.originalLanguage;}return"";};
V.prototype.getPackage=function(){return this._oDefinition.content.packageName;};
V.prototype.getNamespace=function(){return this._oDefinition.content.namespace;};
V.prototype.setNamespace=function(n){this._oDefinition.content.namespace=n;};
V.prototype.getId=function(){return this._oDefinition.content.fileName;};
V.prototype.getContent=function(){return this._oDefinition.content.content;};
V.prototype.setContent=function(c){this._oDefinition.content.content=c;this.setState(V.states.DIRTY);};
V.prototype.getVariantManagementReference=function(){return this._oDefinition.content.variantManagementReference;};
V.prototype.getVariantReference=function(){return this._oDefinition.content.variantReference;};
V.prototype.getOwnerId=function(){return this._oDefinition.content.support?this._oDefinition.content.support.user:"";};
V.prototype.getText=function(t){if(typeof(t)!=="string"){b.error("sap.ui.fl.Variant.getTexts : sTextId is not defined");}if(this._oDefinition.content.texts){if(this._oDefinition.content.texts[t]){return this._oDefinition.content.texts[t].value;}}return"";};
V.prototype.setText=function(t,n){if(typeof(t)!=="string"){b.error("sap.ui.fl.Variant.setTexts : sTextId is not defined");return;}if(this._oDefinition.content.texts){if(this._oDefinition.content.texts[t]){this._oDefinition.content.texts[t].value=n;this.setState(V.states.DIRTY);}}};
V.prototype.isReadOnly=function(){return this._isReadOnlyDueToLayer()||this._isReadOnlyWhenNotKeyUser();};
V.prototype._isReadOnlyWhenNotKeyUser=function(){if(this.isUserDependent()){return false;}var r=this.getDefinition().reference;if(!r){return true;}var s=S.getInstanceOrUndef();if(!s){return true;}return!s.isKeyUser();};
V.prototype._isReadOnlyDueToLayer=function(){var c;c=this._bUserDependent?L.USER:a.getCurrentLayer();return(this._oDefinition.content.layer!==c);};
V.prototype._isReadOnlyDueToOriginalLanguage=function(){var c;var o;o=this.getOriginalLanguage();if(!o){return false;}c=U.getCurrentLanguage();return(c!==o);};
V.prototype.markForDeletion=function(){this.setState(V.states.DELETED);};
V.prototype.setRequest=function(r){if(typeof(r)!=="string"){b.error("sap.ui.fl.Variant.setRequest : sRequest is not defined");}this._sRequest=r;};
V.prototype.getRequest=function(){return this._sRequest;};
V.prototype.getLayer=function(){return this._oDefinition.content.layer;};
V.prototype.getComponent=function(){return this._oDefinition.content.reference;};
V.prototype.setComponent=function(c){this._oDefinition.content.reference=c;};
V.prototype.getCreation=function(){return this._oDefinition.content.creation;};
V.prototype.isUserDependent=function(){return(this._bUserDependent);};
V.prototype.getDefinition=function(){return this._oDefinition.content;};
V.prototype.setResponse=function(r){var R=JSON.stringify(r);if(R){this._oDefinition=JSON.parse(R);this._oOriginDefinition=JSON.parse(R);this.setState(V.states.PERSISTED);}};
V.prototype.getFullFileIdentifier=function(){var l=this.getLayer();var n=this.getNamespace();var f=this.getDefinition().content.fileName;var F=this.getDefinition().content.fileType;return l+"/"+n+"/"+f+"."+F;};
V.prototype.getRevertData=function(){return this._vRevertData;};
V.prototype.setRevertData=function(d){this._vRevertData=d;};
V.prototype.resetRevertData=function(){this.setRevertData(null);};
V.createInitialFileContent=function(p){if(!p){p={};}var f=p.content.fileName||U.createDefaultFileName();var n=p.content.namespace||U.createNamespace(p.content,"ctrl_variant");var N={content:{fileName:f,fileType:"ctrl_variant",variantManagementReference:p.content.variantManagementReference,variantReference:p.content.variantReference||"",reference:p.content.reference||"",packageName:p.content.packageName||"",content:{title:p.content.content.title||""},self:n+f+"."+"ctrl_variant",layer:p.content.layer||(p.isUserDependent?L.USER:a.getCurrentLayer()),texts:p.content.texts||{},namespace:n,creation:"",originalLanguage:U.getCurrentLanguage(),conditions:{},contexts:p.content.contexts||{},support:{generator:p.generator||"Change.createInitialFileContent",service:p.service||"",user:"",sapui5Version:sap.ui.version}},controlChanges:p.controlChanges||[],variantChanges:{}};return N;};
return V;},true);
sap.ui.predefine('sap/ui/fl/XmlPreprocessorImpl',["sap/ui/core/Component","sap/ui/fl/FlexControllerFactory","sap/ui/fl/Utils","sap/ui/fl/ChangePersistenceFactory","sap/base/Log"],function(C,F,U,a,L){"use strict";var X=function(){};
X.process=function(v,p){try{if(!p||p.sync){L.warning("Flexibility feature for applying changes on an XML view is only available for "+"asynchronous views; merge is be done later on the JS controls.");return(v);}p.viewId=p.id;var c=C.get(p.componentId);if(!c){L.warning("View is generated without a component. Flexibility features are not possible.");return Promise.resolve(v);}var A=U.getAppComponentForControl(c);if(!U.isApplication(A.getManifestObject())){return Promise.resolve(v);}var f=U.getComponentClassName(A);var o=F.create(f);return o.processXmlView(v,p).then(function(){L.debug("flex processing view "+p.id+" finished");return v;}).catch(function(){L.warning("Error happens when getting flex cache key! flexibility XML view preprocessing is skipped. "+"The processing will be done later on the JS controls.");return Promise.resolve(v);});}catch(e){var E="view "+p.id+": "+e;L.info(E);return Promise.resolve(v);}};
X.getCacheKey=function(p){var c=C.get(p.componentId);var A=U.getAppComponentForControl(c);if(U.isVariantByStartupParameter(A)){return Promise.resolve();}var f=U.getComponentClassName(A);var o=a.getChangePersistenceForComponent(f);return o.getCacheKey(A);};
return X;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/DelegateMediator',["sap/base/Log","sap/base/util/merge","sap/base/util/restricted/_pick","sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier"],function(L,m,_,f,J){"use strict";var D={};D._mDefaultDelegateItems={};D.types={READONLY:"readonly",WRITEONLY:"writeonly",COMPLETE:"complete"};
function g(C,M){if(M){return M;}if(C.getModel){var i=C.getModel();if(!i){return undefined;}return i.getMetadata().getName();}}
function a(C,M){M=g(C,M);var i=D._mDefaultDelegateItems[M];return(i||[]).map(function(r){r.payload={};return r;});}
function l(M,C,i){if(!i.length){return Promise.resolve([]);}var P=[];i.forEach(function(r){P.push(function(s){return f.requireAsync(r.name).then(function(t){r.instance=t||{};s.push(r);return s;}).catch(function(E){L.error("Failed to load the delegate for the control "+M.getId(C)+"\n"+E.message);return s;});});});return P.reduce(function(r,s){return r.then(s);},Promise.resolve([]));}
function b(i){return i&&typeof i==="function";}
function c(i){return i.delegateType===D.types.COMPLETE||(b(i.instance.getPropertyInfo)&&(b(i.instance.createLabel)||b(i.instance.createLayout)));}
function d(i){return i.delegateType===D.types.READONLY||b(i.instance.getPropertyInfo);}
function e(i){return i.delegateType===D.types.WRITEONLY||b(i.instance.createLabel)||b(i.instance.createLayout);}
function h(t,i){t.names.push(i.name);if(i.requiredLibraries){t.requiredLibraries=Object.assign(t.requiredLibraries||{},i.requiredLibraries);}if(i.payload&&!t.payload){t.payload=i.payload;}return t;}
function j(t,i){t=h(t,i);return m(t,{instance:_(i.instance,["getPropertyInfo","getRepresentedProperties"])});}
function k(t,i){t=h(t,i);return m(t,{instance:_(i.instance,["createLabel","createControlForProperty","createLayout"])});}
function n(t,i){t=h(t,i);return m(t,_(i,"instance"));}
function o(r){var R={names:[],instance:{},modelType:r.length&&r[0].modelType};var s=true;var w=true;for(var i=(r.length-1);i>=0;i--){var t=r[i];if(c(t)){if(s&&w){R=n(R,t);}else if(s){R=j(R,t);}else if(w){R=k(R,t);}break;}else if(d(t)&&s){R=j(R,t);s=false;}else if(e(t)&&w){R=k(R,t);w=false;}}return r.length?R:undefined;}
function v(C,M){return new Promise(function(r,i){if(!C){i(new Error("The control parameter is missing"));}if(!M){i(new Error("The modifier parameter is missing"));}if(!C){i(new Error("The input control should be available"));}if(M===J&&(!C.isA||!C.isA("sap.ui.base.ManagedObject"))){i(new Error("The input control should be a managed object"));}r();});}
function p(P){return Object.values(D.types).some(function(s){return s===P.delegateType;});}
function q(P){var i=D._mDefaultDelegateItems[P.modelType]||[];var r=i.map(function(s){return s.delegateType;});return r.indexOf(D.types.COMPLETE)>-1||r.indexOf(P.delegateType)>-1||(P.delegateType===D.types.COMPLETE&&r.length);}
D.getKnownDefaultDelegateLibraries=function(){return["sap.ui.comp"];};
D.getRequiredLibrariesForDefaultDelegate=function(i,C,M){M=g(C,M);var r=D._mDefaultDelegateItems[M]||[];return r.reduce(function(R,s){var I=i.indexOf(s.name)>-1;return R.concat(Object.keys((I&&s.requiredLibraries)||{}));},[]);};
D.isDelegateRegistered=function(M){return!!D._mDefaultDelegateItems[M];};
D.registerDefaultDelegate=function(P){if(!(P.modelType&&P.delegate)){throw new Error("'modelType' and 'delegate' properties are required for registration!");}P.delegateType=P.delegateType||D.types.COMPLETE;if(P.delegateType&&!p(P)){throw new Error("default 'delegateType': "+P.delegateType+" is invalid!");}if(q(P)){throw new Error("modelType "+P.modelType+"is already defined!");}if(!D._mDefaultDelegateItems[P.modelType]){D._mDefaultDelegateItems[P.modelType]=[];}D._mDefaultDelegateItems[P.modelType].push({name:P.delegate,requiredLibraries:P.requiredLibraries,delegateType:P.delegateType,modelType:P.modelType});};
D.getDelegateForControl=function(C,M,s,S){return v(C,M).then(function(){return M.getFlexDelegate(C);}).then(function(i){var r=(S&&a(C,s))||[];if(i){r.push(i);}return l(M,C,r);}).then(o.bind(this));};
D.clear=function(){D._mDefaultDelegateItems={};};
return D;},false);
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/FlexCustomData',["sap/ui/fl/Utils","sap/base/Log","sap/ui/core/CustomData"],function(F,L){"use strict";var a={};a.sync={};a.appliedChangesCustomDataKey="sap.ui.fl.appliedChanges";a.failedChangesCustomDataKeyJs="sap.ui.fl.failedChanges.js";a.failedChangesCustomDataKeyXml="sap.ui.fl.failedChanges.xml";a.notApplicableChangesCustomDataKey="sap.ui.fl.notApplicableChanges";
a.sync.getAppliedCustomDataValue=function(C,o){var m=b(C,a._getCustomDataKey(o,a.appliedChangesCustomDataKey));return m.customDataValue;};
a.getAppliedCustomDataValue=function(C,o,m){return c(C,m,a._getCustomDataKey(o,a.appliedChangesCustomDataKey)).then(function(d){return d.customDataValue;});};
a.sync.getParsedRevertDataFromCustomData=function(C,o){var s=a.sync.getAppliedCustomDataValue(C,o);try{return s&&JSON.parse(s);}catch(e){L.error("Could not parse revert data from custom data",s);return undefined;}};
a.getParsedRevertDataFromCustomData=function(C,o,m){return a.getAppliedCustomDataValue(C,o,m).then(function(s){return s&&JSON.parse(s);});};
a.sync.hasChangeApplyFinishedCustomData=function(C,o){var d=F.getAggregation(C,"customData")||[];var e=[a._getCustomDataKey(o,a.appliedChangesCustomDataKey),a._getCustomDataKey(o,a.failedChangesCustomDataKeyJs),a._getCustomDataKey(o,a.notApplicableChangesCustomDataKey)];return d.some(function(f){var k=F.getProperty(f,"key");if(e.indexOf(k)>-1){return!!F.getProperty(f,"value");}return false;});};
a.hasChangeApplyFinishedCustomData=function(C,o,m){return Promise.resolve().then(m.getAggregation.bind(m,C,"customData")).then(function(d){d=d||[];var e=[a._getCustomDataKey(o,a.appliedChangesCustomDataKey),a._getCustomDataKey(o,a.failedChangesCustomDataKeyJs),a._getCustomDataKey(o,a.notApplicableChangesCustomDataKey)];return Promise.all(d.map(function(f){return Promise.resolve().then(m.getProperty.bind(m,f,"key")).then(function(k){if(e.indexOf(k)>-1){return m.getProperty(f,"value");}return undefined;}).then(function(v){return!!v;});})).then(function(v){return v.includes(true);});});};
function g(s,C){var r=C.getRevertData();if(s&&r!==undefined){return JSON.stringify(r);}return"true";}
a.addAppliedCustomData=function(C,o,p,s){var d=g(s,o);var e=a._getCustomDataKey(o,a.appliedChangesCustomDataKey);return w(C,e,d,p);};
a.addFailedCustomData=function(C,o,p,i){var s=a._getCustomDataKey(o,i);return w(C,s,"true",p);};
a.sync.destroyAppliedCustomData=function(C,o,m){var k=a._getCustomDataKey(o,a.appliedChangesCustomDataKey);var d=b(C,k);if(d.customData){m.destroy(d.customData);}};
a.destroyAppliedCustomData=function(C,o,m){var k=a._getCustomDataKey(o,a.appliedChangesCustomDataKey);return c(C,m,k).then(function(d){if(d.customData){m.destroy(d.customData);}});};
a.getCustomDataIdentifier=function(s,e,x){if(s){return a.appliedChangesCustomDataKey;}if(!e){return a.notApplicableChangesCustomDataKey;}if(x){return a.failedChangesCustomDataKeyXml;}return a.failedChangesCustomDataKeyJs;};
a._getCustomDataKey=function(C,i){return i+"."+C.getId();};
function w(C,k,v,p){return c(C,p.modifier,k).then(function(m){if(!m.customData){return p.modifier.createAndAddCustomData(C,k,v,p.appComponent);}return p.modifier.setProperty(m.customData,"value",v);});}
function b(C,s){var d=F.getAggregation(C,"customData")||[];var r={};d.some(function(o){var k=F.getProperty(o,"key");if(k===s){r.customData=o;r.customDataValue=F.getProperty(o,"value");return true;}return false;});return r;}
function c(C,m,s){return Promise.resolve().then(m.getAggregation.bind(m,C,"customData")).then(function(d){d=d||[];var r={};return d.reduce(function(p,o){return p.then(m.getProperty.bind(m,o,"key")).then(function(k){if(k===s){r.customData=o;return m.getProperty(o,"value");}return undefined;}).then(function(e){if(e){r.customDataValue=e;}});},Promise.resolve()).then(function(){return r;});});}
return a;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/descriptor/Applier',["sap/ui/fl/Change"],function(C){"use strict";var a="$sap.ui.fl.changes";
function g(m){var b=m&&m.getEntry&&m.getEntry(a)&&m.getEntry(a).descriptor||[];return b.map(function(c){return new C(c);});}
var A={applyChanges:function(u,b,s){return s.registry().then(function(R){var c=b.map(function(o){return R[o.getChangeType()]&&R[o.getChangeType()]();});return Promise.all(c);}).then(function(c){c.forEach(function(o,i){try{var d=b[i];u=o.applyChange(u,d);if(!o.skipPostprocessing&&d.getTexts()){u=s.processTexts(u,d.getTexts());}}catch(e){s.handleError(e);}});return u;});},applyChangesIncludedInManifest:function(m,s){var d=g(m);var M=m.getJson();delete M[a];if(d.length>0){return this.applyChanges(M,d,s).then(function(){return;});}return Promise.resolve();}};return A;});
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory',["sap/ui/fl/requireAsync","sap/base/Log"],function(r,L){"use strict";var R={registry:function(){return r("sap/ui/fl/apply/_internal/changes/descriptor/Registration");},handleError:function(e){L.error(e);},processTexts:function(m,c){var M=JSON.stringify(m);Object.keys(c).forEach(function(t){if(c[t].value[""]){M=M.replace("{{"+t+"}}",c[t].value[""]);}else{L.error("Text change has to contain default language");}});return JSON.parse(M);}};var A={getRuntimeStrategy:function(){return R;}};return A;});
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/descriptor/Preprocessor',["sap/ui/fl/apply/_internal/changes/descriptor/Applier","sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/performance/Measurement","sap/ui/fl/Utils"],function(A,a,F,M,b,U){"use strict";var P={preprocessManifest:function(m,c){if(!U.isApplication(m,true)||!c.id){return Promise.resolve(m);}b.start("flexStateInitialize","Initialization of flex state",["sap.ui.fl"]);var C=c.componentData||{};var r=M.getFlexReference({manifest:m,componentData:C});if(!M.getChangeManifestFromAsyncHints(c.asyncHints)){F.initialize({componentData:C,asyncHints:c.asyncHints,rawManifest:m,componentId:c.id,reference:r,partialFlexState:true}).then(b.end.bind(undefined,"flexStateInitialize"));return Promise.resolve(m);}return F.initialize({componentData:C,asyncHints:c.asyncHints,rawManifest:m,componentId:c.id,reference:r,partialFlexState:true}).then(function(){b.end("flexStateInitialize");b.start("flexAppDescriptorMerger","Client side app descriptor merger",["sap.ui.fl"]);var u=Object.assign({},m);var d=F.getAppDescriptorChanges(r);return A.applyChanges(u,d,a.getRuntimeStrategy());}).then(function(m){b.end("flexAppDescriptorMerger");return m;});}};return P;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexObjects/CompVariant',["sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(_,S,C,L,a,b,U){"use strict";
function i(A){var s=a.getInstanceOrUndef();var u=s&&s.getUserId();return!u||u.toUpperCase()===A.toUpperCase();}
function c(l,A,u,g){if(A){return g||l===A;}else if(l===L.USER){return true;}var s=a.getInstanceOrUndef();if(b.isSapUiLayerParameterProvided()){A=b.getCurrentLayer();}else if(!A){A=s.isPublicLayerAvailable()?L.PUBLIC:L.CUSTOMER;}var h=l===A;var j=s.isKeyUser()||i(u);return h&&j;}
function d(o){return!o||U.getCurrentLanguage()===o;}
function e(s,g){var o=a.getInstanceOrUndef();if(!o){return true;}if(!s||!g){return true;}var h=o.getSystem();var j=o.getClient();return h===s&&g===j;}
var f=C.extend("sap.ui.fl.apply._internal.flexObjects.Variant",{
metadata:{properties:{favorite:{type:"boolean",defaultValue:false},executeOnSelection:{type:"boolean",defaultValue:false},standardVariant:{type:"boolean",defaultValue:false},contexts:{type:"object",defaultValue:{}},persisted:{type:"boolean",defaultValue:true},name:{type:"string",defaultValue:""},content:{type:"object",defaultValue:{}}},aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.CompVariantRevertData",multiple:true,singularName:"revertInfo",defaultValue:[]},changes:{type:"sap.ui.fl.Change",multiple:true,defaultValue:[]}}},
constructor:function(F){C.apply(this,arguments);var E=F.content&&(F.content.executeOnSelect||F.content.executeOnSelection);if(F.executeOnSelection!==undefined){E=F.executeOnSelection;}this.setExecuteOnSelection(E);this.setContexts(F.contexts||{});this.setContent(F.content||{});this.setName(this.getText("variantName"));if(F.layer===L.VENDOR||F.layer===L.CUSTOMER_BASE){this.setFavorite(true);}if(F.favorite!==undefined){this.setFavorite(!!F.favorite);}if(F.persisted!==undefined){this.setPersisted(!!F.persisted);}}
});
f.STANDARD_VARIANT_ID="*standard*";
f.prototype.isRenameEnabled=function(l){return this.isEditEnabled(l)&&d(this.getOriginalLanguage())&&!this.getStandardVariant();};
f.prototype.isEditEnabled=function(A){return e(this.getSourceSystem(),this.getSourceClient())&&c(this.getLayer(),A,this.getOwnerId(),true)&&(A&&b.isDeveloperLayer(A)||!this.getStandardVariant());};
f.prototype.isDeleteEnabled=function(l){return e(this.getSourceSystem(),this.getSourceClient())&&c(this.getLayer(),l,this.getOwnerId())&&!this.getStandardVariant();};
f.prototype.storeFavorite=function(F){if(F!==undefined){this._oDefinition.favorite=F;}else{delete this._oDefinition.favorite;}this.setState(S.DIRTY);this.setFavorite(F);};
f.prototype.setContent=function(o){this.setProperty("content",o||{});};
f.prototype.getContent=function(){return this.getProperty("content");};
f.prototype.storeContent=function(o){this._oDefinition.content=o||{};this.setState(S.DIRTY);this.setContent(o);};
f.prototype.storeExecuteOnSelection=function(E){if(E!==undefined){this._oDefinition.executeOnSelection=E;}else{delete this._oDefinition.executeOnSelection;}delete this._oDefinition.content.executeOnSelection;this.setState(S.DIRTY);this.setExecuteOnSelection(E);};
f.prototype.storeName=function(n){this._oDefinition.texts.variantName.value=n;this.setState(S.DIRTY);this.setName(n);};
f.prototype.storeContexts=function(m){if(m!==undefined){this._oDefinition.contexts=m;}else{delete this._oDefinition.contexts;}this.setContexts(m);this.setState(S.DIRTY);};
f.createInitialFileContent=function(p){var n=C.createInitialFileContent(p);if(p.contexts){n.contexts=p.contexts;}if(p.favorite!==undefined){n.favorite=p.favorite;}if(p.executeOnSelection!==undefined){n.executeOnSelection=p.executeOnSelection;}return _(n,["changeType","namespace","service","content","reference","fileName","fileType","packageName","layer","favorite","executeOnSelection","selector","texts","support","contexts"]);};
return f;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexObjects/States',[],function(){"use strict";return{NEW:"NEW",PERSISTED:"NONE",DELETED:"DELETE",DIRTY:"UPDATE"};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexObjects/UpdatableChange',["sap/ui/fl/Change"],function(C){"use strict";
var U=C.extend("sap.ui.fl.apply._internal.flexObjects.UpdatableChange",{metadata:{aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.RevertData",multiple:true,singularName:"revertInfo",defaultValue:[]}}}});
U.prototype.popLatestRevertInfo=function(){var l=this.getRevertInfo().pop();this.removeRevertInfo(l);return l;};
return U;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/ManifestUtils',["sap/ui/fl/Utils"],function(U){"use strict";
function a(c){if(c&&c.indexOf(".Component")<0){c+=".Component";}return c;}
function g(A){if(A&&A.requests&&Array.isArray(A.requests)){return A.requests.find(function(o){return o.name==="sap.ui.fl.changes";});}}
var M={getFlexReferenceForControl:function(c){var A=U.getAppComponentForControl(c);return M.getFlexReference({manifest:A.getManifest(),componentData:A.getComponentData()});},getFlexReference:function(p){var m=p.manifest;var c=p.componentData||{};if(c.startupParameters){if(Array.isArray(c.startupParameters["sap-app-id"])){return c.startupParameters["sap-app-id"][0];}}var s=m.getEntry?m.getEntry("sap.ui5"):m["sap.ui5"];if(s){if(s.appVariantId){return s.appVariantId;}if(s.componentName){return a(s.componentName);}}return a(U.getAppIdFromManifest(m));},getOvpEntry:function(m){return m.getEntry?m.getEntry("sap.ovp"):m["sap.ovp"];},getCacheKeyFromAsyncHints:function(r,A){var f=g(A);if(f&&f.reference===r){return f.cachebusterToken||"<NO CHANGES>";}},getPreviewSectionFromAsyncHints:function(A){var f=g(A);if(f){return f.preview;}},getChangeManifestFromAsyncHints:function(A){var f=g(A);if(f){return false;}return true;},getBaseComponentNameFromManifest:function(m){var s=m.getEntry?m.getEntry("sap.ui5"):m["sap.ui5"];return s&&s.componentName||U.getAppIdFromManifest(m);},isFlexExtensionPointHandlingEnabled:function(v){var A=U.getAppComponentForControl(v);return!!(A&&A.getManifestEntry("sap.ui5")&&A.getManifestEntry("sap.ui5").flexExtensionPointEnabled);}};return M;});
sap.ui.predefine('sap/ui/fl/changeHandler/AddIFrame',["sap/ui/fl/changeHandler/common/revertAddedControls","sap/ui/fl/changeHandler/common/getTargetAggregationIndex","sap/ui/fl/changeHandler/common/createIFrame"],function(r,g,c){"use strict";var A={};
A.applyChange=function(C,o,p){var m=p.modifier;var a=C.getDefinition();var v=p.view;var s=a.content.targetAggregation;var i;var I;return Promise.resolve().then(m.findAggregation.bind(m,o,s)).then(function(b){if(!b){throw new Error("The given Aggregation is not available in the given control: "+m.getId(o));}return g(C,o,p);}).then(function(R){i=R;return c(C,p,a.content.selector);}).then(function(b){I=b;return m.insertAggregation(o,s,I,i,v);}).then(function(){C.setRevertData([m.getId(I)]);});};
A.revertChange=r;
A.completeChangeContent=function(C,s,p){var o=C.getDefinition();var m=p.modifier;var a=p.appComponent;["targetAggregation","baseId","url"].forEach(function(R){if(!Object.prototype.hasOwnProperty.call(s.content,R)){throw new Error("Attribute missing from the change specific content '"+R+"'");}});o.content=Object.assign(o.content||{},s.content);o.content.selector=m.getSelector(o.content.baseId,a);};
A.getChangeVisualizationInfo=function(C){return{affectedControls:[C.getContent().selector]};};
return A;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/AddXML',["sap/ui/fl/changeHandler/BaseAddXml"],function(B){"use strict";var A={};
A.applyChange=function(c,C,p){var o=c.getDefinition();var m={aggregationName:o.content.targetAggregation,index:o.content.index};return B.applyChange(c,C,p,m);};
A.revertChange=B.revertChange;
A.completeChangeContent=function(c,s){var C=c.getDefinition();if(!C.content){C.content={};}if(s.targetAggregation){C.content.targetAggregation=s.targetAggregation;}else{B._throwMissingAttributeError("targetAggregation");}if(s.index!==undefined){C.content.index=s.index;}else{B._throwMissingAttributeError("index");}B.completeChangeContent(c,s,C);};
return A;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/AddXMLAtExtensionPoint',["sap/ui/fl/changeHandler/BaseAddXml"],function(B){"use strict";var A={};
function c(e){var i=e.index;if(e.referencedExtensionPoint){i+=c(e.referencedExtensionPoint);}return i;}
A.applyChange=function(C,o,p){var v=p.view;var m=p.modifier;var s=C.getDefinition().selector;var e;return Promise.resolve().then(function(){var a=C.getExtensionPointInfo&&C.getExtensionPointInfo();if(!a){return m.getExtensionPointInfo(s.name,v);}return a;}).then(function(r){e=r;if(!e){throw new Error("AddXMLAtExtensionPoint-Error: Either no Extension-Point found by name '"+(s&&s.name)+"' or multiple Extension-Points available with the given name in the view (view.id='"+(v&&m.getId(v))+"'). Multiple Extension-points with the same name in one view are not supported!");}(e.defaultContent||[]).forEach(function(a){if(a){m.destroy(a);}});e.defaultContent=[];e.index=c(e);if(m.targets==="xmlTree"){e.skipAdjustIndex=true;}return B.applyChange(C,o,p,e);}).then(function(n){if(e.ready){e.ready(n);}return true;});};
A.revertChange=B.revertChange;
A.completeChangeContent=function(C,s){B.completeChangeContent(C,s);};
return A;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/Base',["sap/base/util/LoaderExtensions"],function(L){"use strict";var B={setTextInChange:function(c,k,t,T){if(!c.texts){c.texts={};}if(!c.texts[k]){c.texts[k]={};}c.texts[k].value=t;c.texts[k].type=T;},instantiateFragment:function(c,p){var m=c.getModuleName();if(!m){return Promise.reject(new Error("The module name of the fragment is not set. This should happen in the backend"));}var v=p.viewId?p.viewId+"--":"";var P=c.getProjectId()||"";var f=(c.getExtensionPointInfo&&c.getExtensionPointInfo()&&c.getExtensionPointInfo().fragmentId)||"";var s=P&&f?".":"";var i=v+P+s+f;var M=p.modifier;var V=p.view;return Promise.resolve().then(function(){var F=L.loadResource(m,{dataType:"text"});return M.instantiateFragment(F,i,V).catch(function(e){throw new Error("The following XML Fragment could not be instantiated: "+F+" Reason: "+e.message);});});},markAsNotApplicable:function(n,a){var r={message:n};if(!a){throw r;}return Promise.reject(r);}};return B;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/BaseAddViaDelegate',["sap/ui/fl/changeHandler/Base","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/base/util/merge","sap/base/util/ObjectPath"],function(B,D,m,O){"use strict";
function i(f){return typeof f==="function";}
function g(c){if(c.modelType){return c.modelType;}else if(c.oDataServiceVersion){return"sap.ui.model.odata.v2.ODataModel";}}
var a={createAddViaDelegateChangeHandler:function(A){function b(n){return n+A.fieldSuffix;}function c(C,S){if(i(A[S])){return!!A[S]({changeDefinition:C});}return!!A[S];}function s(C){return c(C,"skipCreateLabel");}function d(C){return c(C,"skipCreateLayout");}function f(C,p){var o=p.modifier.bySelector(C.getSelector(),p.appComponent);var M=g(C.getDefinition().content);return D.getDelegateForControl({control:o,modifier:p.modifier,modelType:M,supportsDefault:A.supportsDefault}).then(function(e){var k=!i(e.instance.createLayout);return k||d(C.getDefinition());});}function h(C,e,o){var k=m({},e);k.fieldSelector.id=b(k.fieldSelector.id);return o.createControlForProperty(k).then(function(S){if(s(C)){return S;}var n=e.modifier.getId(S.control);e.labelFor=n;return o.createLabel(e).then(function(l){return{label:l,control:S.control,valueHelp:S.valueHelp};});});}function j(C,e,p){var k=m({aggregationName:A.aggregationName,payload:e.payload||{},parentSelector:C.content.parentId},p);var o=e.instance;return Promise.resolve().then(function(){if(i(o.createLayout)&&!d(C)){return o.createLayout(k);}}).then(function(l){if(O.get("control",l)){l.layoutControl=true;return l;}return h(C,k,o);});}return{applyChange:function(C,o,p){var e=C.getDefinition();var k=p.appComponent;var l=e.content;var F=l.newFieldSelector;var n={appComponent:p.appComponent,view:p.view,fieldSelector:F,bindingPath:l.bindingPath,modifier:p.modifier,element:o};if(p.modifier.bySelector(F,k,p.view)){return B.markAsNotApplicable("Control to be created already exists:"+(F.id||F),true);}var r={newFieldSelector:F};C.setRevertData(r);var M=g(l);return D.getDelegateForControl({control:o,modifier:p.modifier,modelType:M,supportsDefault:A.supportsDefault}).then(function(q){return j(e,q,n);}).then(function(I){var q=m({},{control:o,innerControls:I,change:C},p);return Promise.resolve().then(function(){return A.addProperty(q);}).then(function(){if(I.valueHelp){var v=p.modifier.getSelector(p.modifier.getId(I.valueHelp),k);r.valueHelpSelector=v;}});});},revertChange:function(C,o,p){var e=p.appComponent;var M=p.modifier;var F=C.getRevertData().newFieldSelector;var v=C.getRevertData().valueHelpSelector;var n=M.bySelector(F,e);var P=C.getDependentControl(A.parentAlias,p)||o;return Promise.resolve().then(M.removeAggregation.bind(M,P,A.aggregationName,n)).then(M.destroy.bind(M,n)).then(function(){if(v){var V=M.bySelector(v,e);return Promise.resolve().then(M.removeAggregation.bind(M,P,"dependents",V)).then(M.destroy.bind(M,V));}}).then(function(){var k=m({},{control:o,change:C},p);if(i(A.revertAdditionalControls)){return Promise.resolve().then(function(){return A.revertAdditionalControls(k);}).then(function(){C.resetRevertData();});}});},completeChangeContent:function(C,S,p){var o=p.appComponent;var k=C.getDefinition();if(!k.content){k.content={};}if(S.parentId){if(i(A.mapParentIdIntoChange)){A.mapParentIdIntoChange(C,S,p);}else{C.addDependentControl(S.parentId,A.parentAlias,p);}try{k.content.parentId=p.modifier.getSelector(S.parentId,o);}catch(e){}}else{throw new Error("mSpecificChangeInfo.parentId attribute required");}if(S.bindingPath){k.content.bindingPath=S.bindingPath;}else{throw new Error("mSpecificChangeInfo.bindingPath attribute required");}if(S.newControlId){k.content.newFieldSelector=p.modifier.getSelector(S.newControlId,o);}else{throw new Error("mSpecificChangeInfo.newControlId attribute required");}if(S.index===undefined){throw new Error("mSpecificChangeInfo.targetIndex attribute required");}else{k.content.newFieldIndex=S.index;}if(S.oDataServiceVersion){k.content.oDataServiceVersion=S.oDataServiceVersion;}if(S.modelType&&A.supportsDefault){k.content.modelType=S.modelType;}},getChangeVisualizationInfo:function(C){var r=C.getRevertData();if(r&&r.labelSelector){return{affectedControls:[r.labelSelector]};}return{affectedControls:[C.getContent().newFieldSelector]};},getCondenserInfo:function(C,p){return f(C,p).then(function(e){if(!e){return undefined;}if(!C.getContent().newFieldSelector||!C.getContent().parentId||!A.aggregationName){return undefined;}return{affectedControl:C.getContent().newFieldSelector,classification:sap.ui.fl.condenser.Classification.Create,targetContainer:C.getContent().parentId,targetAggregation:A.aggregationName,setTargetIndex:function(C,n){C.getContent().newFieldIndex=n;},getTargetIndex:function(C){return C.getContent().newFieldIndex;}};});}};}};return a;});
sap.ui.predefine('sap/ui/fl/changeHandler/BaseAddXml',["sap/ui/fl/changeHandler/Base","sap/base/util/LoaderExtensions","sap/ui/fl/changeHandler/common/revertAddedControls","sap/ui/fl/Utils"],function(B,L,r,F){"use strict";var a={};
a.applyChange=function(c,C,p,m){var M=p.modifier;var v=p.view;var A=m.aggregationName;var o;var i=m.index;var R=[];var s=c.getModuleName();var f;var n;var b=function(){var P=[];n.forEach(function(N,I){var d=function(){return Promise.resolve().then(M.insertAggregation.bind(M,C,A,N,i+I,v,m.skipAdjustIndex)).then(function(){R.push({id:M.getId(N),aggregationName:A});});};P.push(d);});return F.execPromiseQueueSequentially(P,true,true).then(function(){c.setRevertData(R);return n;});};return Promise.resolve().then(M.findAggregation.bind(M,C,A)).then(function(d){o=d;if(!o){return Promise.reject(new Error("The given Aggregation is not available in the given control: "+M.getId(C)));}return L.loadResource(s,{dataType:"text"});}).then(function(l){f=l;return B.instantiateFragment(c,p);}).then(function(d){n=d;var P=[];n.forEach(function(N,I){var e=function(){return Promise.resolve().then(M.validateType.bind(M,N,o,C,f,I)).then(function(V){if(!V){a._destroyArrayOfControls(n);return Promise.reject(new Error("The content of the xml fragment does not match the type of the targetAggregation: "+o.type));}});};P.push(e);});return F.execPromiseQueueSequentially(P,true,true).then(b);});};
a.revertChange=r;
a._throwMissingAttributeError=function(A){throw new Error("Attribute missing from the change specific content'"+A+"'");};
a._destroyArrayOfControls=function(c){c.forEach(function(C){if(C.destroy){C.destroy();}});};
a.completeChangeContent=function(c,s,C){if(!C){C=c.getDefinition();if(!C.content){C.content={};}}if(s.fragmentPath){C.content.fragmentPath=s.fragmentPath;}else{a._throwMissingAttributeError("fragmentPath");}var m=C.reference.replace(/\.Component/g,"").replace(/\./g,"/");m+="/changes/";m+=C.content.fragmentPath;c.setModuleName(m);};
return a;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/BaseRename',["sap/ui/fl/changeHandler/Base","sap/base/Log"],function(B,L){"use strict";var a={createRenameChangeHandler:function(r){r.changePropertyName=r.changePropertyName||"newText";return{applyChange:function(c,C,p){var m=p.modifier;var P=r.propertyName;var o=c.getDefinition();var t=o.texts[r.changePropertyName];var v=t.value;return Promise.resolve().then(function(){if(o.texts&&t&&typeof(v)==="string"){return m.getPropertyBindingOrProperty(C,P).then(function(b){c.setRevertData(b);return m.setPropertyBindingOrProperty(C,P,v);});}L.error("Change does not contain sufficient information to be applied: ["+o.layer+"]"+o.namespace+"/"+o.fileName+"."+o.fileType);return undefined;});},revertChange:function(c,C,p){var m=p.modifier;var P=r.propertyName;var o=c.getRevertData();if(o||o===""){m.setPropertyBindingOrProperty(C,P,o);c.resetRevertData();return;}L.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");},completeChangeContent:function(c,s,p){var C=c.getDefinition();var b=r.changePropertyName;var t=r.translationTextType;return Promise.resolve().then(function(){return p.modifier.bySelector(c.getSelector(),p.appComponent);}).then(function(o){C.content.originalControlType=p.modifier.getControlType(o);if(typeof(s.value)==="string"){B.setTextInChange(C,b,s.value,t);}else{return Promise.reject(new Error("oSpecificChangeInfo.value attribute required"));}});},getCondenserInfo:function(c){return{affectedControl:c.getSelector(),classification:sap.ui.fl.condenser.Classification.LastOneWins,uniqueKey:r.propertyName||r.changePropertyName};},getChangeVisualizationInfo:function(c){var n=(c.getDefinition().texts&&c.getDefinition().texts[r.changePropertyName]);return{payload:{originalLabel:c.getRevertData(),newLabel:n&&n.value}};}};}};return a;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/BaseTreeModifier',["sap/ui/core/util/reflection/BaseTreeModifier"],function(B){"use strict";return B;});
sap.ui.predefine('sap/ui/fl/changeHandler/HideControl',["sap/base/Log",'sap/ui/fl/changeHandler/JsControlTreeModifier'],function(L,J){"use strict";var P="visible";var H={};
H.applyChange=function(c,C,p){var m=p.modifier;return Promise.resolve().then(m.getVisible.bind(m,C)).then(function(v){c.setRevertData({originalValue:v});m.setVisible(C,false);});};
H.revertChange=function(c,C,p){var r=c.getRevertData();return Promise.resolve().then(function(){if(r){p.modifier.setVisible(C,r.originalValue);c.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");}});};
H.completeChangeContent=function(){};
H.getCondenserInfo=function(c){return{affectedControl:c.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:P};};
H.getChangeVisualizationInfo=function(c,a){var s=c.getSelector();var e=J.bySelector(s,a);return{affectedControls:[s],displayControls:[e.getParent().getId()]};};
return H;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/JsControlTreeModifier',["sap/ui/core/util/reflection/JsControlTreeModifier"],function(J){"use strict";return J;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/MoveControls',["sap/base/Log","sap/ui/fl/Utils"],function(L,F){"use strict";var M={};M.SOURCE_ALIAS="source";M.TARGET_ALIAS="target";M.MOVED_ELEMENTS_ALIAS="movedElements";
function c(o,m,v,a){if(!o){return Promise.reject(new Error("No change instance"));}var b=o.getContent();if(!b||!b.movedElements||b.movedElements.length===0){return Promise.reject(new Error("Change format invalid"));}if(!b.source||!b.source.selector){return Promise.reject(new Error("No source supplied for move"));}if(!b.target||!b.target.selector){return Promise.reject(new Error("No target supplied for move"));}if(!m.bySelector(b.source.selector,a,v)){return Promise.reject(new Error("Move source parent not found"));}if(!m.bySelector(b.target.selector,a,v)){return Promise.reject(new Error("Move target parent not found"));}if(!b.source.selector.aggregation){return Promise.reject(new Error("No source aggregation supplied for move"));}if(!b.target.selector.aggregation){return Promise.reject(new Error("No target aggregation supplied for move"));}return Promise.resolve();}
function g(m,o,a,v){if(!m.selector&&!m.id){return Promise.reject(new Error("Change format invalid - moveElements element has no id attribute"));}if(typeof m.targetIndex!=="number"){return Promise.reject(new Error("Missing targetIndex for element with id '"+m.selector.id+"' in movedElements supplied"));}return Promise.resolve().then(o.bySelector.bind(o,m.selector||m.id,a,v)).then(function(b){if(!b){return Promise.reject(new Error("Control to move was not found. Id: '"+m.selector.id+"'"));}return b;});}
function C(s){if(!s.movedElements){return Promise.reject(new Error("mSpecificChangeInfo.movedElements attribute required"));}if(s.movedElements.length===0){return Promise.reject(new Error("MovedElements array is empty"));}s.movedElements.forEach(function(e){if(!e.id){throw new Error("MovedControls element has no id attribute");}if(typeof(e.sourceIndex)!=="number"){throw new Error("SourceIndex attribute at MovedElements element is no number");}if(typeof(e.targetIndex)!=="number"){throw new Error("TargetIndex attribute at MovedElements element is no number");}});return Promise.resolve();}
function G(m,s,a){delete s.source.publicAggregation;delete s.target.publicAggregation;var S;var t;return Promise.resolve().then(function(){return s.source.parent||m.bySelector(s.source.id,a);}).then(function(r){S=r;return s.target.parent||m.bySelector(s.target.id,a);}).then(function(r){t=r;var b=s.source.aggregation;var T=s.target.aggregation;var A={aggregation:s.source.aggregation,type:m.getControlType(S)};var d={aggregation:s.target.aggregation,type:m.getControlType(t)};var e={source:{id:S.getId(),aggregation:b,type:A.type,selector:m.getSelector(s.source.id,a,A)},target:{id:t.getId(),aggregation:T,type:d.type,selector:m.getSelector(s.target.id,a,d)},movedElements:s.movedElements};return e;});}
M.applyChange=function(o,r,p){var m=p.modifier;var v=p.view;var a=p.appComponent;var b;var s;var t;var S;var T;var i;var I;var d=false;var e=o.getContent();var R=[];var P=[];return c(o,m,v,a).then(function(){e.movedElements.forEach(function(f){var h=function(){return Promise.resolve().then(g.bind(null,f,m,a,v)).then(function(j){b=j;s=m.getParent(b);return p.sourceAggregation||m.getParentAggregationName(b,s);}).then(function(j){S=j;return m.bySelector(e.target.selector,a,v);}).then(function(j){t=j;T=p.targetAggregation||e.target.selector.aggregation;return m.findIndexInParentAggregation(b);}).then(function(j){i=j;I=f.targetIndex;if(i>-1){if(i===I&&S===T&&m.getParent(b)===t){i=f.sourceIndex;S=p.sourceAggregation||e.source.selector.aggregation;d=true;return m.bySelector(e.source.selector,a,v);}}return Promise.resolve();}).then(function(j){if(j){s=j;}if(i>-1){R.unshift({index:i,aggregation:S,sourceParent:m.getSelector(s,a)});}if(!d){return Promise.resolve().then(m.removeAggregation.bind(m,s,S,b)).then(m.insertAggregation.bind(m,t,T,b,I,v));}return Promise.resolve();});};P.push(h);},this);return F.execPromiseQueueSequentially(P,true,true);}.bind(this)).then(function(){o.setRevertData(R);});};
M.revertChange=function(o,r,p){var m=p.modifier;var v=p.view;var a=p.appComponent;var b=o.getContent();var s;var t;var S;var T;var d;var i;return c(o,m,v,a).then(m.bySelector.bind(m,b.source.selector,a,v)).then(function(R){s=R;S=b.source.selector.aggregation;T=b.target.selector.aggregation;return m.bySelector(b.target.selector,a,v);}).then(function(R){t=R;var e=o.getRevertData();o.getContent().movedElements.reverse();var P=[];b.movedElements.forEach(function(f,E){var h=function(){return Promise.resolve().then(g.bind(this,f,m,a,v)).then(function(j){d=j;if(!d){L.warning("Element to move not found");return Promise.reject();}i=f.sourceIndex;if(e){var k=e[E];S=k.aggregation;i=k.index;return m.bySelector(k.sourceParent,a,v);}return Promise.resolve();}).then(function(j){if(j){s=j;}return m.removeAggregation(t,T,d);}).then(function(){return m.insertAggregation(s,S,d,i,v);});}.bind(this);P.push(h);},this);return F.execPromiseQueueSequentially(P,true,true);}.bind(this)).then(function(){o.resetRevertData();});};
M.completeChangeContent=function(o,s,p){var m=p.modifier;var a=p.appComponent;var b=o.getDefinition();return C(s).then(G.bind(this,m,s,a)).then(function(s){b.content={movedElements:[],source:{selector:s.source.selector},target:{selector:s.target.selector}};var P=[];s.movedElements.forEach(function(e){var d=Promise.resolve().then(function(){return e.element||m.bySelector(e.id,a);}).then(function(E){b.content.movedElements.push({selector:m.getSelector(E,a),sourceIndex:e.sourceIndex,targetIndex:e.targetIndex});o.addDependentControl(s.source.id,M.SOURCE_ALIAS,p);o.addDependentControl(s.target.id,M.TARGET_ALIAS,p);o.addDependentControl(s.movedElements.map(function(f){return f.id;}),M.MOVED_ELEMENTS_ALIAS,p);});P.push(d);});return Promise.all(P);});};
M.getCondenserInfo=function(o){var a=o.getContent();var r=o.getRevertData()[0];return{affectedControl:a.movedElements[0].selector,classification:sap.ui.fl.condenser.Classification.Move,sourceContainer:r.sourceParent,targetContainer:a.target.selector,sourceIndex:r.index,sourceAggregation:r.aggregation,targetAggregation:a.target.selector.aggregation,setTargetIndex:function(o,n){o.getContent().movedElements[0].targetIndex=n;},getTargetIndex:function(o){return o.getContent().movedElements[0].targetIndex;}};};
M.getChangeVisualizationInfo=function(o){var a=o.getContent();return{affectedControls:[a.movedElements[0].selector],dependentControls:[a.source.selector]};};
return M;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/MoveElements',["sap/base/Log","sap/ui/fl/Utils"],function(L,F){"use strict";var M={};M.CHANGE_TYPE="moveElements";
function c(C,m,v,a){if(!C){return Promise.reject(new Error("No change instance"));}var o=C.getContent();if(!o||!o.movedElements||o.movedElements.length===0){return Promise.reject(new Error("Change format invalid"));}if(!C.getSelector().aggregation){return Promise.reject(new Error("No source aggregation supplied via selector for move"));}if(!o.target||!o.target.selector){return Promise.reject(new Error("No target supplied for move"));}if(!m.bySelector(o.target.selector,a,v)){return Promise.reject(new Error("Move target parent not found"));}if(!o.target.selector.aggregation){return Promise.reject(new Error("No target aggregation supplied for move"));}return Promise.resolve();}
function g(m,o,a,v){if(!m.selector&&!m.id){return Promise.reject(new Error("Change format invalid - moveElements element has no id attribute"));}if(typeof m.targetIndex!=="number"){return Promise.reject(new Error("Missing targetIndex for element with id '"+m.selector.id+"' in movedElements supplied"));}return Promise.resolve().then(function(){return o.bySelector(m.selector||m.id,a,v);});}
function h(m,o,a,v,s,t,S,T){var b;return g(m,o,a,v).then(function(r){b=r;if(!b){L.warning("Element to move not found");return Promise.reject();}return Promise.resolve().then(o.removeAggregation.bind(o,s,S,b)).then(o.insertAggregation.bind(o,t,T,b,m.targetIndex,v));});}
M.applyChange=function(C,s,p){var m=p.modifier;var v=p.view;var a=p.appComponent;var o=C.getContent();var S;var t;var T;return c(C,m,v,a).then(function(){S=C.getSelector().aggregation;t=o.target.selector.aggregation;return m.bySelector(o.target.selector,a,v);}).then(function(r){T=r;var P=[];o.movedElements.forEach(function(b){P.push(h.bind(null,b,m,a,v,s,T,S,t));});return F.execPromiseQueueSequentially(P,true,true);});};
M.completeChangeContent=function(){throw new Error('Using deprecated change handler. Please consider using \'MoveControls\' instead');};
M.getSpecificChangeInfo=function(m,s){var S=s.source.parent||m.bySelector(s.source.id);var t=s.target.parent||m.bySelector(s.target.id);var a=s.source.aggregation;var T=s.target.aggregation;var b={source:{id:S.getId(),aggregation:a,type:m.getControlType(S)},target:{id:t.getId(),aggregation:T,type:m.getControlType(t)},movedElements:s.movedElements};return b;};
return M;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/PropertyBindingChange',["sap/base/Log"],function(L){"use strict";var P={};
P.applyChange=function(c,C,p){var d=c.getDefinition();var s=d.content.property;var v=d.content.newBinding;var m=p.modifier;return Promise.resolve().then(m.getPropertyBindingOrProperty.bind(m,C,s)).then(function(o){c.setRevertData({originalValue:o});m.setPropertyBinding(C,s,v);});};
P.revertChange=function(c,C,p){var r=c.getRevertData();if(r){var d=c.getDefinition();var s=d.content.property;var v=r.originalValue;var m=p.modifier;m.setPropertyBindingOrProperty(C,s,v);c.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");}};
P.completeChangeContent=function(c,s){var C=c.getDefinition();if(!s.content){throw new Error("oSpecificChangeInfo attribute required");}C.content=s.content;};
P.getCondenserInfo=function(c){return{affectedControl:c.getSelector(),classification:sap.ui.fl.condenser.Classification.LastOneWins,uniqueKey:c.getContent().property};};
return P;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/PropertyChange',["sap/ui/thirdparty/jquery","sap/ui/fl/Utils","sap/base/Log"],function(q,F,L){"use strict";var P={};
function i(p){return F.isBinding(p)||q.isPlainObject(p);}
function c(C,p,v,m){try{if(i(v)){m.setPropertyBinding(C,p,v);}else{m.setProperty(C,p,v);}}catch(e){throw new Error("Applying property changes failed: "+e);}}
P.applyChange=function(C,o,p){var d=C.getDefinition();var s=d.content.property;var v=d.content.newValue;var m=p.modifier;return Promise.resolve().then(m.getPropertyBindingOrProperty.bind(m,o,s)).then(function(O){C.setRevertData({originalValue:O});c(o,s,v,m);});};
P.revertChange=function(C,o,p){var r=C.getRevertData();if(r){var d=C.getDefinition();var s=d.content.property;var v=r.originalValue;var m=p.modifier;c(o,s,v,m);C.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");}};
P.completeChangeContent=function(C,s){return Promise.resolve().then(function(){var o=C.getDefinition();if(!s.content){throw new Error("oSpecificChangeInfo attribute required");}o.content=s.content;});};
P.getCondenserInfo=function(C){return{affectedControl:C.getSelector(),classification:sap.ui.fl.condenser.Classification.LastOneWins,uniqueKey:C.getContent().property};};
return P;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/StashControl',["sap/ui/fl/LayerUtils"],function(L){"use strict";var S={};
S.applyChange=function(c,C,p){var s;var m=p.modifier;return Promise.resolve().then(m.getStashed.bind(m,C)).then(function(r){s=r;return m.findIndexInParentAggregation(C);}).then(function(o){this.setChangeRevertData(c,s,o);if(L.isDeveloperLayer(c.getLayer())){return m.setStashed(C,true);}return m.setVisible(C,false);}.bind(this));};
function h(u,r,U,m){var a;if(u!==r.originalIndex){var p=m.getParent(U);return Promise.return().then(m.getParentAggregationName.bind(m,U)).then(function(R){a=R;return m.removeAggregation(p,a,U);}).then(m.insertAggregation.bind(m,p,a,U,r.originalIndex));}return Promise.resolve();}
S.revertChange=function(c,C,p){var r=c.getRevertData();var m=p.modifier;return Promise.resolve().then(function(){if(L.isDeveloperLayer(c.getLayer())){var u=m.setStashed(C,r.originalValue,p.appComponent);if(u){return Promise.resolve().then(m.findIndexInParentAggregation.bind(m,u)).then(function(U){return h(U,r,u,m);});}return Promise.resolve();}return m.setVisible(C,!r.originalValue);}).then(function(){c.resetRevertData();});};
S.completeChangeContent=function(){};
S.setChangeRevertData=function(c,v,o){c.setRevertData({originalValue:v,originalIndex:o});};
S.getCondenserInfo=function(c){return{affectedControl:c.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:"stashed"};};
return S;});
sap.ui.predefine('sap/ui/fl/changeHandler/UnhideControl',["sap/base/Log"],function(L){"use strict";var P="visible";var U={};
U.applyChange=function(c,C,p){var m=p.modifier;return Promise.resolve().then(m.getProperty.bind(m,C,P)).then(function(o){c.setRevertData({originalValue:o});p.modifier.setVisible(C,true);});};
U.revertChange=function(c,C,p){var r=c.getRevertData();if(r){p.modifier.setVisible(C,r.originalValue);c.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");}};
U.completeChangeContent=function(){};
U.getCondenserInfo=function(c){return{affectedControl:c.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:P};};
return U;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/UnstashControl',[],function(){"use strict";var U={};
U.applyChange=function(c,C,p){var m=c.getContent();var M=p.modifier;var s=false;var u;return Promise.resolve().then(M.getStashed.bind(M,C)).then(function(P){c.setRevertData({originalValue:P});u=M.setStashed(C,s,p.appComponent)||C;if(m.parentAggregationName){var t=m.parentAggregationName;var T=M.getParent(u);return Promise.resolve().then(M.removeAggregation.bind(M,T,t,u)).then(M.insertAggregation.bind(M,T,t,u,m.index,p.view));}return undefined;}).then(function(){return u;});};
U.revertChange=function(c,C,p){var r=c.getRevertData();p.modifier.setStashed(C,r.originalValue);c.resetRevertData();};
U.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.content){C.content=s.content;}};
U.getCondenserInfo=function(c){return{affectedControl:c.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:"stashed"};};
return U;});
sap.ui.predefine('sap/ui/fl/changeHandler/UpdateIFrame',["sap/base/util/extend"],function(e){"use strict";var U={};var u=["width","height","url","_settings"];
function g(m,i){var s={};var p=[];u.forEach(function(P){var o=Promise.resolve().then(m.getProperty.bind(m,i,P)).then(function(v){if(v!==undefined){s[P]=v;}});p.push(o);});return Promise.all(p).then(function(){return s;});}
function a(m,i,s){var f=e({_settings:s},s);return Promise.resolve().then(m.applySettings.bind(m,i,f));}
U.applyChange=function(c,C,p){var m=p.modifier;var o=c.getDefinition();return m.getControlMetadata(C).then(function(b){if(b.getName()!=="sap.ui.fl.util.IFrame"){return Promise.reject(new Error("UpdateIFrame only for sap.ui.fl.util.IFrame"));}return g(m,C);}).then(function(O){c.setRevertData({originalSettings:O});return a(m,C,o.settings);});};
U.revertChange=function(c,C,p){var r=c.getRevertData();return Promise.resolve().then(function(){if(r){if(r.originalSettings._settings&&r.originalSettings._settings.url){r.originalSettings.url=r.originalSettings._settings.url;}return a(p.modifier,C,r.originalSettings);}return Promise.reject(new Error("Attempt to revert an unapplied change."));}).then(function(){c.resetRevertData();});};
U.completeChangeContent=function(c,s){var C=c.getDefinition();if(!s.content||!Object.keys(s.content).some(function(p){return u.indexOf(p)!==-1;})){throw new Error("oSpecificChangeInfo attribute required");}C.settings=s.content;};
return U;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/XmlTreeModifier',["sap/ui/core/util/reflection/XmlTreeModifier"],function(X){"use strict";return X;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/common/createIFrame',["sap/ui/fl/util/IFrame"],function(){"use strict";return function(c,p,s){var m=p.modifier;var C=c.getDefinition();var v=p.view;var o=p.appComponent;var i={_settings:{}};["url","width","height"].forEach(function(I){var V=C.content[I];i[I]=V;i._settings[I]=V;});return Promise.resolve().then(function(){return m.createControl("sap.ui.fl.util.IFrame",o,v,s,i,false);});};});
sap.ui.predefine('sap/ui/fl/changeHandler/common/getTargetAggregationIndex',[],function(){"use strict";return function(c,C,p){var m=p.modifier;var o=c.getDefinition();var a=o.content.targetAggregation;var i=o.content.index;if(i===undefined){return Promise.resolve().then(m.getAggregation.bind(m,C,a)).then(function(A){return A.length;});}return Promise.resolve(i);};});
sap.ui.predefine('sap/ui/fl/changeHandler/common/revertAddedControls',["sap/ui/fl/Utils"],function(U){"use strict";return function(c,C,p){var m=p.modifier;var o=c.getDefinition();var a=o.content.targetAggregation;var v=p.view||U.getViewForControl(C);var A=p.appComponent;var r=c.getRevertData()||[];var b=r.map(function(R){var s;if(typeof R==="string"){s=R;}else{s=R.id;a=a||R.aggregationName;}return m.bySelector(s,A,v)||v&&v.createId&&m.bySelector(v.createId(s));});var P=[];b.forEach(function(d){var f=function(){return Promise.resolve().then(m.removeAggregation.bind(m,C,a,d)).then(function(){if(d.destroy){d.destroy();}});};P.push(f);});return U.execPromiseQueueSequentially(P,true,true).then(function(){c.resetRevertData();return true;});};});
sap.ui.predefine('sap/ui/fl/codeExt/CodeExtManager',["sap/ui/fl/write/_internal/Storage","sap/ui/fl/Change"],function(S,C){"use strict";var a;a={createOrUpdateCodeExtChange:function(p,o){if(!p.content||!p.content.codeRef){throw new Error("no code reference passed for the code extension change");}if(!p.selector||!p.selector.id){throw new Error("no controller name passed for the code extension change");}if(!p.reference){throw new Error("no reference passed for the code extension change");}p.changeType=p.changeType||"codeExt";var c=C.createInitialFileContent(p);return S.write({layer:c.layer,transport:o.transportId,flexObjects:[c]});},createCodeExtChanges:function(c,o){c=c||[];if(c.length===0){return Promise.resolve();}var p=[];c.forEach(function(b){b.changeType=b.changeType||"codeExt";b.packageName=o.packageName;b.content={codeRef:o.codeRef};p.push(C.createInitialFileContent(b));});return S.write({layer:p[0].layer,transport:o.transportId,flexObjects:p});},deleteCodeExtChange:function(c,o){if(c.changeType!=="codeExt"||c.fileType!=="change"){throw new Error("the change is not of type 'code extension'");}if(!c.fileName){throw new Error("the extension does not contains a file name");}if(c.namespace===undefined){throw new Error("the extension does not contains a namespace");}return S.remove({layer:c.layer,transport:o.transportId,flexObject:c});}};return a;});
sap.ui.predefine('sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration',["sap/ui/core/Core","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/changeHandler/AddXML","sap/ui/fl/changeHandler/AddXMLAtExtensionPoint","sap/ui/fl/changeHandler/HideControl","sap/ui/fl/changeHandler/MoveControls","sap/ui/fl/changeHandler/MoveElements","sap/ui/fl/changeHandler/PropertyBindingChange","sap/ui/fl/changeHandler/PropertyChange","sap/ui/fl/changeHandler/StashControl","sap/ui/fl/changeHandler/UnhideControl","sap/ui/fl/changeHandler/UnstashControl"],function(C,a,A,b,H,M,c,P,d,S,U,e){"use strict";var D={hideControl:H,moveElements:c,moveControls:M,stashControl:S,unhideControl:U,unstashControl:e};var m={addXML:A,addXMLAtExtensionPoint:b,propertyBindingChange:P,propertyChange:d};var r={};
function f(k,p){r[k]=p;p.catch(function(){}).then(function(){delete r[k];});}
function g(F){return a.registerChangeHandlersForLibrary(F);}
function h(l){if(l.getParameter("operation")==="add"){var L=l.getParameter("metadata");var s=L.sName;var F=L&&L.extensions&&L.extensions.flChangeHandlers;if(F){var R=g(F);f(s,R);}}}
var i={getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs:function(){var o=C.getLoadedLibraries();var p=[];Object.values(o).forEach(function(l){if(l.extensions&&l.extensions.flChangeHandlers){p.push(g(l.extensions.flChangeHandlers));}});C.attachLibraryChanged(h);return Promise.all(p);},waitForChangeHandlerRegistration:function(k){if(r[k]){return r[k].catch(function(){});}return Promise.resolve();},registerPredefinedChangeHandlers:function(){a.registerPredefinedChangeHandlers(D,m);}};return i;});
sap.ui.predefine('sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage',["sap/base/util/each","sap/base/Log","sap/ui/fl/Layer","sap/ui/fl/initial/_internal/changeHandlers/ChangeRegistryItem","sap/ui/fl/registry/Settings","sap/ui/fl/requireAsync"],function(e,L,a,C,S,r){"use strict";var b={};var R={};var A={};var p={};
function c(s,v){var o={};if(!v||!v.changeHandler){o.changeHandler=v;}else{o=v;}if(o.changeHandler==="default"){o.changeHandler=p.defaultChangeHandlers[s];}else if(Object.keys(p.developerChangeHandlers||{}).includes(s)){throw Error("You can't use a custom change handler for the following Developer Mode change type: "+s+". Please use 'default' instead.");}return o;}
function d(D){A={};e(D,function(s,o){var k=new C({controlType:"defaultActiveForAll",changeHandler:o,layers:S.getDeveloperModeLayerPermissions(),changeType:s});A[s]=k;});}
function f(s,k,o){o=c(k,o);var l=Object.assign({},S.getDefaultLayerPermissions());if(o.layers){e(o.layers,function(m,n){if(l[m]===undefined){throw Error("The Layer '"+m+"' is not supported. Please only use supported layers");}l[m]=n;});}var P={controlType:s,changeHandler:o.changeHandler,layers:l,changeType:k};return new C(P);}
function g(s,k,o){var l=f(s,k,o);R[s]=R[s]||{};R[s][k]=l;}
function h(s,m){var P=Promise.resolve(m);var k="ChangeHandlerStorage.registerChangeHandlersForControl.skip_next_then";if(typeof m==="string"){P=r(m+".flexibility").catch(function(E){L.error("Flexibility change handler registration failed.\nControlType: "+s+"\n"+E.message);return Promise.resolve(k);});}return P.then(function(v){if(v!==k){e(v,function(l,n){g(s,l,n);});}}).catch(function(E){L.error(E.message);});}
function i(s,k,l){var o=R[s]&&R[s][k]||A[k];if(!o){throw Error("No Change handler registered for the Control and Change type");}l=l===a.PUBLIC?a.USER:l;if(!o.getLayers()[l]){throw Error("Change type "+k+" not enabled for layer "+l);}return o;}
function j(s,k,o,m){var l=m.getChangeHandlerModulePath(o);if(typeof l!=="string"){return Promise.resolve(undefined);}return r(l).then(function(v){var n=v[s];if(n){return f(k,s,n);}}).catch(function(E){L.error("Flexibility registration for control "+m.getId(o)+" failed to load module "+l+"\n"+E.message);});}
b.getChangeHandler=function(s,k,o,m,l){return j(s,k,o,m).then(function(I){var n=I||i(k,s,l);return n.getChangeHandler();});};
b.registerPredefinedChangeHandlers=function(D,m){p.defaultChangeHandlers=D;p.developerChangeHandlers=m;d(m);};
b.registerChangeHandlersForLibrary=function(m){var P=[];e(m,function(s,v){P.push(h(s,v));});return Promise.all(P);};
b.clearAll=function(){R={};A={};p={};};
b.registerChangeHandlersForControl=function(s,m){return h(s,m);};
return b;});
sap.ui.predefine('sap/ui/fl/initial/_internal/changeHandlers/ChangeRegistryItem',["sap/base/Log","sap/ui/fl/requireAsync","sap/ui/fl/Utils"],function(L,r,U){"use strict";var C=function(p){if(!p.changeHandler){L.error("sap.ui.fl.registry.ChangeRegistryItem: changeHandler required");}if(!p.changeType){L.error("sap.ui.fl.registry.ChangeRegistryItem: changeType required");}if(!p.layers){L.error("sap.ui.fl.registry.ChangeRegistryItem: layers required");}if(!p.controlType){L.error("sap.ui.fl.registry.ChangeRegistryItem: ControlType required");}this._controlType=p.controlType;this._changeType=p.changeType;this._changeHandler=p.changeHandler;this._layers=p.layers;};
C.prototype.getChangeTypeName=function(){return this._changeType;};
C.prototype.getControlType=function(){return this._controlType;};
C.prototype.getLayers=function(){return this._layers;};
C.prototype.getChangeHandler=function(){var p=new U.FakePromise();if(typeof this._changeHandler==="string"){p=r(this._changeHandler.replace(/\./g,"/")).then(function(c){this._changeHandler=c;}.bind(this));}return p.then(function(){if(!this._changeHandler||typeof this._changeHandler.completeChangeContent!=="function"||typeof this._changeHandler.applyChange!=="function"||typeof this._changeHandler.revertChange!=="function"){return Promise.reject(new Error("The ChangeHandler is either not available or does not have all required functions"));}return this._changeHandler;}.bind(this));};
return C;});
sap.ui.predefine('sap/ui/fl/interfaces/Delegate',[],function(){"use strict";return{getPropertyInfo:function(){return Promise.reject("not implemented");},getRepresentedProperties:function(){return Promise.reject("not implemented");},createLabel:function(){return Promise.reject("not implemented");},createControlForProperty:function(){return Promise.reject("not implemented");},createLayout:function(){return Promise.reject("not implemented");}};});
sap.ui.predefine('sap/ui/fl/library',["sap/ui/fl/RegistrationDelegator","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/core/library","sap/m/library"],function(R,U,L){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.fl",version:"1.96.6",controls:["sap.ui.fl.variants.VariantManagement","sap.ui.fl.util.IFrame"],dependencies:["sap.ui.core","sap.m"],designtime:"sap/ui/fl/designtime/library.designtime",extensions:{flChangeHandlers:{"sap.ui.fl.util.IFrame":"sap/ui/fl/util/IFrame"},"sap.ui.support":{diagnosticPlugins:["sap/ui/fl/support/Flexibility"],publicRules:true}}});sap.ui.fl.Scenario={AppVariant:"APP_VARIANT",VersionedAppVariant:"VERSIONED_APP_VARIANT",AdaptationProject:"ADAPTATION_PROJECT",FioriElementsFromScratch:"FE_FROM_SCRATCH",UiAdaptation:"UI_ADAPTATION"};sap.ui.fl.Versions={Original:-1,Draft:0,UrlParameter:"sap-ui-fl-version"};sap.ui.fl.condenser={Classification:{LastOneWins:"lastOneWins",Reverse:"reverse",Move:"move",Create:"create",Destroy:"destroy"}};R.registerAll();
function _(){var u=U.getUshellContainer();if(u){return u.getLogonSystem().isTrial();}return false;}
if(_()){sap.ui.getCore().getConfiguration().setFlexibilityServices([{connector:"LrepConnector",url:"/sap/bc/lrep",layers:[]},{connector:"LocalStorageConnector",layers:[L.CUSTOMER,L.PUBLIC,L.USER]}]);}return sap.ui.fl;});
sap.ui.predefine('sap/ui/fl/registry/Settings',["sap/ui/fl/write/_internal/Storage","sap/ui/fl/Utils","sap/base/Log"],function(S,U,L){"use strict";
function r(){var u=U.getUshellContainer();if(u){return U.getUShellService("UserInfo").then(function(o){var b=o.getUser();return b&&b.getId();}).catch(function(e){L.error("Error getting service from Unified Shell: "+e.message);});}return Promise.resolve();}
var a=function(s){if(!s){throw new Error("no flex settings provided");}this._oSettings=s;};
a.attachEvent=function(e,c){a._oEventProvider.attachEvent(e,c);};
a.detachEvent=function(e,c){a._oEventProvider.detachEvent(e,c);};
a.getInstance=function(){if(a._instance){return Promise.resolve(a._instance);}if(a._oLoadSettingsPromise){return a._oLoadSettingsPromise;}return a._loadSettings();};
a._loadSettings=function(){var s;var l=S.loadFeatures().then(function(o){s=o;return r();}).then(function(u){if(!s){L.error("The request for flexibility settings failed; A default response is generated and returned to consuming APIs");s={isKeyUser:false,isKeyUserTranslationEnabled:false,isVariantSharingEnabled:false,isVariantPersonalizationEnabled:true,isAtoAvailable:false,isAtoEnabled:false,isAppVariantSaveAsEnabled:false,isCondensingEnabled:false,isProductiveSystem:true,isPublicLayerAvailable:false,isVariantAdaptationEnabled:false,versioning:{},_bFlexChangeMode:false,_bFlexibilityAdaptationButtonAllowed:false};}s.userId=u;return a._storeInstance(s);});a._oLoadSettingsPromise=l;return l;};
a._storeInstance=function(s){if(!a._instance){a._instance=new a(s);}return a._instance;};
a.getInstanceOrUndef=function(){return a._instance;};
a.getDefaultLayerPermissions=function(){return{VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:true,PUBLIC:false,USER:false};};
a.getDeveloperModeLayerPermissions=function(){return{VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:false,PUBLIC:false,USER:false};};
a.prototype._getBooleanProperty=function(p){return this._oSettings[p]||false;};
a.prototype.isKeyUser=function(){return this._getBooleanProperty("isKeyUser");};
a.prototype.isKeyUserTranslationEnabled=function(){return this._getBooleanProperty("isKeyUserTranslationEnabled");};
a.prototype.isPublicLayerAvailable=function(){return this._getBooleanProperty("isPublicLayerAvailable");};
a.prototype.isVariantAdaptationEnabled=function(){return this._getBooleanProperty("isVariantAdaptationEnabled");};
a.prototype.isAppVariantSaveAsEnabled=function(){return this._getBooleanProperty("isAppVariantSaveAsEnabled");};
a.prototype.isVersioningEnabled=function(l){return!!(this._oSettings.versioning[l]||this._oSettings.versioning["ALL"]);};
a.prototype.isModelS=function(){return this._getBooleanProperty("isAtoAvailable");};
a.prototype.isAtoEnabled=function(){return this._getBooleanProperty("isAtoEnabled");};
a.prototype.isAtoAvailable=function(){return this._getBooleanProperty("isAtoAvailable");};
a.prototype.isProductiveSystem=function(){return this._getBooleanProperty("isProductiveSystem");};
a.prototype.isVariantSharingEnabled=function(){return this._getBooleanProperty("isVariantSharingEnabled");};
a.prototype.isPublicFlVariantEnabled=function(){return this._getBooleanProperty("isPublicFlVariantEnabled");};
a.prototype.isVariantPersonalizationEnabled=function(){return this._getBooleanProperty("isVariantPersonalizationEnabled");};
a.prototype.isCondensingEnabled=function(){return this._getBooleanProperty("isCondensingEnabled");};
a.prototype.getSystem=function(){return this._oSettings.system;};
a.prototype.getClient=function(){return this._oSettings.client;};
a.prototype.getUserId=function(){return this._oSettings.userId;};
return a;},true);
sap.ui.predefine('sap/ui/fl/util/IFrame',["../library","sap/ui/core/Control","sap/ui/model/json/JSONModel","./getContainerUserInfo","sap/base/util/extend","sap/base/security/URLListValidator","sap/base/Log","sap/ui/core/library","./IFrameRenderer"],function(l,C,J,g,e,U,L){"use strict";
function u(v){if(v.parts&&v.formatter){return v.formatter.apply(null,v.parts.map(function(p){if(p.model){return"{"+p.model+">"+p.path+"}";}return"{"+p.path+"}";}));}return v;}
var I=C.extend("sap.ui.fl.util.IFrame",{
metadata:{library:"sap.ui.fl",properties:{url:{type:"sap.ui.core.URI",group:"Misc",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},title:{type:"string",group:"Misc",defaultValue:undefined},_settings:{type:"object",group:"Data",defaultValue:null}},designtime:"sap/ui/fl/designtime/util/IFrame.designtime"},
init:function(){if(C.prototype.init){C.prototype.init.apply(this,arguments);}this._oInitializePromise=g().then(function(o){this._oUserModel=new J(o);this.setModel(this._oUserModel,"$user");}.bind(this));},
waitForInit:function(){return this._oInitializePromise?this._oInitializePromise:Promise.reject();},
setUrl:function(s){var E=decodeURI(s)===s?encodeURI(s):s;if(I.isValidUrl(E)){this.setProperty("url",E);}else{L.error("Provided URL is not valid as an IFrame src");}return this;},
applySettings:function(s){C.prototype.applySettings.apply(this,arguments);if(s){var m=this.getProperty("_settings")||{};if(s._settings){e(m,s._settings);}else{Object.keys(s).filter(function(p){return!!s[p];}).forEach(function(p){m[p]=u(s[p]);});}this.setProperty("_settings",m);}},
exit:function(){if(this._oUserModel){this._oUserModel.destroy();delete this._oUserModel;}}
});
I.isValidUrl=function(s){return(!U.entries().some(function(v){return/javascript/i.test(v.protocol);})&&U.validate(s));};
return I;});
sap.ui.predefine('sap/ui/fl/util/IFrameRenderer',[],function(){"use strict";
function _(r,d,v){if(v!==""||v.toLowerCase()==="auto"){r.style(d,v);}}
var I={apiVersion:2};
I.render=function(r,i){r.openStart("iframe",i);_(r,"width",i.getWidth());_(r,"height",i.getHeight());r.style("display","block");r.style("border","none");r.attr("sandbox","allow-forms allow-popups allow-scripts allow-same-origin allow-modals");r.attr("src",i.getUrl());var t=i.getTitle();if(t){r.attr("title",t);}r.openEnd();r.close("iframe");};
return I;},true);
sap.ui.predefine('sap/ui/fl/util/ManagedObjectModel',["sap/ui/core/Element","sap/ui/model/base/ManagedObjectModel"],function(E,M){"use strict";
function c(n){return n.charAt(0).toUpperCase()+n.slice(1);}
var a=E.extend("sap.ui.fl.util.ManagedObjectModel",{
metadata:{library:"sap.ui.fl",properties:{data:{type:"object"},name:{type:"string",defaultValue:"$sap.ui.fl.ManagedObjectModel"}},associations:{object:{type:"sap.ui.core.Element"}}},
constructor:function(){E.apply(this,arguments);this._oManagedObjectModel=new M(sap.ui.getCore().byId(this.getObject()),this.getData());["data","name","object"].forEach(function(n){this["set"+c(n)]=function(){throw new Error("sap.ui.fl.util.ManagedObjectModel: Can't change the value of `"+n+"` after the object is initialized. Please recreate the object with correct values in the constructor.");};},this);}
});
a.prototype.setParent=function(n){var o=this.getParent();if(o){o.setModel(null,this.getName());}if(n){n.setModel(this._oManagedObjectModel,this.getName());}E.prototype.setParent.apply(this,arguments);};
a.prototype.exit=function(){this._oManagedObjectModel.destroy();};
return a;});
sap.ui.predefine('sap/ui/fl/util/getContainerUserInfo',["sap/ui/fl/Utils","sap/base/Log"],function(U,L){"use strict";
function e(v){if(!v){return"";}return v;}
return function(){var u=U.getUshellContainer();if(u){return U.getUShellService("UserInfo").then(function(o){if(!o){return{};}var a=o.getUser();if(!a){return{};}var E=e(a.getEmail());var d;if(E){d=e(/@(.*)/.exec(E)[1]);}else{d="";}return{fullName:e(a.getFullName()),firstName:e(a.getFirstName()),lastName:e(a.getLastName()),email:E,domain:d};}).catch(function(E){L.error("Unexpected exception when reading shell user info: "+E.toString());return{};});}return Promise.resolve({});};});
sap.ui.predefine('sap/ui/fl/write/_internal/condenser/Condenser',["sap/base/util/each","sap/base/util/isPlainObject","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/write/_internal/condenser/classifications/LastOneWins","sap/ui/fl/write/_internal/condenser/classifications/Reverse","sap/ui/fl/write/_internal/condenser/UIReconstruction","sap/ui/fl/write/_internal/condenser/Utils","sap/ui/fl/Change","sap/ui/fl/Utils","sap/ui/performance/Measurement"],function(e,i,L,J,C,c,d,R,U,f,g,F,M){"use strict";var h={};var j="unclassified";var N={lastOneWins:d,reverse:R};var P=["affectedControl","sourceContainer","targetContainer"];
function k(S,a){var b=S[sap.ui.fl.condenser.Classification.Move];return a.classification===sap.ui.fl.condenser.Classification.Create&&b&&b[b.length-1].targetContainer===a.targetContainer;}
function l(S,a){return a.classification===sap.ui.fl.condenser.Classification.Move&&S[sap.ui.fl.condenser.Classification.Destroy];}
function m(a,b){return b.classification===sap.ui.fl.condenser.Classification.Create&&a[sap.ui.fl.condenser.Classification.Destroy];}
function n(a,b,G,H){if(!l(a,G)&&!m(a,G)){var I=G.classification;if(!a[I]){G.change=H;H.condenserState="select";a[I]=[G];}else{H.condenserState="delete";}a[I][0].updateChange=H;}if(k(a,G)||m(a,G)){if(a[sap.ui.fl.condenser.Classification.Move]){a[sap.ui.fl.condenser.Classification.Move].forEach(function(G){G.change.condenserState="delete";});delete a[sap.ui.fl.condenser.Classification.Move];}if(a[sap.ui.fl.condenser.Classification.Destroy]){a[sap.ui.fl.condenser.Classification.Destroy].forEach(function(G){G.change.condenserState="delete";});delete a[sap.ui.fl.condenser.Classification.Destroy];}}return U.addChange(b,G);}
function o(T,a,I,b,G){if(!T[b.type]){T[b.type]={};}var H=T[b.type];if(b.type===f.NOT_INDEX_RELEVANT){if(!H[b.classification]){H[b.classification]={};}var K=H[b.classification];N[b.classification].addToChangesMap(K,b.uniqueKey,G);return Promise.resolve();}I.push(G);return n(H,a,b,G);}
function p(T,K,a){if(!T[K]){T[K]=[];}T[K].push(a);a.condenserState="select";}
function q(a,b){var G=J.getControlIdBySelector(b.getSelector(),a);var H=C.byId(G);if(H){var I={modifier:J,appComponent:a,view:F.getViewForControl(H)};var K=c.getControlIfTemplateAffected(b,H,I);return Promise.resolve(c.getChangeHandler(b,K,I)).then(function(O){if(O&&typeof O.getCondenserInfo==="function"){return O.getCondenserInfo(b,I);}return undefined;}).then(function(O){if(O&&K.bTemplateAffected){r(O,b);}return O;}).catch(function(){return undefined;});}return Promise.resolve();}
function r(a,b){var O=b.getOriginalSelector();var T=b.getSelector();P.forEach(function(G){if(a[G]&&a[G]===T){a[G]=O;}});}
function s(a,b,G,H){var I=b!==undefined?b.affectedControl:J.getControlIdBySelector(G.getSelector(),H);if(!a[I]){a[I]={};}return a[I];}
function t(a,b,G,I,H){return H.reduce(function(K,O){return K.then(u.bind(this,a,b,G,I,O));}.bind(this),Promise.resolve());}
function u(a,b,G,I,H){return q(a,H).then(function(K){w(K,a);var T=s(b,K,H,a);if(K!==undefined){v(K);return o(T,G,I,K,H);}p(T,j,H);b[j]=true;return undefined;});}
function v(a){if(N[a.classification]){a.type=f.NOT_INDEX_RELEVANT;}else{a.type=f.INDEX_RELEVANT;}}
function w(a,b){P.forEach(function(G){if(a&&a[G]){a[G]=J.getControlIdBySelector(a[G],b);}});}
function x(O,a){e(O,function(K,S){if(N[K]&&N[K].getChangesFromMap){N[K].getChangesFromMap(O,K).forEach(function(b){a.push(b);});}else if(i(S)){return x(S,a);}else if(Array.isArray(S)){S.forEach(function(b){if(b instanceof g){a.push(b);}else{a.push(b.change);}});}});return a;}
function y(a){return x(a,[]);}
function z(a,b){e(a,function(K,S){if(i(S)){z(S,b);}else if(Array.isArray(S)){S.forEach(function(O){if(!(O instanceof g)){b.push(O);}});}});return b;}
function A(G,H){H.sort(function(a,b){return G.indexOf(a)-G.indexOf(b);});}
function B(G,H){H.sort(function(a,b){return G.indexOf(a.change)-G.indexOf(b.change);});}
function D(a,I){var b=a.map(function(G){return G.getId();});I.forEach(function(G){if(b.indexOf(G.getId())===-1){a.push(G);}});}
function E(a,b){a.forEach(function(G){var H=G.updateChange;if(H&&H.getState()!==g.states.NEW){var I=G.change;if(H.getFileName()!==I.getFileName()){var K=I.getContent();H.setContent(K);I.condenserState="delete";b=b.map(function(O){if(O.getFileName()===I.getFileName()){return H;}return O;});}else{H.setState(g.states.DIRTY);}H.condenserState="update";}});return b;}
h.condense=function(a,b){M.start("Condenser_overall","Condenser overall - CondenserClass",["sap.ui.fl","Condenser"]);var G={};var H={};var I=[];var K=[];var O=[];b.slice(0).reverse().forEach(function(Q){if(Q instanceof g&&Q.isApplyProcessFinished()){O.push(Q);}else{K.push(Q);}});M.start("Condenser_defineMaps","defining of maps - CondenserClass",["sap.ui.fl","Condenser"]);return t(a,G,H,I,O).then(function(){M.end("Condenser_defineMaps");var Q=G[j];if(!Q){U.compareAndUpdate(G,H);}var S=y(G);if(Q){I.forEach(function(Y){Y.condenserState="select";});D(S,I);}S=S.concat(K);A(b,S);if(!Q){M.start("Condenser_handleIndexRelatedChanges","handle index related changes - CondenserClass",["sap.ui.fl","Condenser"]);var T=true;var V=z(G,[]);B(b,V);try{M.start("Condenser_sort","sort index related changes - CondenserClass",["sap.ui.fl","Condenser"]);var W=U.sortIndexRelatedChanges(H,V);}catch(X){L.error("Error during Condensing: "+X.message,"No Condensing performed for index-relevant changes.");T=false;}M.end("Condenser_sort");if(T){U.swapChanges(W,S);S=E(V,S);}else{I.forEach(function(Y){Y.condenserState="select";});D(S,I);A(b,S);}M.end("Condenser_handleIndexRelatedChanges");}M.end("Condenser_overall");return S;});};
return h;});
sap.ui.predefine('sap/ui/fl/write/_internal/condenser/UIReconstruction',["sap/base/util/restricted/_isEqual","sap/base/util/each","sap/ui/fl/write/_internal/condenser/classifications/Create","sap/ui/fl/write/_internal/condenser/classifications/Destroy","sap/ui/fl/write/_internal/condenser/classifications/Move","sap/ui/fl/write/_internal/condenser/Utils"],function(_,e,C,D,M,U){"use strict";var d={};var I={create:C,destroy:D,move:M};
function f(a,c){e(a,function(O,b){e(b,function(q,r){c(b,O,r,q);});});}
function s(E,O,N){E.splice(N,0,E.splice(O,1)[0]);}
function g(a,c){var b={};f(a,function(q,r,t,A){var T=t[U.TARGET_UI];T.forEach(function(v){c.forEach(function(w){if(v===w.affectedControl){if(!b[r]){b[r]={};}var x=b[r];if(!x[A]){x[A]=[];}var y=x[A];y.push(w);}});});});return b;}
function h(c){return!c.some(function(E){return E.classification!==sap.ui.fl.condenser.Classification.Create;});}
function i(E){return!E.some(function(v){return U.isUnknown(v);});}
function j(c){return c.getTargetIndex(c.change);}
function k(c){c.sort(function(a,b){var q=j(a);var N=j(b);return q-N;});}
function l(E){return!E.some(function(v){return!U.isUnknown(v);});}
function m(a,b){var c;if(a.length<b.length){c=b.slice(a.length);if(!l(c)){return false;}b=b.slice(0,a.length);}else if(a.length>b.length){c=a.slice(b.length,a.length);if(!l(c)){return false;}a=a.slice(0,b.length);}return _(a,b);}
function n(c,a,b,t,q){var r={};q.forEach(function(v){var c=v.targetContainer;if(!r[c]){r[c]={};}var w=r[c];if(!w[a]){w[a]=U.initializeArrayWithPlaceholders(0,b.length-1);}I[v.classification].simulate(w[a],v,b);});var S=r[c][a];if(m(t,S)){return true;}return false;}
function u(r,a){f(a,function(b,c,q){q[U.TARGET_UI].forEach(function(t,v){if(!U.isUnknown(t)){var T=r[t];var S=T[U.INDEX_RELEVANT];e(S,function(w,x){if(w!==sap.ui.fl.condenser.Classification.Destroy){x.forEach(function(y){y.setTargetIndex(y.change,v);y.change.condenserState="select";});}});}});});}
function o(r,a){f(a,function(b,c,q,K){var t=q[U.INITIAL_UI];var T=q[U.TARGET_UI];if(m(t,T)){T.forEach(function(v){var w=r[v];if(w!==undefined){e(w[U.INDEX_RELEVANT],function(x,y){y.forEach(function(z){z.change.condenserState="delete";});});delete w[U.INDEX_RELEVANT];}});delete b[K];}});}
function p(r,a){f(a,function(b,c,q){var t=q[U.INITIAL_UI];var T=q[U.TARGET_UI];t.forEach(function(v,w){var x=r[v];if(!x||!x[U.INDEX_RELEVANT]){var P=U.PLACEHOLDER+w;var y=T.indexOf(v);if(y>=0){T[y]=P;}}});});}
d.swapChanges=function(S,a){var b=S.map(function(c){return a.indexOf(c);}).sort();S.forEach(function(c){a[b.shift()]=c;});};
d.sortIndexRelatedChanges=function(a,c){var S=[];var b=g(a,c);f(b,function(A,q,c,r){var t=a[q][r][U.TARGET_UI];var v=a[q][r][U.INITIAL_UI];var w=true;if(i(t)||h(c)){k(c);}else if(!n(q,r,v,t,c)){w=false;var T=c.length;while(T!==0&&!w){var O=0;var N=1;while(N<c.length&&!w){s(c,O,N);w=n(q,r,v,t,c);O++;N++;}T--;}}if(!w){throw Error("no correct sorting found for the container: "+q);}c.forEach(function(x){S=S.concat(x.change);});});return S;};
d.addChange=function(a,c){return I[c.classification].addToReconstructionMap(a,c);};
d.compareAndUpdate=function(r,a){o(r,a);p(r,a);u(r,a);};
return d;});
sap.ui.predefine('sap/ui/fl/write/_internal/condenser/Utils',["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core"],function(J,C){"use strict";var U={};U.TARGET_UI="targetUI";U.INITIAL_UI="initialUI";U.PLACEHOLDER="X";U.INDEX_RELEVANT="indexRelevant";U.NOT_INDEX_RELEVANT="notIndexRelevant";
function g(s,t){return(Math.max(s,t)||0)+1;}
U.getInitialUIContainerElementIds=function(u,c,a,b){if(!u[c]){u[c]={};}var m=u[c];if(!m[a]){m[a]={};}var d=m[a];if(!d[U.TARGET_UI]){d[U.TARGET_UI]=b;}if(!d[U.INITIAL_UI]){d[U.INITIAL_UI]=b.slice(0);}return d[U.INITIAL_UI];};
U.getContainerElementIds=function(c,a){var o=C.byId(c);return Promise.resolve().then(J.getAggregation.bind(J,o,a)).then(function(b){return b.map(function(e){return e.getId();});});};
U.initializeArrayWithPlaceholders=function(t,s){var l=g(s,t);return Array(l).fill(U.PLACEHOLDER).map(function(p,i){return p+i;});};
U.extendArrayWithPlaceholders=function(e,s,t){var l=g(s,t);if(e.length<l){var u;for(var i=e.length;i<=l;i++){u=U.PLACEHOLDER+(e.length);e.splice(e.length,0,u);}}};
U.extendElementsArray=function(e,s,t,a){U.extendArrayWithPlaceholders(e,s,t);var c=e.indexOf(a);var u=e.indexOf(U.PLACEHOLDER+s);if(c!==s&&s!==undefined){if(c>=0){U.shiftElement(e,c,s);}else if(u>-1){e[u]=a;}else if(U.isUnknown(e[s])){e[s]=a;}}};
U.shiftElement=function(e,o,n){e.splice(n,0,e.splice(o,1)[0]);};
U.isUnknown=function(v){if(v!==undefined&&v.indexOf(U.PLACEHOLDER)===0){var r=v.slice(1,v.length);var p=parseInt(r);if(isNaN(p)){return false;}return true;}return false;};
return U;});
sap.ui.predefine('sap/ui/fl/write/_internal/condenser/classifications/Create',["sap/ui/core/Core","sap/ui/fl/write/_internal/condenser/Utils"],function(C,a){"use strict";return{addToReconstructionMap:function(u,c){var A=C.byId(c.affectedControl);var s=A&&A.sParentAggregationName||c.targetAggregation;return a.getContainerElementIds(c.targetContainer,s).then(function(t){var b=a.getInitialUIContainerElementIds(u,c.targetContainer,c.targetAggregation,t);var i=b.indexOf(c.affectedControl);if(i>-1){b.splice(i,1);}});},simulate:function(c,o){c.splice(o.getTargetIndex(o.change),0,o.affectedControl);}};});
sap.ui.predefine('sap/ui/fl/write/_internal/condenser/classifications/Destroy',["sap/ui/fl/write/_internal/condenser/Utils"],function(C){"use strict";return{addToReconstructionMap:function(u,c){return C.getContainerElementIds(c.targetContainer,c.targetAggregation).then(function(t){var a=C.getInitialUIContainerElementIds(u,c.targetContainer,c.targetAggregation,t);if(a.length-1<c.sourceIndex){while(a.length-1<c.sourceIndex){var i=a.length;a.splice(a.length,0,C.PLACEHOLDER+i);}a[c.sourceIndex]=c.affectedControl;}else{a.splice(c.sourceIndex,0,c.affectedControl);}});},simulate:function(c,o,i){var I=c.indexOf(o.affectedControl);if(I===-1){var u=C.PLACEHOLDER+i.indexOf(o.affectedControl);I=c.indexOf(u);}if(I>-1){c.splice(I,1);}}};});
sap.ui.predefine('sap/ui/fl/write/_internal/condenser/classifications/LastOneWins',[],function(){"use strict";return{addToChangesMap:function(p,u,c){if(!p[u]){p[u]=[c];c.condenserState="select";}else{c.condenserState="delete";}}};});
sap.ui.predefine('sap/ui/fl/write/_internal/condenser/classifications/Move',["sap/ui/fl/write/_internal/condenser/Utils"],function(C){"use strict";return{addToReconstructionMap:function(u,c){return Promise.all([C.getContainerElementIds(c.sourceContainer,c.sourceAggregation),C.getContainerElementIds(c.targetContainer,c.targetAggregation)]).then(function(s){var S=s[0];var t=s[1];var a;var T;if(c.targetContainer===c.sourceContainer&&c.targetAggregation===c.sourceAggregation){a=C.getInitialUIContainerElementIds(u,c.targetContainer,c.targetAggregation,t);T=a.indexOf(c.affectedControl);C.shiftElement(a,T,c.sourceIndex);}else{a=C.getInitialUIContainerElementIds(u,c.targetContainer,c.targetAggregation,t);T=a.indexOf(c.affectedControl);a.splice(T,1);a=C.getInitialUIContainerElementIds(u,c.sourceContainer,c.sourceAggregation,S);a.splice(c.sourceIndex,0,c.affectedControl);}});},simulate:function(c,o,i){var a=o.affectedControl;var I=i.indexOf(a);C.extendElementsArray(c,I,undefined,a);var b=c.indexOf(a);var t=o.getTargetIndex(o.change);if(I===-1){c.splice(t,0,a);}else{c.splice(t,0,c.splice(b,1)[0]);}}};});
sap.ui.predefine('sap/ui/fl/write/_internal/condenser/classifications/Reverse',["sap/base/util/each"],function(e){"use strict";return{addToChangesMap:function(p,u,c){if(!p[u]){p[u]=[];}p[u].push(c);},getChangesFromMap:function(o,u){var c=[];e(o[u],function(k,r){r.reverse();var C;r.forEach(function(a,i){if(C&&C.getChangeType()!==a.getChangeType()){C=null;r[i].condenserState="delete";r[i-1].condenserState="delete";}else{C=a;if(i>0){r[i-1].condenserState="delete";}r[i].condenserState="select";}});if(C){c.push(C);}});return c;}};});
sap.ui.require.preload({
	"sap/ui/fl/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.fl","type":"library","embeds":["support/apps/contentbrowser","support/apps/uiFlexibilityDiagnostics","variants/context"],"applicationVersion":{"version":"1.96.6"},"title":"SAPUI5 library with sap.ui.fl controls.","description":"SAPUI5 library with sap.ui.fl controls.","ach":"CA-UI5-FL","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_hcb"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.96","libs":{"sap.ui.core":{"minVersion":"1.96.6"},"sap.m":{"minVersion":"1.96.6"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":["sap.ui.fl.variants.VariantManagement","sap.ui.fl.util.IFrame"]}}}}'
},"sap/ui/fl/library-preload"
);
sap.ui.loader.config({bundlesUI5:{
"sap/ui/fl/library-preload-apply.js":["sap/ui/fl/apply/_internal/ChangesController.js","sap/ui/fl/apply/_internal/changes/descriptor/ApplyUtil.js","sap/ui/fl/apply/_internal/changes/descriptor/Registration.js","sap/ui/fl/apply/_internal/changes/descriptor/RegistrationBuild.js","sap/ui/fl/apply/_internal/changes/descriptor/app/AddAnnotationsToOData.js","sap/ui/fl/util/DescriptorChangeCheck.js","sap/ui/fl/apply/_internal/changes/descriptor/app/ChangeDataSource.js","sap/ui/fl/util/changePropertyValueByPath.js","sap/ui/fl/apply/_internal/changes/descriptor/app/ChangeInbound.js","sap/ui/fl/apply/_internal/changes/descriptor/app/SetTitle.js","sap/ui/fl/apply/_internal/changes/descriptor/fiori/SetAbstract.js","sap/ui/fl/apply/_internal/changes/descriptor/fiori/SetRegistrationIds.js","sap/ui/fl/apply/_internal/changes/descriptor/ovp/AddNewCard.js","sap/ui/fl/apply/_internal/changes/descriptor/ovp/ChangeCard.js","sap/ui/fl/apply/_internal/changes/descriptor/ovp/DeleteCard.js","sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddComponentUsages.js","sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddLibrary.js","sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddNewModel.js","sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddNewModelEnhanceWith.js","sap/ui/fl/apply/_internal/changes/descriptor/ui5/SetFlexExtensionPointEnabled.js","sap/ui/fl/apply/_internal/changes/descriptor/ui5/SetMinUI5Version.js","sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector.js","sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils.js","sap/ui/fl/apply/_internal/extensionPoint/Processor.js","sap/ui/fl/apply/_internal/flexState/changes/ExtensionPointState.js","sap/ui/fl/write/api/ChangesWriteAPI.js","sap/ui/fl/descriptorRelated/api/DescriptorChangeFactory.js","sap/ui/fl/write/_internal/appVariant/AppVariantInlineChangeFactory.js","sap/ui/fl/descriptorRelated/internal/Utils.js","sap/ui/fl/write/_internal/appVariant/AppVariantInlineChange.js","sap/ui/fl/apply/_internal/flexObjects/CompVariantRevertData.js","sap/ui/fl/apply/_internal/flexObjects/RevertData.js","sap/ui/fl/apply/_internal/flexState/UI2Personalization/UI2PersonalizationState.js","sap/ui/fl/write/_internal/connectors/LrepConnector.js","sap/ui/fl/initial/_internal/connectors/LrepConnector.js","sap/ui/fl/initial/_internal/connectors/Utils.js","sap/ui/fl/write/_internal/connectors/Utils.js","sap/ui/fl/write/_internal/transport/TransportSelection.js","sap/ui/fl/write/_internal/transport/TransportDialog.js","sap/ui/fl/write/_internal/transport/Transports.js","sap/ui/fl/write/connectors/BaseConnector.js","sap/ui/fl/apply/_internal/flexState/compVariants/Utils.js","sap/ui/fl/apply/api/ControlVariantApplyAPI.js","sap/ui/fl/ControlPersonalizationAPI.js","sap/ui/fl/variants/VariantManagement.js","sap/ui/fl/apply/api/FlexRuntimeInfoAPI.js","sap/ui/fl/apply/api/SmartVariantManagementApplyAPI.js","sap/ui/fl/apply/api/UI2PersonalizationApplyAPI.js","sap/ui/fl/transport/TransportDialog.js","sap/ui/fl/transport/TransportSelection.js","sap/ui/fl/util/IFrame.flexibility.js"],
"sap/ui/fl/library-preload-write.js":["sap/ui/fl/FakeLrepConnector.js","sap/ui/fl/write/_internal/connectors/ObjectPathConnector.js","sap/ui/fl/FakeLrepConnectorLocalStorage.js","sap/ui/fl/write/_internal/connectors/LocalStorageConnector.js","sap/ui/fl/write/api/connectors/ObjectStorageConnector.js","sap/ui/fl/FakeLrepConnectorSessionStorage.js","sap/ui/fl/write/_internal/connectors/SessionStorageConnector.js","sap/ui/fl/FakeLrepLocalStorage.js","sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory.js","sap/ui/fl/descriptorRelated/api/DescriptorVariantFactory.js","sap/ui/fl/write/_internal/appVariant/AppVariantFactory.js","sap/ui/fl/write/_internal/appVariant/AppVariant.js","sap/ui/fl/util/resolveBinding.js","sap/ui/fl/write/_internal/SaveAs.js","sap/ui/fl/write/_internal/connectors/BackendConnector.js","sap/ui/fl/initial/_internal/connectors/BackendConnector.js","sap/ui/fl/write/_internal/connectors/JsObjectConnector.js","sap/ui/fl/write/_internal/connectors/KeyUserConnector.js","sap/ui/fl/initial/_internal/connectors/KeyUserConnector.js","sap/ui/fl/write/_internal/connectors/NeoLrepConnector.js","sap/ui/fl/initial/_internal/connectors/NeoLrepConnector.js","sap/ui/fl/write/_internal/connectors/ObjectStorageConnector.js","sap/ui/fl/write/_internal/connectors/PersonalizationConnector.js","sap/ui/fl/initial/_internal/connectors/PersonalizationConnector.js","sap/ui/fl/write/_internal/delegates/ODataV4ReadDelegate.js","sap/ui/fl/write/_internal/extensionPoint/Processor.js","sap/ui/fl/write/_internal/extensionPoint/Registry.js","sap/ui/fl/write/_internal/fieldExtensibility/ABAPAccess.js","sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariantFactory.js","sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariant.js","sap/ui/fl/write/_internal/fieldExtensibility/MultiTenantABAPExtensibilityVariant.js","sap/ui/fl/write/_internal/fieldExtensibility/Utils.js","sap/ui/fl/write/_internal/fieldExtensibility/SingleTenantABAPExtensibilityVariant.js","sap/ui/fl/write/_internal/fieldExtensibility/UriParser.js","sap/ui/fl/write/_internal/fieldExtensibility/ServiceValidation.js","sap/ui/fl/write/_internal/fieldExtensibility/cap/CAPAccess.js","sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog.js","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/getEditorConfig.js","sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog.fragment.xml","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor.fragment.xml","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor.js","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor.fragment.xml","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor.js","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor.fragment.xml","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor.js","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/validators/IsRequired.js","sap/ui/fl/write/_internal/flexState/FlexObjectState.js","sap/ui/fl/write/_internal/flexState/compVariants/CompVariantState.js","sap/ui/fl/write/api/AppVariantWriteAPI.js","sap/ui/fl/write/api/ContextSharingAPI.js","sap/ui/fl/variants/context/Component.js","sap/ui/fl/write/api/FeaturesAPI.js","sap/ui/fl/write/api/ControlPersonalizationWriteAPI.js","sap/ui/fl/write/api/ExtensionPointRegistryAPI.js","sap/ui/fl/write/api/FieldExtensibility.js","sap/ui/fl/write/api/LocalResetAPI.js","sap/ui/fl/write/api/PersistenceWriteAPI.js","sap/ui/fl/write/api/ReloadInfoAPI.js","sap/ui/fl/write/api/VersionsAPI.js","sap/ui/fl/write/api/SmartBusinessWriteAPI.js","sap/ui/fl/write/api/SmartVariantManagementWriteAPI.js","sap/ui/fl/write/api/UI2PersonalizationWriteAPI.js","sap/ui/fl/write/api/connectors/FileListBaseConnector.js"]
}});
//# sourceMappingURL=library-preload.js.map