/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/editor/Editor","sap/ui/core/Core","sap/ui/integration/widgets/Card"],function(E,C,a){"use strict";var r=C.getLibraryResourceBundle("sap.ui.integration");var b=E.extend("sap.ui.integration.designtime.editor.CardEditor",{metadata:{library:"sap.ui.integration",properties:{card:{type:"any",defaultValue:null}},aggregations:{_extension:{type:"sap.ui.integration.Extension",multiple:false,visibility:"hidden"}}},renderer:E.getMetadata().getRenderer().render});b.prototype.hasPreview=function(){var p=this.getAggregation("_preview");if(p&&p.getSettings()&&p.getSettings().preview&&p.getSettings().preview.modes==="None"){return false;}return true;};b.prototype.setCard=function(c,s){if(c===this.getProperty("card")){return this;}if(this._oEditorCard){this._oEditorCard.destroy();}this.setProperty("card",c,s);if(typeof c==="string"){try{c=JSON.parse(c);}catch(e){var i=C.byId(c);if(!i){var d=document.getElementById(c);if(d&&d.tagName&&d.tagName==="ui-integration-card"){i=d._getControl();}}c=i;}}if(c&&c.isA&&c.isA("sap.ui.integration.widgets.Card")){c={manifest:c.getManifest(),manifestChanges:c.getManifestChanges(),host:c.getHost(),baseUrl:c.getBaseUrl()};}if(typeof c==="object"){this._oEditorCard=new a(c);this._oEditorCard.onBeforeRendering();this._oEditorCard.attachEventOnce("_cardReady",function(){this.setJson(c,s);}.bind(this));}};b.prototype._initPreview=function(){var s=this._oDesigntimeInstance.getSettings()||{};s.preview=s.preview||{};s.preview.position=this.getPreviewPosition();return new Promise(function(c,d){sap.ui.require(["sap/ui/integration/designtime/editor/CardPreview"],function(P){var p=new P({settings:s,card:this._oEditorCard});this.setAggregation("_preview",p);c();}.bind(this));}.bind(this));};b.prototype._loadExtension=function(){return new Promise(function(c,d){var e=this._oEditorCard.getAggregation("_extension");this.setAggregation("_extension",e);c();}.bind(this));};b.prototype._mergeContextData=function(c){var d={};d["empty"]=b._contextEntries.empty;for(var n in c){d[n]=c[n];}d["card.internal"]=b._contextEntries["card.internal"];return d;};b._contextEntries={empty:{label:r.getText("CARDEDITOR_CONTEXT_EMPTY_VAL"),type:"string",description:r.getText("CARDEDITOR_CONTEXT_EMPTY_DESC"),placeholder:"",value:""},"card.internal":{label:r.getText("CARDEDITOR_CONTEXT_CARD_INTERNAL_VAL"),todayIso:{type:"string",label:r.getText("CARDEDITOR_CONTEXT_CARD_TODAY_VAL"),description:r.getText("CARDEDITOR_CONTEXT_CARD_TODAY_DESC"),tags:[],placeholder:r.getText("CARDEDITOR_CONTEXT_CARD_TODAY_VAL"),customize:["format.dataTime"],value:"{{parameters.TODAY_ISO}}"},nowIso:{type:"string",label:r.getText("CARDEDITOR_CONTEXT_CARD_NOW_VAL"),description:r.getText("CARDEDITOR_CONTEXT_CARD_NOW_DESC"),tags:[],placeholder:r.getText("CARDEDITOR_CONTEXT_CARD_NOW_VAL"),customize:["dateFormatters"],value:"{{parameters.NOW_ISO}}"},currentLanguage:{type:"string",label:r.getText("CARDEDITOR_CONTEXT_CARD_LANG_VAL"),description:r.getText("CARDEDITOR_CONTEXT_CARD_LANG_VAL"),tags:["technical"],customize:["languageFormatters"],placeholder:r.getText("CARDEDITOR_CONTEXT_CARD_LANG_VAL"),value:"{{parameters.LOCALE}}"}}};return b;});
