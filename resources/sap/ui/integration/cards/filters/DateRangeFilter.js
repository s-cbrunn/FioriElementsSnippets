/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/ui/core/library","sap/m/DynamicDateRange","sap/m/DynamicDateUtil"],function(B,c,D,a){"use strict";var V=c.ValueState;var M=new Date(-8640000000000000);var b=new Date("1753-01-01");var d=new Date(8640000000000000);var e=new Date("9999-12-31");function o(O){var m={"DATE":"date","TODAY":"today","YESTERDAY":"yesterday","TOMORROW":"tomorrow","DATERANGE":"dateRange","FROM":"from","TO":"to","YEARTODATE":"yearToDate","LASTDAYS":"lastDays","LASTWEEKS":"lastWeeks","LASTMONTHS":"lastMonths","LASTQUARTERS":"lastQuarters","LASTYEARS":"lastYears","NEXTDAYS":"nextDays","NEXTWEEKS":"nextWeeks","NEXTMONTHS":"nextMonths","NEXTQUARTERS":"nextQuarters","NEXTYEARS":"nextYears","TODAYFROMTO":"todayFromTo","THISWEEK":"thisWeek","LASTWEEK":"lastWeek","NEXTWEEK":"nextWeek","SPECIFICMONTH":"specificMonth","THISMONTH":"thisMonth","LASTMONTH":"lastMonth","NEXTMONTH":"nextMonth","THISQUARTER":"thisQuarter","LASTQUARTER":"lastQuarter","NEXTQUARTER":"nextQuarter","QUARTER1":"quarter1","QUARTER2":"quarter2","QUARTER3":"quarter3","QUARTER4":"quarter4","THISYEAR":"thisYear","LASTYEAR":"lastYear","NEXTYEAR":"nextYear"};return m[O];}var f=B.extend("sap.ui.integration.cards.filters.DateRangeFilter",{metadata:{library:"sap.ui.integration",aggregations:{_ddr:{type:"sap.m.DynamicDateRange",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});f.prototype.getField=function(){return this._getDdr();};f.prototype.getValueForModel=function(){var g=this._getDdr().getValue();var v;var r;var R;if(g){v=Object.assign({},g);var h=a.toDates(v),s=h[0].getJSDate?h[0].getJSDate():h[0],E=h[1].getJSDate?h[1].getJSDate():h[1];r={start:s.toISOString(),end:E.toISOString()};R={start:s.toISOString(),end:E.toISOString()};if(v.operator==="TO"){r.start=M.toISOString();R.start=b.toISOString();}if(v.operator==="FROM"){r.end=d.toISOString();R.end=e.toISOString();}v.operator=o(v.operator);}return{value:v,range:r,rangeOData:R};};f.prototype._getDdr=function(){var C=this.getAggregation("_ddr");if(!C){C=this._createDdr();this.setAggregation("_ddr",C);}return C;};f.prototype._createDdr=function(){var C=Object.assign({},this.getConfig());var v;if(C.value){var O=C.value.operator.toUpperCase();var t=a.getOption(O).getValueTypes();v={operator:O,values:C.value.values.map(function(h,i){if(t[i]==="date"){return new Date(h);}return h;})};}C.options=C.options||this._getDefaultOptions();C.options=C.options.map(function(O){return O.toUpperCase();});var g=new D({value:v,options:C.options});g.attachChange(function(E){if(E.getParameter("valid")){g.setValueState(V.None);this.setValue(this.getValueForModel());}else{g.setValueState(V.Error);}}.bind(this));return g;};f.prototype._getDefaultOptions=function(){return["date","today","dateRange","from","to","lastDays","nextDays","lastWeeks","nextWeeks"];};return f;});
