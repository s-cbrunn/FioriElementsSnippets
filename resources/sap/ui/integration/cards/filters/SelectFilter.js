/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/m/Select","sap/ui/core/ListItem","sap/ui/model/json/JSONModel"],function(B,S,L,J){"use strict";var a=B.extend("sap.ui.integration.cards.filters.SelectFilter",{metadata:{library:"sap.ui.integration",aggregations:{_select:{type:"sap.m.Select",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});a.prototype.exit=function(){B.prototype.exit.apply(this,arguments);if(this._oItemTemplate){this._oItemTemplate.destroy();}};a.prototype.getField=function(){return this._getSelect();};a.prototype.onDataChanged=function(){var s=this._getSelect();s.setSelectedKey(this.getValue().value);};a.prototype.getValueForModel=function(){var s=this._getSelect().getSelectedItem();if(s){return{value:s.getKey(),selectedItem:{title:s.getText(),key:s.getKey()}};}return{value:this.getConfig().value};};a.prototype._getSelect=function(){var c=this.getAggregation("_select");if(!c){c=this._createSelect();this.setAggregation("_select",c);}return c;};a.prototype._createSelect=function(){var s=new S(),i,I,b="/",c=this.getConfig();s.attachChange(function(e){this.setValue(this.getValueForModel());var m="/sap.card/configuration/filters/"+this.getKey()+"/value",p={};p[m]=e.getParameter("selectedItem").getKey();this.getCardInstance()._fireConfigurationChange(p);}.bind(this));if(c&&c.item){b=c.item.path||b;}if(c&&c.item&&c.item.template){i=c.item.template.key;I=c.item.template.title;}if(c&&c.items){i="{key}";I="{title}";this.setModel(new J(c.items));}this._oItemTemplate=new L({key:i,text:I});s.bindItems({path:b,template:this._oItemTemplate});s.setSelectedKey(c.value);return s;};return a;});
